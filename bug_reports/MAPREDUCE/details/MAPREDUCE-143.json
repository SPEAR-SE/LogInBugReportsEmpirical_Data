{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12414186","self":"https://issues.apache.org/jira/rest/api/2/issue/12414186","key":"MAPREDUCE-143","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2009-02-06T18:24:50.079+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 21 19:44:43 UTC 2014","customfield_12310420":"71847","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_172065297845_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-07-21T19:44:43.170+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-143/watchers","watchCount":4,"isWatching":false},"created":"2009-02-06T07:49:45.358+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12339150","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12339150","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"inwardIssue":{"id":"12507554","key":"MAPREDUCE-2510","self":"https://issues.apache.org/jira/rest/api/2/issue/12507554","fields":{"summary":"TaskTracker throw OutOfMemoryError after upgrade to jetty6","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-07-21T19:44:43.199+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Saw this exception in the TT logs:\n\n2009-02-06 06:18:08,553 ERROR org.mortbay.log: EXCEPTION\njava.lang.OutOfMemoryError: GC overhead limit exceeded\n2009-02-06 06:18:11,247 ERROR org.mortbay.log: Error for /mapOutput\njava.lang.OutOfMemoryError: GC overhead limit exceeded\n2009-02-06 06:18:11,247 ERROR org.mortbay.log: Error for /mapOutput\njava.lang.OutOfMemoryError: Java heap space\n        at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:39)\n        at java.nio.ByteBuffer.allocate(ByteBuffer.java:312)\n        at org.mortbay.io.nio.IndirectNIOBuffer.<init>(IndirectNIOBuffer.java:28)\n        at org.mortbay.jetty.nio.AbstractNIOConnector.newBuffer(AbstractNIOConnector.java:71)\n        at org.mortbay.jetty.AbstractBuffers.getBuffer(AbstractBuffers.java:131)\n        at org.mortbay.jetty.HttpGenerator.addContent(HttpGenerator.java:145)\n        at org.mortbay.jetty.AbstractGenerator$Output.write(AbstractGenerator.java:642)\n        at org.mortbay.jetty.AbstractGenerator$Output.write(AbstractGenerator.java:577)\n        at org.apache.hadoop.mapred.TaskTracker$MapOutputServlet.doGet(TaskTracker.java:2879)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"108289","customfield_12312823":null,"summary":"OOM in the TaskTracker while serving map outputs","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414186/comment/12671227","id":"12671227","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"body":"Did you get a heap dump? If it happens again, see if you can get one. Of course when heap runs out, it isn't necessarily related to the task that asked for the straw that broke the camel's back. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-02-06T18:24:50.079+0000","updated":"2009-02-06T18:24:50.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414186/comment/13032254","id":"13032254","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Our cluster met the similar problem after upgrade to jetty6.\nrelated log:\n2011-05-11 16:24:26,914 ERROR org.mortbay.log: Error for /mapOutput\n\njava.lang.OutOfMemoryError: Java heap space\n\n        at java.io.BufferedInputStream.<init>(BufferedInputStream.java:178)\n\n        at org.apache.hadoop.fs.BufferedFSInputStream.<init>(BufferedFSInputStream.java:44) \n\n        at org.apache.hadoop.fs.RawLocalFileSystem.open(RawLocalFileSystem.java:176)\n\n        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:359)\n\n        at org.apache.hadoop.mapred.TaskTracker$MapOutputServlet.doGet(TaskTracker.java:3040)\n\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:707) \n\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)\n\n        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)\n\n        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:363)\n\n        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n\n        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n\n        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)\n\n        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)\n\n        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230) \n\n        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n\n        at org.mortbay.jetty.Server.handle(Server.java:324)\n\n        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:534)\n\n        at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:864)\n\n        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:533)\n\n        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:207)\n\n        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:403)\n\n        at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)\n\n        at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:522)\n2011-05-11 17:31:39,376 ERROR org.mortbay.log: Error for /mapOutput\n\n2011-05-11 17:31:45,523 ERROR org.mortbay.log: Error for /mapOutput\n\njava.lang.OutOfMemoryError: Java heap space\n\njmap -heap result:\nHeap Configuration:\n\n   MinHeapFreeRatio = 40\n\n   MaxHeapFreeRatio = 70\n\n   MaxHeapSize      = 1610612736 (1536.0MB)\n\n   NewSize          = 1310720 (1.25MB)\n\n   MaxNewSize       = 17592186044415 MB\n\n   OldSize          = 5439488 (5.1875MB)\n\n   NewRatio         = 2\n\n   SurvivorRatio    = 8\n\n   PermSize         = 21757952 (20.75MB)\n\n   MaxPermSize      = 85983232 (82.0MB)\n\n\n\nHeap Usage:\n\nPS Young Generation\n\nEden Space:\n\n   capacity = 61865984 (59.0MB)\n\n   used     = 61865984 (59.0MB)\n\n   free     = 0 (0.0MB)\n\n   100.0% used\n\nFrom Space:\n\n   capacity = 178913280 (170.625MB)\n\n   used     = 11205368 (10.686271667480469MB)\n\n   free     = 167707912 (159.93872833251953MB)\n\n   6.263016361893315% used\n\nTo Space:\n\n   capacity = 178913280 (170.625MB)\n\n   used     = 0 (0.0MB)\n\n   free     = 178913280 (170.625MB)\n\n   0.0% used\n\nPS Old Generation\n\n   capacity = 1073741824 (1024.0MB)\n\n   used     = 1073710024 (1023.9696731567383MB)\n\n   free     = 31800 (0.03032684326171875MB)\n\n   99.99703839421272% used\n\nPS Perm Generation\n\n   capacity = 21757952 (20.75MB)\n\n   used     = 17614112 (16.798126220703125MB)\n\n   free     = 4143840 (3.951873779296875MB)\n\n   80.95482516001506% used\n\n\nWe dump the heap of TaskTracker and analyze it with MAT. We found one instance of \"org.mortbay.thread.QueuedThreadPool\" occupies 853,258,184 (72.51%) bytes. This object contain a \"java.lang.Runnable[]\" which has 7200 elements.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-12T05:01:45.273+0000","updated":"2011-05-12T05:01:45.273+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414186/comment/13032367","id":"13032367","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"The QueuedThreadPool of jetty6 own an array of jobs. If an idle thread is available a job is directly dispatched, otherwise the job is queued to the array. At first the size of the array is _maxThreads(40). When its full, the size grow to array.length() + _maxThreads. Because the grow has no limit, this array can occupy too many memory when there are lots of fetch request from reduce task. So is this jetty6's bug?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-12T11:55:37.530+0000","updated":"2011-05-12T11:55:37.530+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414186/comment/13044932","id":"13044932","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slakkarsu","name":"slakkarsu","key":"slakkarsu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sateesh Lakkarsu","active":true,"timeZone":"Etc/UTC"},"body":"I think we ran into the same issue, any work around or config tweak to avoid running into this? Thanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slakkarsu","name":"slakkarsu","key":"slakkarsu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sateesh Lakkarsu","active":true,"timeZone":"Etc/UTC"},"created":"2011-06-06T16:09:28.984+0000","updated":"2011-06-06T16:09:28.984+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414186/comment/13045237","id":"13045237","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"bq. I think we ran into the same issue, any work around or config tweak to avoid running into this? Thanks. \nI have created MAPREDUCE-2510 for this problem. As Chris's comment, Jetty 6.1.26 does not have this behavior. However, Jetty 6.1.26 has its own bugs MAPREDUCE-2529 and MAPREDUCE-2530 which are more serious than OOM. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-06-07T01:51:00.427+0000","updated":"2011-06-07T01:51:00.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414186/comment/14069134","id":"14069134","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"Closing as stale.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2014-07-21T19:44:43.195+0000","updated":"2014-07-21T19:44:43.195+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-143/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0iw2f:"}}