[Attaching a unit test which reproduces the issue. Had to refactor {{ShuffleHandler.Shuffle}} a little to get the test to work nicely.]