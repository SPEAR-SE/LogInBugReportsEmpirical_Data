[Filed under MAPREDUCE although the most obvious place to fix is under common in the place where the runResolveCommand is implemented., Thinking about it, we may want to consider not caching entries that are mapped to unresolved.
Otherwise (faulty) inputSplit implementations can cause an infinite number of bad entries to be cached (eventually they would map to NetworkTopology.DEFAULT_RACK).

The downside is that if there in fact is a small set of incorrect hosts being requested, the topology script would get called over and over again instead of getting the cached NetworkTopology.DEFAULT_RACK.]