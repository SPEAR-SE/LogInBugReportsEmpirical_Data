[I already reviewed and +1'd this code as part of HADOOP-10499. This is just splitting out the MapReduce portion of the patch., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12640496/MAPREDUCE-5840.1.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:red}-1 javac{color:red}.  The patch appears to cause the build to fail.

Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4527//console

This message is automatically generated., I forgot that this is really dependent on the {{ProxyUsers}} change in HADOOP-10499.  Rather than go through a series of awkward small commits, I'm just going to roll everything back into the HADOOP-10499 commit.]