[The patch fixes the two issues:
# The parent directory is now deleted using a "plain" {{PathDeletionContext}} which is backed by simple Java code rather than the {{TaskController.DeletionContext}} which is backed by the LinuxTaskController and does the impersonation.
# {{deletePathsInSecureCluster}} is now always called with an absolute path.  I also renamed the argument to make that more clear.

I don't have any unit tests, but I verified this in a cluster, {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12621395/MAPREDUCE-5706.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4480//console

This message is automatically generated., +1, Thanks Robert. Just committed this to branch-0.22., FAILURE: Integrated in Hadoop-Mapreduce-22-branch #116 (See [https://builds.apache.org/job/Hadoop-Mapreduce-22-branch/116/])
MAPREDUCE-5706. toBeDeleted parent directories aren't being cleaned up. (Robert Kanter via kasha) (kasha: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1593894)
* /hadoop/common/branches/branch-0.22/mapreduce/CHANGES.txt
* /hadoop/common/branches/branch-0.22/mapreduce/src/java/org/apache/hadoop/mapreduce/util/MRAsyncDiskService.java
]