[Actually the below fix might be more concise:

Index: .
===================================================================
--- .	(revision 8259)
+++ .	(working copy)
@@ -97,7 +97,7 @@
       int randomCount = key.get();
 
       for (int i = 0; i < randomCount; i++) {
-        out.collect(new IntWritable(Math.abs(r.nextInt())), new IntWritable(randomVal));
+        out.collect(new IntWritable(r.nextInt(Integer.MAX_VALUE)), new IntWritable(randomVal));
       }
     }
     public void close() {
, Please look over the how to contribute page http://wiki.apache.org/hadoop/HowToContribute and generate a standard patch, please. You might also consider reusing the same IntWritable instead of creating a new one each time., Closing this as stale.]