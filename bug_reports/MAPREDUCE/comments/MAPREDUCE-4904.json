[Attach a quick fix. Meng, Would you verify it works on your env as well?, Please add a comment about the switch fall-through, as it's not obvious and would raise more questions in later maintenance., Sure. Thanks Luke for comments.
If localityLevel =2 and in case of without-NodeGroup, the task should be counted into OTHER_LOCAL_MAPS (it should go to "default" below to be handled rather than being break out). This tiny patch fix this issue., I meant that you should add a comment (e.g. // fall through. see MAPREDUCE-4904) to the patch :) Otherwise, the switch code would look a little strange to later maintainers and cause some unnecessary head-scratching., Incorporate Luke's comments with adding comments to fall through in switch case., use --no-prefix to generate patch in new v2 patch., +1. Verified that the fix works for me., Committed to branch-1. Thanks Junping for the patch!, Closed upon release of Hadoop 1.2.0.]