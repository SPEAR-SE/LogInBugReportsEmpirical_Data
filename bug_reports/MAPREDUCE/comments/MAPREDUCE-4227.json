[I'd been banging my head on this bug for weeks and then Koji swept in like an angel that he is, and rescued me.

Courtesy Koji!
{quote}
src/mapred/org/apache/hadoop/mapred/StatisticsCollector.java
{noformat}
276     synchronized void update() {
277       updates++;
278       if (updates == updatesPerBucket) {
279         for(TimeStat stat : statToCollect.values()) {
280           stat.addBucket();
281         }
282         updates = 0;
283         buckets++;
284         if (buckets > collectBuckets) {
285           for (TimeStat stat : statToCollect.values()) {
286             stat.removeBucket();
287           }
288           buckets--;
289         }
290       }
291     }
292   }
{noformat}
'bucket' keeps track of how many buckets ALL the TimeStat has for that Range (Hourly,Daily) so after 1 hour, buckets == collectBuckets and each time it adds, it takes out 1.
i believe the incorrect assumption they are making here is ALL the TimeStat would have same number of buckets
{quote}

One of these days I'll start a Koji fan club! Please consider joining., Hi, Ravi and Koji, could you please convert this issue into a patch?  Thanks., Hi Matt,

I'm attaching the patch. It makes the following changes
1. buckets are removed only if there are more in the current TaskTrackers than are required
2. Earlier the TimeWindow statistics were not being updated asap. They would lag behind by one "update cycle" I've fixed that as well.
3. I took the liberty to add some much needed javadocs in this JIRA.

Disclaimer: StatisticsCollector is being referenced in some AspectJ files. Unfortunately I don't know how I can check if my changes affected anything in there. Any clues?, I ran test-patch: 
{noformat}
-1 overall.  
    +1 @author.  The patch does not contain any @author tags.
    +1 tests included.  The patch appears to include 3 new or modified tests.
    +1 javadoc.  The javadoc tool did not generate any warning messages.
    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
    -1 findbugs.  The patch appears to introduce 8 new Findbugs (version 1.3.9) warnings.
{noformat}
The findbugs warning is spurious. We've been through this before https://issues.apache.org/jira/browse/MAPREDUCE-4088?focusedCommentId=13263990&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13263990 ., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12525873/MAPREDUCE-4227.branch-1.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 1 new or modified test files.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/2396//console

This message is automatically generated., bq. -1 patch. The patch command could not apply the patch.
Yeah! This patch applies only to branch-1, Moved to 1.2.0 upon release of 1.1.0., https://issues.apache.org/jira/browse/MAPREDUCE-4963 has been committed.]