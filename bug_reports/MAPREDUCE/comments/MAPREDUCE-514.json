[A simple proposal is to do what is done in HADOOP-3698. That is, we should parse the configuration at initialization and populate a mapping between queue names and the configured properties. This way, it will be easy to check if the map contains the queue name being requested in the APIs., Considering how the code has turned out, the Capacity Scheduler iterates over queues it gets from the framework's {{QueueManager}} class. Now, when it asks the {{CapacitySchedulerConf}} for a property for this queue, if nothing is configured for this queue in {{capacity-scheduler.xml}}, a hard-coded default value is returned. This may not be what the administrator intended, because the defaults are not defined by him/her. Hence, this issue exists.

HADOOP-4178 is trying to implement a mechanism to make these default values itself configurable. If it does that, then it would be a feature that if a property is not configured for a queue in the capacity scheduler's configuration, the configured default is used. This makes it very simple for the administrator to define new queues. And it would invalidate the need to check for invalid queues, as required by this issue.

So in summary, if HADOOP-4178 is fixed, we can mark this bug as invalid. Comments ?, I'd suggest that we warn in the JobTracker log at start up if the capacity scheduler configuration defines a queue that isn't present in the QueueManager. It will most likely be a typo on one side or the other. Not defining properties should be ok, since they will just fall back to the defaults defined via HADOOP-4178., Marking [HADOOP-4178|https://issues.apache.org/jira/browse/HADOOP-4178] as a related issue to this issue., Attaching patch with following changes:
- Added {code:title=CapacitySchedulerConf} Set<String> getQueues() {code}
- Modified _CapacityTaskScheduler_ to check the number of queues configured in _capacity_scheduler.xml_ against queues in _QueueManager_
- Added a test case to test new method in _CapacitySchedulerConf_
- Modified _TestCapacityScheduler_ to support _getQueues()_, - The warning statement refers to hadoop-defaults, but the configuration can be in hadoop-site as well. I would suggest we print something like: "Queue <queue-name> is not configured in mapred.queue.names property in site configuration."
- The test case {{testGetQueues}} must configure more than one queue and verify they are present. The names should also be different from 'default'.


, Attaching patch with comments from Hemanth, incorporated, Looks good to me., Running through Hudson., +1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12391004/HADOOP-4079-2.patch
  against trunk revision 699676.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 6 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3389/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3389/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3389/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3389/console

This message is automatically generated., This patch doesn't apply to trunk any more.

It doesn't seem to be a blocker for 0.19, so I'm moving it to 0.20., Attaching patch merging with the latest trunk. The conflict was because of the changes which went into [HADOOP-4178|https://issues.apache.org/jira/browse/HADOOP-4178], Running the patch thro' Hudson., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12391192/HADOOP-4079-3.patch
  against trunk revision 700628.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 6 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3408/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3408/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3408/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3408/console

This message is automatically generated., The core test failed is not releated to this issue. , Resubmitting the patch for running thro' Hudson, the patch still applies against the trunk., +1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12391192/HADOOP-4079-3.patch
  against trunk revision 718232.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 6 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3600/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3600/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3600/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3600/console

This message is automatically generated., Patch does not apply to the trunk cleanly anymore, Attaching latest patch merged with the trunk, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12395256/HADOOP-4079-4.patch
  against trunk revision 724531.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 6 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3691/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3691/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3691/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3691/console

This message is automatically generated., The core tests failed are not related to the pacth. The patch modifies only the contrib project capacity scheduler., This patch does not apply anymore, so removing from queue while this is fixed., This issue does not apply after the commit of MAPREDUCE-860 the queue information is no more maintained in the {{capacity-scheduler.xml}} rather the properties are maintained in the {{mapred-queues.xml}}. So closing this issue. if required for older version please feel free to re-open it.
]