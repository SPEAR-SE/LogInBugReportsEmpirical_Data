[I saw this too, The difficult part with this is debug mode in the history server.  It switches the YYYY/MM/DD to YYYY/HH/mm (or something like that).  This makes it very difficult for the cleanup code to be able to know when it is allowed to delete a particular directory.  It is possible, however unlikely, that the cleanup thread would try to delete a directory at the same time that someone else is trying to add something to them.  This could potentially result in files being deleted that should not be.  It should not be too hard to work around it, but it is something to be aware of.]