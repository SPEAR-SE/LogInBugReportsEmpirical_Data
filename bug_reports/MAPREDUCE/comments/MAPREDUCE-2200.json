[Fix for failing test, Looks good.  Does this mean that a KDC has to run on localhost:88 on the build machines?, Nope. This all is self-sufficient. No extra anything is needed., +1.  Submitting patch., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12460390/MAPREDUCE-2200.patch
  against trunk revision 1038357.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 2 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed these core unit tests:
                  org.apache.hadoop.cli.TestMRCLI
                  org.apache.hadoop.conf.TestNoDefaultsJobConf
                  org.apache.hadoop.examples.terasort.TestTeraSort
                  org.apache.hadoop.fs.TestDFSIO
                  org.apache.hadoop.fs.TestFileSystem
                  org.apache.hadoop.ipc.TestSocketFactory
                  org.apache.hadoop.mapred.join.TestDatamerge
                  org.apache.hadoop.mapred.lib.TestDelegatingInputFormat
                  org.apache.hadoop.mapred.pipes.TestPipesAsDifferentUser
                  org.apache.hadoop.mapred.pipes.TestPipes
                  org.apache.hadoop.mapred.TestBadRecords
                  org.apache.hadoop.mapred.TestClusterMapReduceTestCase
                  org.apache.hadoop.mapred.TestClusterMRNotification
                  org.apache.hadoop.mapred.TestClusterStatus
                  org.apache.hadoop.mapred.TestCompressedEmptyMapOutputs
                  org.apache.hadoop.mapred.TestControlledMapReduceJob
                  org.apache.hadoop.mapred.TestDebugScript
                  org.apache.hadoop.mapred.TestEmptyJob
                  org.apache.hadoop.mapred.TestIsolationRunner
                  org.apache.hadoop.mapred.TestJobCleanup
                  org.apache.hadoop.mapred.TestJobClient
                  org.apache.hadoop.mapred.TestJobDirCleanup
                  org.apache.hadoop.mapred.TestJobHistory
                  org.apache.hadoop.mapred.TestJobInProgressListener
                  org.apache.hadoop.mapred.TestJobKillAndFail
                  org.apache.hadoop.mapred.TestJobName
                  org.apache.hadoop.mapred.TestJobQueueInformation
                  org.apache.hadoop.mapred.TestJobRetire
                  org.apache.hadoop.mapred.TestJobStatusPersistency
                  org.apache.hadoop.mapred.TestJobSysDirWithDFS
                  org.apache.hadoop.mapred.TestJobTrackerInstrumentation
                  org.apache.hadoop.mapred.TestJobTrackerStart
                  org.apache.hadoop.mapred.TestJobTrackerXmlJsp
                  org.apache.hadoop.mapred.TestJvmReuse
                  org.apache.hadoop.mapred.TestKillSubProcesses
                  org.apache.hadoop.mapred.TestLazyOutput
                  org.apache.hadoop.mapred.TestMapredHeartbeat
                  org.apache.hadoop.mapred.TestMapredSystemDir
                  org.apache.hadoop.mapred.TestMiniMRClasspath
                  org.apache.hadoop.mapred.TestMiniMRLocalFS
                  org.apache.hadoop.mapred.TestMiniMRWithDFS
                  org.apache.hadoop.mapred.TestMRServerPorts
                  org.apache.hadoop.mapred.TestMRWithDistributedCache
                  org.apache.hadoop.mapred.TestMultipleLevelCaching
                  org.apache.hadoop.mapred.TestNodeRefresh
                  org.apache.hadoop.mapred.TestQueueManagerWithJobTracker
                  org.apache.hadoop.mapred.TestRecoveryManager
                  org.apache.hadoop.mapred.TestSetupAndCleanupFailure
                  org.apache.hadoop.mapred.TestSpecialCharactersInOutputPath
                  org.apache.hadoop.mapred.TestSubmitJob
                  org.apache.hadoop.mapred.TestTaskFail
                  org.apache.hadoop.mapred.TestTaskOutputSize
                  org.apache.hadoop.mapred.TestTaskTrackerMemoryManager
                  org.apache.hadoop.mapred.TestTaskTrackerSlotManagement
                  org.apache.hadoop.mapred.TestTrackerReservation
                  org.apache.hadoop.mapred.TestTTResourceReporting
                  org.apache.hadoop.mapred.TestWebUIAuthorization
                  org.apache.hadoop.mapreduce.lib.input.TestCombineFileInputFormat
                  org.apache.hadoop.mapreduce.lib.input.TestDelegatingInputFormat
                  org.apache.hadoop.mapreduce.lib.join.TestJoinDatamerge
                  org.apache.hadoop.mapreduce.lib.join.TestJoinProperties
                  org.apache.hadoop.mapreduce.lib.output.TestJobOutputCommitter
                  org.apache.hadoop.mapreduce.security.TestBinaryTokenFile
                  org.apache.hadoop.mapreduce.security.TestTokenCacheOldApi
                  org.apache.hadoop.mapreduce.security.TestTokenCache
                  org.apache.hadoop.mapreduce.security.token.TestDelegationTokenRenewal
                  org.apache.hadoop.mapreduce.TestJobACLs
                  org.apache.hadoop.mapreduce.TestMapReduceLazyOutput
                  org.apache.hadoop.mapreduce.TestMapReduceLocal
                  org.apache.hadoop.mapreduce.TestMRJobClient
                  org.apache.hadoop.mapreduce.TestNoJobSetupCleanup
                  org.apache.hadoop.mapreduce.TestTaskContext
                  org.apache.hadoop.security.authorize.TestServiceLevelAuthorization
                  org.apache.hadoop.security.TestMapredGroupMappingServiceRefresh
                  org.apache.hadoop.tools.rumen.TestRumenJobTraces
                  org.apache.hadoop.tools.TestCopyFiles
                  org.apache.hadoop.tools.TestDistCh
                  org.apache.hadoop.tools.TestHadoopArchives
                  org.apache.hadoop.tools.TestHarFileSystem

    -1 contrib tests.  The patch failed contrib unit tests.

    +1 system test framework.  The patch passed system test framework compile.

Test results: https://hudson.apache.org/hudson/job/PreCommit-MAPREDUCE-Build/8//testReport/
Findbugs warnings: https://hudson.apache.org/hudson/job/PreCommit-MAPREDUCE-Build/8//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://hudson.apache.org/hudson/job/PreCommit-MAPREDUCE-Build/8//console

This message is automatically generated., I have looked at the results and it seems the build is behaving: certain artifacts weren't found which produced lotta false-positives. Apparently, not related to the patch. I will run validation on my local machine and report results back here., I have ran commit tests and they passed as well as the originally failing one. I am going to commit this unless there are objections., ya, please commit.
, I have just committed it., Integrated in Hadoop-Mapreduce-trunk-Commit #555 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-trunk-Commit/555/])
    MAPREDUCE-2200. TestUmbilicalProtocolWithJobToken is failing without Krb evironment: needs to be conditional. Contributed by Konstantin Boudnik.
, I think this needs to go on branch-0.22 as well - the 22 build is failing with the same error., Added this to branch-0.22 and moved it in CHANGES.txt on trunk., Integrated in Hadoop-Mapreduce-trunk-Commit #598 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-trunk-Commit/598/])
    Move MAPREDUCE-2200 to 0.22 section of CHANGES.txt since it was applied to that branch.
, Integrated in Hadoop-Mapreduce-22-branch #33 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-22-branch/33/])
    , Integrated in Hadoop-Mapreduce-trunk #643 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-trunk/643/])
    ]