[the call to getDelegationToken is retained for now, for hftp to work. This will however end up getting the delegation token twice for other filesystem which implement both APIs., Updated patch to apply cleanly against trunk after yesterday's commits.

Two test failures - both not related to the patch.
TEST-org.apache.hadoop.cli.TestMRCLI.txt:Tests run: 1, Failures: 1, Errors: 0, Time elapsed: 28.994 sec
TEST-org.apache.hadoop.mapred.TestCombineOutputCollector.txt:Tests run: 2, Failures: 2, Errors: 0, Time elapsed: 1.605 sec

1 new FindBug warning while running test-patch - not related.

Haven't been able to get ant binary-system (FI build) to work. Seems to pick up an old version of common without NetUtils.verifyHostnames

Will post a patch for the MR-279 branch shortly., Patch for the MR-279 branch., I just committed this to both trunk and MR-279. Thanks Sid!, Integrated in Hadoop-Mapreduce-trunk-Commit #766 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/766/])
    MAPREDUCE-2839. Fixed TokenCache to get delegation tokens using both new and old apis. Contributed by Siddharth Seth.

acmurthy : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1157420
Files : 
* /hadoop/common/trunk/mapreduce/src/test/mapred/org/apache/hadoop/mapreduce/security/TestTokenCache.java
* /hadoop/common/trunk/mapreduce/CHANGES.txt
* /hadoop/common/trunk/mapreduce/src/java/org/apache/hadoop/mapreduce/security/TokenCache.java
, Integrated in Hadoop-Mapreduce-trunk #754 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/754/])
    MAPREDUCE-2839. Fixed TokenCache to get delegation tokens using both new and old apis. Contributed by Siddharth Seth.

acmurthy : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1157420
Files : 
* /hadoop/common/trunk/mapreduce/src/test/mapred/org/apache/hadoop/mapreduce/security/TestTokenCache.java
* /hadoop/common/trunk/mapreduce/CHANGES.txt
* /hadoop/common/trunk/mapreduce/src/java/org/apache/hadoop/mapreduce/security/TokenCache.java
, Integrated in Hadoop-Common-trunk-Commit #742 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/742/])
    MAPREDUCE-2839. Fixed TokenCache to get delegation tokens using both new and old apis. Contributed by Siddharth Seth.

acmurthy : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1157420
Files : 
* /hadoop/common/trunk/mapreduce/src/test/mapred/org/apache/hadoop/mapreduce/security/TestTokenCache.java
* /hadoop/common/trunk/mapreduce/CHANGES.txt
* /hadoop/common/trunk/mapreduce/src/java/org/apache/hadoop/mapreduce/security/TokenCache.java
]