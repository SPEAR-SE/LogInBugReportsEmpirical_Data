[Hi, 
One query
How the AM IP can be configured ?  User/job client wont be able to decide which NM it launches., I think there are 2 approaches:
1) bind the same ip with NodeManager, it is easy to implement, but the constraint is NM and AM should be in the same subnet.
2) configuration subnet for AM, like "192.168.0.0/8", and the AM try to bind the ip belongs to the subnet in the container., Another possible solution is to configure the IP/host in NM config and NM can pass it through command line to AM where AM can read it., any update on this issue..?

I think, as per peter suggestion can we make use of nodemanger address..??

there are three places which we need consider for {{yarn.app.mapreduce.am.job.client.port-range}}.


1) {{appContext.getNMHostname()}} can be passed in  MRClientService#serviceStart() for following two cases.

a ) {{InetSocketAddress address = new InetSocketAddress(0);}}


b) {code}
webApp =
          WebApps.$for("mapreduce", AppContext.class, appContext, "ws")
            .withHttpPolicy(conf, Policy.HTTP_ONLY).start(new AMWebApp());
   {code}

3) "0.0.0.0" can be replace with {{context.getNMHostname()}} in {{TaskAttempListenerImpl#startRpcServer()}}
{code}
      server = 
          new RPC.Builder(conf).setProtocol(TaskUmbilicalProtocol.class)
            .setInstance(this).setBindAddress("0.0.0.0")
            .setPort(0).setNumHandlers(
                conf.getInt(MRJobConfig.MR_AM_TASK_LISTENER_THREAD_COUNT, 
                    MRJobConfig.DEFAULT_MR_AM_TASK_LISTENER_THREAD_COUNT))
                    .setVerbose(false).setSecretManager(jobTokenSecretManager)
                    .build();
      {code}
  

Please correct me if I am wrong.., No progress has been made. Actually we had decided that this issue will be handled as part of MAPREDUCE-5938.
Refer to comment https://issues.apache.org/jira/browse/YARN-4119?focusedCommentId=14734333&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14734333
Seems no progress has been made there as well.
cc [~naganarasimha_gr@apache.org], Thanks for reply...Thought of handling the ShufflePort related in MAPREDUCE-5938 and AM IP ( as I mentioned above ) related changes here.., Please use the same solution of MAPREDUCE-5938 to fix this issue, thanks!]