[Attaching patch for review., The attached patch needs controlled setup task and other features from HADOOP-4831 and is supposed to be applied over the latest patch there. Blocking this issue for the completion of HADOOP-4831., Patch available., Moving out of the patch queue to give some more time for the review., Closing as this as stale.]