[Unit test illustrating the issue.

Arguably, this is an issue with new instances of DistributedFileSystem and protocol compatibility should be established lazily rather than in the constructor.]