[Patch defines a new job-specific config {{mapreduce.job.tags}}, and sets the corresponding YARN's ASC., Rebased same patch on latest trunk. Submitting patch, now that YARN-1461 is committed. , {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12627079/mr-5699-1.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:red}-1 javac{color:red}.  The patch appears to cause the build to fail.

Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4343//console

This message is automatically generated., My bad, updated the patch. 

Also, verified that the tags are propagated to the RM on a pseudo-distributed cluster. , {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12627086/mr-5699-2.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:red}-1 javadoc{color}.  The javadoc tool appears to have generated 2 warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

        {color:red}-1 release audit{color}.  The applied patch generated 1 release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4344//testReport/
Release audit warnings: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4344//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt
Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4344//console

This message is automatically generated., Release audit and javadoc warnings are unrelated.

Added no additional tests, as most of the tags feature is verified through tests in YARN. This patch just sets tags on the YARN application corresponding to the job. Verified manually on pseudo-dist cluster that the tags do get applied., In addition to pass tags when being submitted to YARN, should we make the running MRAppMaster/Job remember the tags as well. One of reason is that we need to parse them to JHS as the requirement of MAPREDUCE-5658.

Another thing I'm considering is whether we'd like to support more features that are made possible by tags. For example, JobClient can also filter applications by tags. Thoughts?, bq. should we make the running MRAppMaster/Job remember the tags as well. One of reason is that we need to parse them to JHS as the requirement of MAPREDUCE-5658.
The jobconf should have mapreduce.job.tags - the JHS should be able read it from jobconf.

bq. Another thing I'm considering is whether we'd like to support more features that are made possible by tags. For example, JobClient can also filter applications by tags. Thoughts?
It is a good idea to support in JobClient. I can add an API to JobClient to look for active/running MR jobs with a particular tag. For finished jobs, we should probably do it after JHS-related changes? , bq. In addition to pass tags when being submitted to YARN, should we make the running MRAppMaster/Job remember the tags as well.
Because the tags go in the job configuration, the MRAppMaster and JHS will have access to them.

Comments on the patch:
{code}
 <?xml version="1.0"?>
+<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>
 <!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
@@ -15,7 +16,6 @@
    See the License for the specific language governing permissions and
    limitations under the License.
 -->
-<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>
{code}
False change?

{code}
+    <description> Tags for the job, the corresponding YARN application
+      inherits these tags. The ResourceManager can be queried for any of
+      these tags to fetch this application.
{code}
First sentence is a little awkward.  Second makes it a little unclear that AHS can be queried for them too. Maybe use "Tags for the job that will be passed to YARN at submission time.  Queries to YARN for applications can filter on these tags."

Otherwise, LGTM., bq. False change?
It is an unrelated change, yes. The IDE was showing a warning for this, I believe this causes a RAT warning as well. I would like to leave this in if people are okay with it. 

Will fix the other comment. , bq. The jobconf should have mapreduce.job.tags - the JHS should be able read it from jobconf.

Make sense.

bq. For finished jobs, we should probably do it after JHS-related changes?

Yes, let's postpone it until JHS can work with tags., Updated description of the property to Sandy's suggestion. , Created MAPREDUCE-5741 for JobClient changes. , +1 pending jenkins, {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12627259/mr-5699-3.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient:

                  org.apache.hadoop.mapreduce.v2.TestUberAM

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4346//testReport/
Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4346//console

This message is automatically generated., Thanks for your prompt reviews, [~zjshen] and [~sandyr].

TestUberAM passes for me locally and is unrelated to changes in this patch. Will commit this shortly.
, Committed this to trunk and branch-2. , SUCCESS: Integrated in Hadoop-trunk-Commit #5119 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/5119/])
MAPREDUCE-5699. Allow setting tags on MR jobs (kasha) (kasha: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1565384)
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/MRJobConfig.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/resources/mapred-default.xml
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/src/main/java/org/apache/hadoop/mapred/YARNRunner.java
, SUCCESS: Integrated in Hadoop-Yarn-trunk #474 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/474/])
MAPREDUCE-5699. Allow setting tags on MR jobs (kasha) (kasha: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1565384)
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/MRJobConfig.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/resources/mapred-default.xml
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/src/main/java/org/apache/hadoop/mapred/YARNRunner.java
, SUCCESS: Integrated in Hadoop-Hdfs-trunk #1666 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1666/])
MAPREDUCE-5699. Allow setting tags on MR jobs (kasha) (kasha: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1565384)
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/MRJobConfig.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/resources/mapred-default.xml
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/src/main/java/org/apache/hadoop/mapred/YARNRunner.java
, SUCCESS: Integrated in Hadoop-Mapreduce-trunk #1691 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1691/])
MAPREDUCE-5699. Allow setting tags on MR jobs (kasha) (kasha: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1565384)
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/MRJobConfig.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/resources/mapred-default.xml
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/src/main/java/org/apache/hadoop/mapred/YARNRunner.java
]