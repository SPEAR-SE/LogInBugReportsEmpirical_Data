[I attached a patch for review., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12665960/MAPREDUCE-6063.000.patch
  against trunk revision 6595e92.

    {color:red}-1 patch{color}.  Trunk compilation may be broken.

Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/4840//console

This message is automatically generated., +1 Good catch

I committed this to trunk and branch-2, Hi [~chris.douglas], thanks to commit the patch to trunk and branch-2.
This issue is also in MR1 (branch-1) . I attached a patch "MAPREDUCE-6063.branch-1.patch" for branch-1.
Could you commit MAPREDUCE-6063.branch-1.patch to branch-1?
thanks
zhihai, FAILURE: Integrated in Hadoop-Yarn-trunk #670 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/670/])
MAPREDUCE-6063. Correct spill size calculation for spills wrapping the circular buffer. Contributed by zhihai xu. (cdouglas: rev a18424e724982d01e0191ca7db713da1d43d1e4d)
* hadoop-mapreduce-project/CHANGES.txt
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/MapTask.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk #1861 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1861/])
MAPREDUCE-6063. Correct spill size calculation for spills wrapping the circular buffer. Contributed by zhihai xu. (cdouglas: rev a18424e724982d01e0191ca7db713da1d43d1e4d)
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/MapTask.java
* hadoop-mapreduce-project/CHANGES.txt
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #1886 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1886/])
MAPREDUCE-6063. Correct spill size calculation for spills wrapping the circular buffer. Contributed by zhihai xu. (cdouglas: rev a18424e724982d01e0191ca7db713da1d43d1e4d)
* hadoop-mapreduce-project/CHANGES.txt
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/MapTask.java
, bq. This issue is also in MR1 (branch-1) . I attached a patch "MAPREDUCE-6063.branch-1.patch" for branch-1.

Done. Thanks again for the fix, Hi [~chris.douglas], thanks to commit this patch to branch-1, it is very nice working with you.]