[attached patch for the 0.20 branch., Here's an updated patch for 1.x.]