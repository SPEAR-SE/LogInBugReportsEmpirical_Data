[Patch, Looks good to me, good catch, Priyo. +1 pending test results (and should probably give Matei a day or two to take a look as well), +1 looks good to me. Let's wait for Hudson to run its tests, and I'll commit it to trunk, 0.22 and 0.21 unless anyone brings up concerns., This is an important bug in the FairScheduler.  I think this needs to be fixed in 0.22, Agreed on putting it in 0.22., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12468031/mapreduce-2256_0_22.txt
  against trunk revision 1064287.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    -1 contrib tests.  The patch failed contrib unit tests.

    +1 system test framework.  The patch passed system test framework compile.

Test results: https://hudson.apache.org/hudson/job/PreCommit-MAPREDUCE-Build/19//testReport/
Findbugs warnings: https://hudson.apache.org/hudson/job/PreCommit-MAPREDUCE-Build/19//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://hudson.apache.org/hudson/job/PreCommit-MAPREDUCE-Build/19//console

This message is automatically generated., I just committed this. Thank you Priyo., Integrated in Hadoop-Mapreduce-trunk-Commit #595 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-trunk-Commit/595/])
    , Integrated in Hadoop-Mapreduce-22-branch #33 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-22-branch/33/])
    , Integrated in Hadoop-Mapreduce-trunk #643 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-trunk/643/])
    ]