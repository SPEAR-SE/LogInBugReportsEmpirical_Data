[Snippet of client output from a streaming job submission when the problem occurs:

{noformat}
2013-01-11 21:40:35,818 INFO  [main] mapreduce.JobSubmitter (JobSubmitter.java:printTokens(439)) - Submitting tokens for job: job_1357940284444_0001
2013-01-11 21:40:36,117 INFO  [main] client.YarnClientImpl (YarnClientImpl.java:submitApplication(138)) - Submitted application application_1357940284444_0001 to ResourceManager at xx
2013-01-11 21:40:36,164 INFO  [main] mapreduce.Job (Job.java:submit(1222)) - The url to track the job: http://xx/proxy/application_1357940284444_0001/
2013-01-11 21:40:36,166 INFO  [main] mapreduce.Job (Job.java:monitorAndPrintJob(1267)) - Running job: job_1357940284444_0001
2013-01-11 21:40:36,175 INFO  [main] mapreduce.Job (Job.java:monitorAndPrintJob(1288)) - Job job_1357940284444_0001 running in uber mode : false
2013-01-11 21:40:36,175 INFO  [main] mapreduce.Job (Job.java:monitorAndPrintJob(1295)) -  map 0% reduce 0%
2013-01-11 21:40:36,185 INFO  [main] mapreduce.Job (Job.java:monitorAndPrintJob(1308)) - Job job_1357940284444_0001 failed with state FAILED due to: Application appattempt_1357940284444_0001_000001 submitted by user someuser to unknown queue: badqueuename
2013-01-11 21:40:36,217 INFO  [main] mapreduce.Job (Job.java:monitorAndPrintJob(1313)) - Counters: 0
2013-01-11 21:40:36,217 ERROR [main] streaming.StreamJob (StreamJob.java:submitAndMonitorJob(1019)) - Job not Successful!
Streaming Command Failed!
{noformat}

And the same section of output from the client when it does not occur:

{noformat}
2013-01-11 21:49:51,292 INFO  [main] mapreduce.JobSubmitter (JobSubmitter.java:printTokens(439)) - Submitting tokens for job: job_1357940966359_0002
2013-01-11 21:49:51,556 INFO  [main] client.YarnClientImpl (YarnClientImpl.java:submitApplication(138)) - Submitted application application_1357940966359_0002 to ResourceManager at xx
2013-01-11 21:49:51,566 INFO  [main] mapreduce.JobSubmitter (JobSubmitter.java:submitJobInternal(401)) - Cleaning up the staging area /tmp/hadoop-yarn/staging/someuser/.staging/job_1357940966359_0002
2013-01-11 21:49:51,586 ERROR [main] security.UserGroupInformation (UserGroupInformation.java:doAs(1453)) - PriviledgedActionException as:someuser (auth:SIMPLE) cause:java.io.IOException: Failed to run job : Application appattempt_1357940966359_0002_000001 submitted by user someuser to unknown queue: badqueuename
2013-01-11 21:49:51,586 ERROR [main] security.UserGroupInformation (UserGroupInformation.java:doAs(1453)) - PriviledgedActionException as:someuser (auth:SIMPLE) cause:java.io.IOException: Failed to run job : Application appattempt_1357940966359_0002_000001 submitted by user someuser to unknown queue: badqueuename
2013-01-11 21:49:51,586 ERROR [main] streaming.StreamJob (StreamJob.java:submitAndMonitorJob(1034)) - Error Launching job : Failed to run job : Application appattempt_1357940966359_0002_000001 submitted by user someuser to unknown queue: badqueuename
Streaming Command Failed!
{noformat}, This is complicated by the fact that the RM returned success for the application submission even though the submission was really invalid.  It just took it a longer time to figure it out when the problem occurs.  Maybe this should be fixed on the YARN side instead?, Integrated in Hadoop-trunk-Commit #3230 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/3230/])
    MAPREDUCE-4938. Use token request messages defined in hadoop common. Contributed by Suresh Srinvias. (Revision 1433227)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1433227
Files : 
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/client/MRClientProtocolPBClientImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/service/MRClientProtocolPBServiceImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/MRClientProtocol.proto
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/mr_service_protos.proto
, Integrated in Hadoop-Yarn-trunk #97 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/97/])
    MAPREDUCE-4938. Use token request messages defined in hadoop common. Contributed by Suresh Srinvias. (Revision 1433227)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1433227
Files : 
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/client/MRClientProtocolPBClientImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/service/MRClientProtocolPBServiceImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/MRClientProtocol.proto
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/mr_service_protos.proto
, Integrated in Hadoop-Hdfs-trunk #1286 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1286/])
    MAPREDUCE-4938. Use token request messages defined in hadoop common. Contributed by Suresh Srinvias. (Revision 1433227)

     Result = FAILURE
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1433227
Files : 
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/client/MRClientProtocolPBClientImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/service/MRClientProtocolPBServiceImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/MRClientProtocol.proto
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/mr_service_protos.proto
, Integrated in Hadoop-Mapreduce-trunk #1314 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1314/])
    MAPREDUCE-4938. Use token request messages defined in hadoop common. Contributed by Suresh Srinvias. (Revision 1433227)

     Result = FAILURE
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1433227
Files : 
* /hadoop/common/trunk/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/client/MRClientProtocolPBClientImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/impl/pb/service/MRClientProtocolPBServiceImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/CancelDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/GetDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenRequestPBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/api/protocolrecords/impl/pb/RenewDelegationTokenResponsePBImpl.java
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/MRClientProtocol.proto
* /hadoop/common/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/proto/mr_service_protos.proto
, Looks like a checkin comment typo caused some commit build results to be posted to the wrong JIRA., This is fixed by YARN-3131 since application submit will wait until the app reaches the ACCEPTED state or later before returning.  Submissions to unknown queues won't make it to the ACCEPTED state so the client will see the exception and cleanup the staging directory.]