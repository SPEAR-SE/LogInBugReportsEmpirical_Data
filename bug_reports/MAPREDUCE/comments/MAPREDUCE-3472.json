[Konstantin, since you are fixing stuff in the CapacityScheduler (e.g. MAPREDUCE-3026), you might want to port this also. Please take a look, thanks. I'll assign this to you for now.

This is critical for performance and utilization in the cluster if you are using the CapacityScheduler.]