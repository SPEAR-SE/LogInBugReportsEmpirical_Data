[The code does the right thing. It looks for maps that are non-local to any node in the cluster, then others. It assumes, however, that a job may have some non-local maps (i.e., the JobInProgress object's _nonLocalRunningMaps_ structure is not empty), as well as other running maps (in the _runningMapCache_ structure). Amar informs me that these two are mutually exclusive, i.e., a job will have one or the other structure empty. So, the right thing to do is modify the comment in CapacityTaskScheduler.killTasksFromJob() to reflect this, and wrap the calls to _job.getNonLocalRunningMaps()_ and _job.getRunningMapCache()_ in an if...then...else block. , Preemption is removed after HADOOP-5726. This issue is no longer valid.]