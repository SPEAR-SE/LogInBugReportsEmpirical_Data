[The patch part of the patch in YARN-84. Still uploaded it here just to save a record for the MapReduce change in JIRA system., Thanks Brandon. Closing this as duplicate.]