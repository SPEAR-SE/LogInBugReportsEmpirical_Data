[I believe, and could very well be wrong, that the problem here is that some of the the threads that do cleanup etc in the history server when they catch an exception (like when the NameNode is down) they simply log the exception and exit the thread.  Once the thread has exited we will not try any more to clean up or move data to done., I am in the process of working on MAPREDUCE-3972.  It is rather complex to get the locking correct on it and is taking a lot longer then I expected.  I also intend to fix these exception issues while I am at it.  It would be good to retest after MAPREDUCE-3972 is in., It is fixed and working fine now.]