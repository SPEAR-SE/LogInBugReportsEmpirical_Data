[[~jlowe], [~wangda] , From the stack trace Found that the error is from Mapreduce 2.7.1 Client code. 
 Where the Resource manager and nodemanager is running on 2.9.0.
 So the client code is 2.7.1 and error is from that client code which may not be handled in 2.9.0., This we found in nodemanager where 2.9.0 hadoop is installed and the framework path is pointed to 2.7.1.

This lead to job failures on the cluster randomly.

Ex:

During restart of this particular node will cause the AM to fail with following exception.

ERROR [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator: ERROR IN CONTACTING RM. java.lang.NullPointerException at org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator.handleUpdatedNodes(RMContainerAllocator.java:800) at org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator.getResources(RMContainerAllocator.java:736) at org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator.heartbeat(RMContainerAllocator.java:244) at org.apache.hadoop.mapreduce.v2.app.rm.RMCommunicator$1.run(RMCommunicator.java:282) at java.lang.Thread.run(Thread.java:745) 2018-07-25 08:44:52,704 DEBUG [IPC Server handler 6 on 24503] org.apache.hadoop.ipc.Server: IPC Server handler 6 on 24503: statusUpdate(attempt_1532432962204_0011_m_000000_0, org.apache.hadoop.mapred.MapTaskStatus@32c2a068), rpc version=2, client version=19, methodsFingerPrint=937413979 from 10.3x.x.x:21017 Call#16 Retry#0 for RpcKind RPC_WRITABLE 2018-07-25 08:44:52,704 FATAL [AsyncDispatcher event handler] org.apache.hadoop.yarn.event.AsyncDispatcher: Error in dispatcher thread java.lang.NullPointerException at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$UpdatedNodesTransition.transition(JobImpl.java:2144) at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$UpdatedNodesTransition.transition(JobImpl.java:2137) at org.apache.hadoop.yarn.state.StateMachineFactory$SingleInternalArc.doTransition(StateMachineFactory.java:362) at org.apache.hadoop.yarn.state.StateMachineFactory.doTransition(StateMachineFactory.java:302) at org.apache.hadoop.yarn.state.StateMachineFactory.access$300(StateMachineFactory.java:46) at org.apache.hadoop.yarn.state.StateMachineFactory$InternalStateMachine.doTransition(StateMachineFactory.java:448) at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl.handle(JobImpl.java:996) at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl.handle(JobImpl.java:138) at org.apache.hadoop.mapreduce.v2.app.MRAppMaster$JobEventDispatcher.handle(MRAppMaster.java:1289) at org.apache.hadoop.mapreduce.v2.app.MRAppMaster$JobEventDispatcher.handle(MRAppMaster.java:1285) at org.apache.hadoop.yarn.event.AsyncDispatcher.dispatch(AsyncDispatcher.java:173) at org.apache.hadoop.yarn.event.AsyncDispatcher$1.run(AsyncDispatcher.java:106) at java.lang.Thread.run(Thread.java:745)

 , Closing this because we are using HDP Client jar of 2.7.1 on 2.9.0 server.
This is not recommended so closing this.]