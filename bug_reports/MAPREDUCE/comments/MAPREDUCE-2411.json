[solves the issue, Attaching patch on Dick's behalf. It replaces the asserts with exceptions., I committed this to branch-0.20-security.

Thanks, Dick!, Hadoop 0.20.204.0 was just released.]