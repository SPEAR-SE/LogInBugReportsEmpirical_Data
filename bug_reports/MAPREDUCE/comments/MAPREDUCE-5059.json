[[~jlowe] what is the expected value for the "Average merger time" and "Elapsed merge time"? , Personally I think it'd be more useful to calculate merge time as the time delta between the end of the shuffle and the start of the reduce phase (i.e.: what the task attempts page is already showing for each reduce task attempt).  I understand that the shuffle and merge phases overlap in practice, but really what we're looking for here is excessive time spent merging even after the data has been shuffled to the reducer., Making sure that Average Merge time = average of (attempt.sortFinishTime - attempt.shuffleFinishTime), {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12575435/MAPREDUCE-5059-20130325.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 3 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/3468//testReport/
Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/3468//console

This message is automatically generated., bq. Personally I think it'd be more useful to calculate merge time as the time delta between the end of the shuffle and the start of the reduce phase (i.e.: what the task attempts page is already showing for each reduce task attempt). I understand that the shuffle and merge phases overlap in practice, but really what we're looking for here is excessive time spent merging even after the data has been shuffled to the reducer.
+1 for doing this, I too agree that it is more useful this way.

The patch looks mostly good to me.
 - Can you remove the old code completely, instead of commenting it out?
 - In the test, I couldn't figure out why the expected time was 50, can you put a small comment saying it's an average of 45 and 55, or something of that sort?

Also the shown time is sort+merge time from shuffleEnd, not sure how we can make that clear.
, * removed commented code
* Yes individual merge time is 45 and 55. I have added a comment in the TestJobInfo., {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12578138/MAPREDUCE-5059-20130410.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 3 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/3516//testReport/
Console output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/3516//console

This message is automatically generated., +1, this looks good. Checking it in., I just committed this to trunk and branch-2. Thanks Omkar!, Thanks, Omkar!  I committed this to branch-0.23 as well., Integrated in Hadoop-Hdfs-0.23-Build #611 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/611/])
    svn merge -c 1467120 FIXES: MAPREDUCE-5059. Change average merge time on Job overview page to be the time delta between the end of the shuffle and the start of the reduce. Contributed by Omkar Vinit Joshi (Revision 1483885)

     Result = SUCCESS
jlowe : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1483885
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-mapreduce-project/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/src/main/java/org/apache/hadoop/mapreduce/v2/hs/webapp/dao/JobInfo.java
* /hadoop/common/branches/branch-0.23/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/src/test/java/org/apache/hadoop/mapreduce/v2/hs/TestJobHistoryEntities.java
* /hadoop/common/branches/branch-0.23/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/src/test/java/org/apache/hadoop/mapreduce/v2/hs/webapp/dao
* /hadoop/common/branches/branch-0.23/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/src/test/java/org/apache/hadoop/mapreduce/v2/hs/webapp/dao/TestJobInfo.java
* /hadoop/common/branches/branch-0.23/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/src/test/resources/job_1329348432655_0001-1329348443227-user-Sleep+job-1329348468601-10-1-SUCCEEDED-default.jhist
, This appears to be in branch-2, but not trunk, Nevermind, my bad, was just looking at commits, somehow the fix got into trunk anyway.]