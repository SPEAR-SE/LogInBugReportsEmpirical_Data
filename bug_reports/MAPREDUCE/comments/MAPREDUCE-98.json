[we see this error in the job-tracker logs

2009-04-01 17:39:51,789 INFO org.apache.hadoop.ipc.Server: IPC Server handler 3 on 9001 caught: java.lang.NullPointerException
	at org.apache.hadoop.mapred.TaskReport.write(TaskReport.java:132)
	at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:159)
	at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:126)
	at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:70)
, and the NPE appears to happen on the last line => counters is null

{code}
 public void write(DataOutput out) throws IOException {
    taskid.write(out);
    out.writeFloat(progress);
    Text.writeString(out, state);
    out.writeLong(startTime);
    out.writeLong(finishTime);
    WritableUtils.writeStringArray(out, diagnostics);
    counters.write(out);
  }
{code}, code that brought about this bug;  hangs on one particular job in the loop to get map task reports.

{code}
log.info("start: querying hadoop job tracker %s", conf.get("mapred.job.tracker"));

for (JobStatus jobStatus : jobClient.getAllJobs()) {
    List<MapTaskProfile> mapTaskProfileList = new ArrayList<MapTaskProfile>();
    for (TaskReport taskReport : jobClient.getMapTaskReports(jobStatus.getJobID())) {
        mapTaskProfileList.add(new MapTaskProfile(taskReport, jobStatus.getJobID().toString()));
    }

	List<ReduceTaskProfile> reduceTaskProfileList = new ArrayList<ReduceTaskProfile>();
	for (TaskReport taskReport : jobClient.getReduceTaskReports(jobStatus.getJobID())) {
		reduceTaskProfileList.add(new ReduceTaskProfile(taskReport, jobStatus.getJobID().toString()));
	}

	RunningJob runningJob = jobClient.getJob(jobStatus.getJobID());
	if (runningJob != null) {
		eventList.add(new JobProfileEvent(eventBatchId.get(), new DateTime(),
			new JobProfile(jobStatus, runningJob.getJobName(), mapTaskProfileList, reduceTaskProfileList, runningJob.getCounters()))
		);
	}
}

log.info("end: querying hadoop job tracker %s", conf.get("mapred.job.tracker"));
{code}


if i try to view the info of this job from the jobtracker gui, i also get a 500 and the logs show the same NPE

2009-04-01 17:40:06,400 WARN /: /jobdetails.jsp?jobid=job_200902281847_18859&refresh=0: 
java.lang.NullPointerException

, The attached patch should fix this. Could you please give it a shot? Thanks!, I haven't seen this occur lately. It has been fixed/taken care of already. Given that this issue has gone stale now, I am resolving it.]