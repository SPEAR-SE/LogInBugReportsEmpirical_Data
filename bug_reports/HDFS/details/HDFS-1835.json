{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12504226","self":"https://issues.apache.org/jira/rest/api/2/issue/12504226","key":"HDFS-1835","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315571","id":"12315571","description":"","name":"0.23.0","archived":false,"released":true,"releaseDate":"2011-11-11"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-04-19T08:03:25.413+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Sep 17 01:31:22 UTC 2011","customfield_12310420":"15557","customfield_12312320":null,"customfield_12310222":"10002_*:*_2_*:*_2159531116_*|*_1_*:*_2_*:*_431803373_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-05-14T04:27:54.108+0000","workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-1835/watchers","watchCount":6,"isWatching":false},"created":"2011-04-14T04:38:59.728+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":600,"aggregatetimeoriginalestimate":600,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314204","id":"12314204","description":"","name":"0.20.2","archived":false,"released":true,"releaseDate":"2010-02-16"}],"issuelinks":[{"id":"12343129","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12343129","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12523080","key":"HDFS-2335","self":"https://issues.apache.org/jira/rest/api/2/issue/12523080","fields":{"summary":"DataNodeCluster and NNStorage always pull fresh entropy","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-11-15T00:52:46.526+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312927","id":"12312927","name":"datanode"}],"timeoriginalestimate":600,"description":"DataNode.setNewStorageID uses SecureRandom.getInstance(\"SHA1PRNG\") which always pulls fresh entropy.\n\nIt wouldn't be so bad if this were only the 120 bits needed by sha1, but the default impl of SecureRandom actually uses a BufferedInputStream around /dev/random and pulls 1024 bits of entropy for this one call.\n\nIf you are on a system without much entropy coming in, this call can block and block others.\n\nCan we just change this to use \"new SecureRandom().nextInt(Integer.MAX_VALUE)\" instead?","customfield_10010":null,"timetracking":{"originalEstimate":"10m","remainingEstimate":"10m","originalEstimateSeconds":600,"remainingEstimateSeconds":600},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12476682","id":"12476682","filename":"DataNode.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-19T04:46:58.891+0000","size":890,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12476682/DataNode.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12479213","id":"12479213","filename":"hdfs-1835.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-05-14T04:26:25.059+0000","size":823,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12479213/hdfs-1835.txt"}],"aggregatetimeestimate":600,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"53217","customfield_12312823":null,"summary":"DataNode.setNewStorageID pulls entropy from /dev/random","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":600,"percent":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":600,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021404","id":"13021404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"by 120 bits, I mean 160 bits. 20 bytes. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-19T04:29:13.729+0000","updated":"2011-04-19T04:29:13.729+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021407","id":"13021407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"Index: src/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java\n===================================================================\n--- src/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java       (revision 1094852)\n+++ src/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java       (working copy)\n@@ -654,7 +654,7 @@\n     \n     int rand = 0;\n     try {\n-      rand = SecureRandom.getInstance(\"SHA1PRNG\").nextInt(Integer.MAX_VALUE);\n+      rand = new SecureRandom().nextInt(Integer.MAX_VALUE);\n     } catch (NoSuchAlgorithmException e) {\n       LOG.warn(\"Could not use SecureRandom\");\n       rand = R.nextInt(Integer.MAX_VALUE);\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-19T04:35:27.568+0000","updated":"2011-04-19T04:35:27.568+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021408","id":"13021408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"Index: src/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java\n===================================================================\n--- src/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java       (revision 1094852)\n+++ src/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java       (working copy)\n@@ -652,13 +652,7 @@\n       LOG.warn(\"Could not find ip address of \\\"default\\\" inteface.\");\n     }\n     \n-    int rand = 0;\n-    try {\n-      rand = SecureRandom.getInstance(\"SHA1PRNG\").nextInt(Integer.MAX_VALUE);\n-    } catch (NoSuchAlgorithmException e) {\n-      LOG.warn(\"Could not use SecureRandom\");\n-      rand = R.nextInt(Integer.MAX_VALUE);\n-    }\n+    int rand = new SecureRandom().nextInt(Integer.MAX_VALUE);\n     dnReg.storageID = \"DS-\" + rand + \"-\"+ ip + \"-\" + dnReg.getPort() + \"-\" + \n                       System.currentTimeMillis();\n   }\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-19T04:44:47.187+0000","updated":"2011-04-19T04:44:47.187+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021409","id":"13021409","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"I don't understand the \"create patch\" tool, so I'm just going to upload a patch file.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-19T04:46:58.959+0000","updated":"2011-04-19T04:46:58.959+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021458","id":"13021458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12476682/DataNode.patch\n  against trunk revision 1094748.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed these core unit tests:\n                  org.apache.hadoop.hdfs.TestFileAppend4\n                  org.apache.hadoop.hdfs.TestLargeBlock\n                  org.apache.hadoop.hdfs.TestWriteConfigurationToDFS\n\n    -1 contrib tests.  The patch failed contrib unit tests.\n\n    +1 system test framework.  The patch passed system test framework compile.\n\nTest results: https://hudson.apache.org/hudson/job/PreCommit-HDFS-Build/382//testReport/\nFindbugs warnings: https://hudson.apache.org/hudson/job/PreCommit-HDFS-Build/382//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://hudson.apache.org/hudson/job/PreCommit-HDFS-Build/382//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-19T08:03:25.413+0000","updated":"2011-04-19T08:03:25.413+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021681","id":"13021681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"The difference between my patch and the original only exists on the linux version of the jre.  On windows it behaves the same. \n\nThe original behavior was to seed a sha1prng with randomness from /dev/random.\nThe new  behavior is to just read from /dev/urandom.  Writing a test to tell these two cases apart would be quite difficult.\n\nI think the best way would involve turning off all entropy generation on linux and then consuming all the entropy, then running DataNode.setNewStorageID to make sure it doesn't block.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-19T17:42:01.378+0000","updated":"2011-04-19T17:42:01.378+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13021968","id":"13021968","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"I have a test that can go into the org/apache/hadoop/hdfs/server/datanode package\n\n\tpublic void testRate() throws Exception {\n\t\tDatanodeRegistration reg = new DatanodeRegistration();\n\t\treg.setName(\"name\");\n\t\tlong startTime = System.currentTimeMillis();\n\t\tlong count = 0;\n\t\twhile (System.currentTimeMillis() - startTime < 20) {\n\t\t\tDataNode.setNewStorageID(reg);\n\t\t\tcount++;\n\t\t}\n\t\tassertTrue(\"count was: \" + count, count > 10);\n\t}\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-04-20T05:25:19.263+0000","updated":"2011-04-20T05:25:19.263+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13033447","id":"13033447","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"+1, since this isn't for anything truly cryptographic, and we have other parts of the string to make it unique (ie IP, port, time), I don't see any reason to specify which PRNG to use.\n\nThe test case proposed, though, is way too likely to be flaky, so I won't include it in commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-05-14T04:24:27.841+0000","updated":"2011-05-14T04:24:27.841+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13033449","id":"13033449","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Rebased John's patch on trunk (federation made an unrelated change that made it not apply, but code is the same)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-05-14T04:26:25.100+0000","updated":"2011-05-14T04:26:25.100+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13033450","id":"13033450","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Committed to trunk. Thanks, John!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-05-14T04:27:54.156+0000","updated":"2011-05-14T04:27:54.156+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13034583","id":"13034583","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Hdfs-trunk-Commit #658 (See [https://builds.apache.org/hudson/job/Hadoop-Hdfs-trunk-Commit/658/])\n    ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2011-05-17T05:36:26.791+0000","updated":"2011-05-17T05:36:26.791+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13037343","id":"13037343","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Hdfs-trunk #673 (See [https://builds.apache.org/hudson/job/Hadoop-Hdfs-trunk/673/])\n    ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2011-05-21T12:38:09.154+0000","updated":"2011-05-21T12:38:09.154+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13101653","id":"13101653","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Shouldn't we make this change to DataNodeCluster and NNStorage as well? They're not truly cryptographic uses as well. We should also factor this out to a utility method, seems like the three uses are slightly different, eg one uses DFSUtil.getRandom and the other creates a new Random object.\n\nOn a somewhat related note, a workaround for the blocking is to use urandom, however according to this bug (http://bugs.sun.com/view_bug.do?bug_id=6202721) setting securerandom.source to \"/dev/urandom\" doesn't actually work when using SHA1PRNG.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-09-09T23:44:23.722+0000","updated":"2011-09-09T23:44:23.722+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13101979","id":"13101979","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"One issue we saw was that if some processes were reading from urandom it would still eat up entropy.  Then when a process actually needed /dev/random, there wouldn't be any entropy left and it would block.  Also I think the securerandom.source setting is system wide and I think that is a bit heavy handed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-09-10T05:22:21.776+0000","updated":"2011-09-10T05:22:21.776+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13104724","id":"13104724","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Perhaps because it wasn't actually reading from urandom (per above bug)? \n\nFiled HDFS-2335 for propagating this change to DataNodeCluster and NNStorage.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-09-14T17:56:00.751+0000","updated":"2011-09-14T17:56:00.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504226/comment/13106993","id":"13106993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"body":"If you just 'cat /dev/urandom > /dev/null' it will eat entropy.  urandom prefers entropy, but doesn't require it.  Even if you are using urandom, you can push the entropy low enough that if someone then uses /dev/random, it may block.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnyoh","name":"johnyoh","key":"johnyoh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Carrino","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-09-17T01:31:22.256+0000","updated":"2011-09-17T01:31:22.256+0000"}],"maxResults":16,"total":16,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-1835/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i09h6n:"}}