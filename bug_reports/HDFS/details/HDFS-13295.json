{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13145425","self":"https://issues.apache.org/jira/rest/api/2/issue/13145425","key":"HDFS-13295","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-03-15T19:17:53.541+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Mar 27 09:20:44 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-13295/watchers","watchCount":5,"isWatching":false},"created":"2018-03-15T16:20:23.863+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-03-27T09:20:44.093+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312926","id":"12312926","name":"namenode"}],"timeoriginalestimate":null,"description":"When we set dfs.namenode.safemode.replication.min < dfs.namenode.replication.min from HDFS-8716 patch the number of replica for which it will increase the safe block count\r\nmust be equal to dfs.namenode.safemode.replication.min in `FSNamesystem.incrementSafeBlockCount`\r\n\r\nWhen reading modification from edits, the replica number for new blocks is set at min(numNodes,\r\ndfs.namenode.replication.min) in BlockManager.completeBlock which is greater than dfs.namenode.safemode.replication.min.\r\nDue to that safe block count never reach number of available blocks and namenode doesn't leave automatically the safemode","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12915353","id":"12915353","filename":"HDFS-13295.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-20T16:48:29.988+0000","size":7894,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12915353/HDFS-13295.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12915354","id":"12915354","filename":"HDFS-13295.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-20T16:52:44.851+0000","size":7793,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12915354/HDFS-13295.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12914732","id":"12914732","filename":"HDFS-13295.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-15T16:31:16.339+0000","size":2735,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12914732/HDFS-13295.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Namenode doesn't leave safemode if dfs.namenode.safemode.replication.min set < dfs.namenode.replication.min","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"CDH 5.11 with HDFS-8716 backported.\r\n\r\ndfs.namenode.replication.min=2\r\ndfs.namenode.safemode.replication.min=1\r\n\r\n ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16400984","id":"16400984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 38s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 20m 37s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 12s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  0s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 23s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 13m 39s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 15s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 16s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 10s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 10s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m  2s{color} | {color:orange} hadoop-hdfs-project/hadoop-hdfs: The patch generated 2 new + 112 unchanged - 0 fixed = 114 total (was 112) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 11s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 12m 52s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 41s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 94m 13s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 22s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}156m 58s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.server.namenode.ha.TestBootstrapStandbyWithQJM |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStream |\r\n|   | hadoop.hdfs.tools.TestDFSZKFailoverController |\r\n|   | hadoop.hdfs.web.TestWebHdfsTimeouts |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStreamKerberized |\r\n|   | hadoop.hdfs.server.namenode.TestCheckpoint |\r\n|   | hadoop.hdfs.TestDFSUpgradeFromImage |\r\n|   | hadoop.hdfs.tools.TestGetGroups |\r\n|   | hadoop.hdfs.server.namenode.TestStartup |\r\n|   | hadoop.hdfs.TestDFSStorageStateRecovery |\r\n|   | hadoop.hdfs.server.mover.TestMover |\r\n|   | hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRecovery |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureOfSharedDir |\r\n|   | hadoop.hdfs.server.namenode.TestFSEditLogLoader |\r\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandby |\r\n|   | hadoop.hdfs.tools.TestDelegationTokenFetcher |\r\n|   | hadoop.hdfs.TestSetTimes |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockTokenWithDFS |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDelegationTokensWithHA |\r\n|   | hadoop.hdfs.server.namenode.ha.TestNNHealthCheck |\r\n|   | hadoop.hdfs.TestDFSRollback |\r\n|   | hadoop.hdfs.TestDFSUpgrade |\r\n|   | hadoop.hdfs.server.namenode.TestProtectedDirectories |\r\n|   | hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithEncryptedTransfer |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotDeletion |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\r\n|   | hadoop.hdfs.server.namenode.TestStorageRestore |\r\n|   | hadoop.hdfs.server.namenode.TestSaveNamespace |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogsDuringFailover |\r\n|   | hadoop.hdfs.server.namenode.TestSecureNameNode |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestDiffListBySkipList |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations |\r\n|   | hadoop.hdfs.TestDFSStartupVersions |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyInProgressTail |\r\n|   | hadoop.hdfs.web.TestWebHdfsWithRestCsrfPreventionFilter |\r\n|   | hadoop.hdfs.server.namenode.ha.TestRetryCacheWithHA |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithSaslDataTransfer |\r\n|   | hadoop.hdfs.server.namenode.ha.TestGetGroupsWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestFsck |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeMXBean |\r\n|   | hadoop.hdfs.TestDFSMkdirs |\r\n|   | hadoop.hdfs.TestRollingUpgrade |\r\n|   | hadoop.hdfs.server.namenode.TestFSImage |\r\n|   | hadoop.hdfs.server.balancer.TestBalancer |\r\n|   | hadoop.hdfs.server.namenode.TestEditLog |\r\n|   | hadoop.hdfs.TestSafeMode |\r\n|   | hadoop.hdfs.server.namenode.TestBackupNode |\r\n|   | hadoop.hdfs.tools.TestDFSAdminWithHA |\r\n|   | hadoop.hdfs.web.TestWebHdfsTokens |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStateTransitionFailure |\r\n|   | hadoop.hdfs.server.namenode.TestGenericJournalConf |\r\n|   | hadoop.hdfs.TestFileCreation |\r\n|   | hadoop.hdfs.TestDatanodeRegistration |\r\n|   | hadoop.hdfs.TestDistributedFileSystem |\r\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAFsck |\r\n|   | hadoop.hdfs.TestDatanodeConfig |\r\n|   | hadoop.hdfs.server.namenode.TestNNStorageRetentionFunctional |\r\n|   | hadoop.hdfs.server.namenode.TestListOpenFiles |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits |\r\n|   | hadoop.hdfs.server.namenode.ha.TestLossyRetryInvocationHandler |\r\n|   | hadoop.hdfs.tools.TestDFSHAAdminMiniCluster |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogAutoroll |\r\n|   | hadoop.hdfs.server.namenode.TestTransferFsImage |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\r\n|   | hadoop.hdfs.TestFileAppendRestart |\r\n|   | hadoop.hdfs.TestRollingUpgradeRollback |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureReporting |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAStateTransitions |\r\n|   | hadoop.hdfs.web.TestWebHDFSForHA |\r\n|   | hadoop.hdfs.qjournal.server.TestJournalNodeSync |\r\n|   | hadoop.hdfs.server.namenode.TestFSNamesystemMBean |\r\n|   | hadoop.hdfs.server.namenode.TestHostsFiles |\r\n|   | hadoop.hdfs.qjournal.TestNNWithQJM |\r\n|   | hadoop.hdfs.TestRollingUpgradeDowngrade |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerRPCDelay |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogJournalFailures |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRespectsBindHostKeys |\r\n|   | hadoop.hdfs.security.TestDelegationToken |\r\n|   | hadoop.hdfs.web.TestWebHDFS |\r\n|   | hadoop.hdfs.server.namenode.TestSecondaryWebUi |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:d4cc50f |\r\n| JIRA Issue | HDFS-13295 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12914732/HDFS-13295.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 84efc9f08557 3.13.0-135-generic #184-Ubuntu SMP Wed Oct 18 11:55:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 5e013d5 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23502/artifact/out/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23502/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23502/testReport/ |\r\n| Max. process+thread count | 4251 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23502/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-15T19:17:53.541+0000","updated":"2018-03-15T19:17:53.541+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16403125","id":"16403125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bharatviswa","name":"bharatviswa","key":"bharatviswa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bharat Viswanadham","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~nfraison.criteo]\r\n\r\nOne question I have from the description, have you faced this issue on the cluster?\r\n\r\nBecause when loading from edit logs, in blockInfo object storage will not be set, this will be set when block reports are received.\r\n\r\nSo, I think we will not hit the issue.\r\n\r\nI have tried setting dfs.namenode.safemode.replication.min set < dfs.namenode.replication.min and then restarted my test cluster, not faced this issue.\r\n\r\nLet me know if i am missing something here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bharatviswa","name":"bharatviswa","key":"bharatviswa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bharat Viswanadham","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-16T23:44:04.937+0000","updated":"2018-03-16T23:45:09.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16404483","id":"16404483","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"body":"Hi [~bharatviswa]\r\nYes I have faced this issue on my cluster.\r\nAt the beginning number of blocks to report were decreasing as usual. After reaching 1k to 10 k blocks it then start to increase back almost every minute (that's why I was thinking of modification from edits logs)\r\nTo understand what happens I attached a debugger on namenode and see that block reported by BlockManager.completeBlock were always send with a minimum of 2 which was greater to the min replication safemode I set.\r\nI think that if there are not enough changes on the cluster or if the namenode start fastly, you will probably not hit this issue.\r\nAfter applying the patch I don't see anymore the issue.\r\n\r\nHere is the thread stack of the EditLogTailer (from the cdh5.11 we use) were I can see those call to incrementSafeBlockCount with replication number set at 2:\r\n{code}\r\n\"Edit log tailer@6272\" prio=5 tid=0x55b nid=NA runnable\r\n  java.lang.Thread.State: RUNNABLE\r\n\t  at org.apache.hadoop.hdfs.server.blockmanagement.BlockManager.completeBlock(BlockManager.java:811)\r\n\t  at org.apache.hadoop.hdfs.server.blockmanagement.BlockManager.completeBlock(BlockManager.java:823)\r\n\t  at org.apache.hadoop.hdfs.server.blockmanagement.BlockManager.forceCompleteBlock(BlockManager.java:836)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.FSEditLogLoader.updateBlocks(FSEditLogLoader.java:954)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.FSEditLogLoader.applyEditLogOp(FSEditLogLoader.java:433)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.FSEditLogLoader.loadEditRecords(FSEditLogLoader.java:231)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.FSEditLogLoader.loadFSEdits(FSEditLogLoader.java:140)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.FSImage.loadEdits(FSImage.java:856)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.FSImage.loadEdits(FSImage.java:837)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer.doTailEdits(EditLogTailer.java:262)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.doWork(EditLogTailer.java:395)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.access$300(EditLogTailer.java:348)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread$1.run(EditLogTailer.java:365)\r\n\t  at java.security.AccessController.doPrivileged(AccessController.java:-1)\r\n\t  at javax.security.auth.Subject.doAs(Subject.java:360)\r\n\t  at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1900)\r\n\t  at org.apache.hadoop.security.SecurityUtil.doAsLoginUserOrFatal(SecurityUtil.java:442)\r\n\t  at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.run(EditLogTailer.java:361)\r\n{code}\r\n\r\nValue of ucBlock (curBlock in trunk) in completeBlock:\r\n{code}\r\nblk_1155343062_81635483{blockUCState=COMMITTED, primaryNodeIndex=-1, replicas=[ReplicaUnderConstruction[[DISK]DS-c175308c-644d-48dc-bbf1-bf3e95a656de:NORMAL:10.60.32.151:1004|FINALIZED], ReplicaUnderConstruction[[DISK]DS-59732d1e-6181-4595-b0aa-376c44e1d1fd:NORMAL:10.60.32.236:1004|FINALIZED], ReplicaUnderConstruction[[DISK]DS-a0924255-bb90-45fb-9d67-2498c6e6559d:NORMAL:10.60.32.155:1004|FINALIZED]]}\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-19T08:19:56.002+0000","updated":"2018-03-19T08:21:17.724+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16405605","id":"16405605","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bharatviswa","name":"bharatviswa","key":"bharatviswa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bharat Viswanadham","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~nfraison.criteo]\r\n\r\nThanks for the info. I am not clear, what is the reason for above stack trace and how is it related here?\r\n\r\nBecause if it is calling from forceCompleteBlock, force will be set to true, and it will not throw any exceptions.\r\n\r\n \r\n{code:java}\r\nif (!force && !hasMinStorage(curBlock, numNodes))\r\n{ throw new IOException(\"Cannot complete block: \" + \"block does not satisfy minimal replication requirement.\"); }\r\nif (!force && curBlock.getBlockUCState() != BlockUCState.COMMITTED)\r\n{ throw new IOException( \"Cannot complete block: block has not been COMMITTED by the client\"); }\r\n{code}\r\n \r\n\r\nIf the block reported is from edit logs, it will not have storages set, so numNodes will be 0 right?\r\n{code:java}\r\nint numNodes = curBlock.numNodes();{code}\r\nso, when calling \r\n{code:java}\r\nbmSafeMode.incrementSafeBlockCount(Math.min(numNodes, minStorage),curBlock{code}\r\nit will be passed with\r\n\r\nbmSafeMode.incrementSafeBlockCount(Math.min(0,<<value>>,curBlock).\r\n\r\nSo, still, i am not convinced how when reading from edit logs this will cause the issue.\r\n\r\n \r\n\r\n \r\n\r\nCan we have any simple UT for this behavior?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bharatviswa","name":"bharatviswa","key":"bharatviswa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bharat Viswanadham","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-19T23:48:19.744+0000","updated":"2018-03-19T23:49:37.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16406678","id":"16406678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"body":"[~bharatviswa] I've added a test TestBlockManager2 to confirm the issue. If you run this test on the trunk (+ set method FSNamesystem.leaveSafeMode in public) you will spot the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-20T16:51:27.901+0000","updated":"2018-03-20T16:51:27.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16406868","id":"16406868","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 19s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 18m  2s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  1s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 51s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  2s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 52s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 52s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 45s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 58s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 53s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 53s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 48s{color} | {color:orange} hadoop-hdfs-project/hadoop-hdfs: The patch generated 42 new + 284 unchanged - 0 fixed = 326 total (was 284) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  7s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m  2s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 55s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 44s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 74m 13s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 27s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}127m 29s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.server.namenode.ha.TestBootstrapStandby |\r\n|   | hadoop.hdfs.server.namenode.TestFSEditLogLoader |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDelegationTokensWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRespectsBindHostKeys |\r\n|   | hadoop.hdfs.server.namenode.TestNNStorageRetentionFunctional |\r\n|   | hadoop.hdfs.server.namenode.TestSaveNamespace |\r\n|   | hadoop.hdfs.server.namenode.TestFsck |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStreamKerberized |\r\n|   | hadoop.hdfs.server.namenode.TestStorageRestore |\r\n|   | hadoop.hdfs.qjournal.TestNNWithQJM |\r\n|   | hadoop.hdfs.tools.TestDelegationTokenFetcher |\r\n|   | hadoop.hdfs.server.namenode.TestSecureNameNode |\r\n|   | hadoop.hdfs.TestDatanodeRegistration |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockManager2 |\r\n|   | hadoop.hdfs.TestDFSStartupVersions |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureOfSharedDir |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStateTransitionFailure |\r\n|   | hadoop.hdfs.server.namenode.TestGenericJournalConf |\r\n|   | hadoop.hdfs.web.TestWebHdfsWithRestCsrfPreventionFilter |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyInProgressTail |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestDiffListBySkipList |\r\n|   | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |\r\n|   | hadoop.hdfs.TestFileAppendRestart |\r\n|   | hadoop.hdfs.server.namenode.TestEditLog |\r\n|   | hadoop.hdfs.server.mover.TestMover |\r\n|   | hadoop.hdfs.TestSafeMode |\r\n|   | hadoop.hdfs.tools.TestDFSZKFailoverController |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockTokenWithDFS |\r\n|   | hadoop.hdfs.TestRollingUpgrade |\r\n|   | hadoop.hdfs.TestFileCreation |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureReporting |\r\n|   | hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAStateTransitions |\r\n|   | hadoop.hdfs.qjournal.server.TestJournalNodeSync |\r\n|   | hadoop.hdfs.TestRollingUpgradeDowngrade |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogsDuringFailover |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\r\n|   | hadoop.hdfs.tools.TestGetGroups |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRecovery |\r\n|   | hadoop.hdfs.TestDistributedFileSystem |\r\n|   | hadoop.hdfs.server.namenode.TestProtectedDirectories |\r\n|   | hadoop.hdfs.server.balancer.TestBalancer |\r\n|   | hadoop.hdfs.server.namenode.ha.TestNNHealthCheck |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogJournalFailures |\r\n|   | hadoop.hdfs.TestDFSMkdirs |\r\n|   | hadoop.hdfs.TestDatanodeConfig |\r\n|   | hadoop.hdfs.server.namenode.TestBackupNode |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyPersistReplicaRecovery |\r\n|   | hadoop.hdfs.server.namenode.TestCheckpoint |\r\n|   | hadoop.hdfs.server.namenode.ha.TestGetGroupsWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerRPCDelay |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithSaslDataTransfer |\r\n|   | hadoop.hdfs.tools.TestDFSAdminWithHA |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations |\r\n|   | hadoop.hdfs.server.namenode.TestStartup |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits |\r\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotDeletion |\r\n|   | hadoop.hdfs.web.TestWebHDFS |\r\n|   | hadoop.hdfs.TestDFSUpgrade |\r\n|   | hadoop.hdfs.server.namenode.TestListOpenFiles |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeMXBean |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithEncryptedTransfer |\r\n|   | hadoop.hdfs.TestRollingUpgradeRollback |\r\n|   | hadoop.hdfs.web.TestWebHDFSForHA |\r\n|   | hadoop.hdfs.server.namenode.TestHostsFiles |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\r\n|   | hadoop.hdfs.TestSetTimes |\r\n|   | hadoop.hdfs.TestDFSUpgradeFromImage |\r\n|   | hadoop.hdfs.TestDFSStorageStateRecovery |\r\n|   | hadoop.hdfs.tools.TestDFSHAAdminMiniCluster |\r\n|   | hadoop.hdfs.security.TestDelegationToken |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStream |\r\n|   | hadoop.hdfs.server.namenode.TestFSNamesystemMBean |\r\n|   | hadoop.hdfs.server.namenode.TestSecondaryWebUi |\r\n|   | hadoop.hdfs.web.TestWebHdfsTokens |\r\n|   | hadoop.hdfs.server.namenode.ha.TestLossyRetryInvocationHandler |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogAutoroll |\r\n|   | hadoop.hdfs.server.namenode.TestFSImage |\r\n|   | hadoop.hdfs.server.namenode.TestTransferFsImage |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAFsck |\r\n|   | hadoop.hdfs.TestDFSRollback |\r\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandbyWithQJM |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:d4cc50f |\r\n| JIRA Issue | HDFS-13295 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12915354/HDFS-13295.2.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 6115ad747833 3.13.0-139-generic #188-Ubuntu SMP Tue Jan 9 14:43:09 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 3ff6977 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23563/artifact/out/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23563/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23563/testReport/ |\r\n| Max. process+thread count | 4079 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23563/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-20T19:00:01.437+0000","updated":"2018-03-20T19:00:01.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16406944","id":"16406944","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 23s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m 54s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 50s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 49s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 56s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m 41s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 40s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 54s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 50s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 50s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 41s{color} | {color:orange} hadoop-hdfs-project/hadoop-hdfs: The patch generated 42 new + 284 unchanged - 0 fixed = 326 total (was 284) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 51s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  9m 32s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 49s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 39s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}118m 24s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 20s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}165m 34s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.server.namenode.ha.TestHAStateTransitions |\r\n|   | hadoop.hdfs.tools.TestGetGroups |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockTokenWithDFS |\r\n|   | hadoop.hdfs.server.namenode.ha.TestLossyRetryInvocationHandler |\r\n|   | hadoop.hdfs.TestDFSRollback |\r\n|   | hadoop.hdfs.TestSafeMode |\r\n|   | hadoop.hdfs.TestDFSUpgradeFromImage |\r\n|   | hadoop.hdfs.TestFileAppend |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureOfSharedDir |\r\n|   | hadoop.hdfs.web.TestWebHDFS |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogAutoroll |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeMXBean |\r\n|   | hadoop.hdfs.server.namenode.TestSecureNameNode |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogsDuringFailover |\r\n|   | hadoop.hdfs.server.namenode.TestListOpenFiles |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeUUID |\r\n|   | hadoop.hdfs.tools.TestDFSHAAdminMiniCluster |\r\n|   | hadoop.hdfs.server.namenode.TestEditLog |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDelegationTokensWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestCheckpoint |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAFsck |\r\n|   | hadoop.hdfs.TestDFSMkdirs |\r\n|   | hadoop.hdfs.web.TestWebHdfsWithRestCsrfPreventionFilter |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations |\r\n|   | hadoop.hdfs.qjournal.TestNNWithQJM |\r\n|   | hadoop.hdfs.server.namenode.ha.TestRetryCacheWithHA |\r\n|   | hadoop.hdfs.TestErasureCodingPoliciesWithRandomECPolicy |\r\n|   | hadoop.hdfs.TestDFSStartupVersions |\r\n|   | hadoop.hdfs.TestFileCreation |\r\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandbyWithQJM |\r\n|   | hadoop.hdfs.TestHDFSFileSystemContract |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureReporting |\r\n|   | hadoop.hdfs.TestRollingUpgradeDowngrade |\r\n|   | hadoop.hdfs.server.balancer.TestBalancer |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithEncryptedTransfer |\r\n|   | hadoop.hdfs.tools.TestDFSZKFailoverController |\r\n|   | hadoop.hdfs.web.TestWebHDFSForHA |\r\n|   | hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits |\r\n|   | hadoop.hdfs.server.namenode.TestProtectedDirectories |\r\n|   | hadoop.hdfs.server.namenode.TestSecondaryWebUi |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRespectsBindHostKeys |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailure |\r\n|   | hadoop.hdfs.server.namenode.TestFsck |\r\n|   | hadoop.hdfs.TestFileAppendRestart |\r\n|   | hadoop.hdfs.server.namenode.TestBackupNode |\r\n|   | hadoop.hdfs.web.TestWebHdfsTokens |\r\n|   | hadoop.hdfs.tools.TestDelegationTokenFetcher |\r\n|   | hadoop.hdfs.server.namenode.TestTransferFsImage |\r\n|   | hadoop.hdfs.TestRollingUpgrade |\r\n|   | hadoop.hdfs.server.namenode.ha.TestGetGroupsWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestFSNamesystemMBean |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStreamKerberized |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyInProgressTail |\r\n|   | hadoop.hdfs.TestDatanodeConfig |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStateTransitionFailure |\r\n|   | hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStream |\r\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailureWithRandomECPolicy |\r\n|   | hadoop.hdfs.TestDistributedFileSystem |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithSaslDataTransfer |\r\n|   | hadoop.hdfs.server.namenode.TestSaveNamespace |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRecovery |\r\n|   | hadoop.hdfs.TestDFSUpgrade |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotDeletion |\r\n|   | hadoop.hdfs.tools.TestDFSAdminWithHA |\r\n|   | hadoop.hdfs.TestRollingUpgradeRollback |\r\n|   | hadoop.hdfs.security.TestDelegationToken |\r\n|   | hadoop.hdfs.server.mover.TestMover |\r\n|   | hadoop.hdfs.server.namenode.TestHostsFiles |\r\n|   | hadoop.hdfs.server.namenode.TestNNStorageRetentionFunctional |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestDiffListBySkipList |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockManager2 |\r\n|   | hadoop.hdfs.server.namenode.TestFSEditLogLoader |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerRPCDelay |\r\n|   | hadoop.hdfs.web.TestWebHdfsTimeouts |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithHANameNodes |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogJournalFailures |\r\n|   | hadoop.hdfs.qjournal.client.TestQJMWithFaults |\r\n|   | hadoop.hdfs.server.namenode.TestStorageRestore |\r\n|   | hadoop.hdfs.server.namenode.ha.TestNNHealthCheck |\r\n|   | hadoop.hdfs.TestSetTimes |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\r\n|   | hadoop.hdfs.TestFileAppend4 |\r\n|   | hadoop.hdfs.TestReadStripedFileWithMissingBlocks |\r\n|   | hadoop.hdfs.TestDFSStorageStateRecovery |\r\n|   | hadoop.hdfs.server.namenode.TestGenericJournalConf |\r\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandby |\r\n|   | hadoop.hdfs.server.namenode.TestFSImage |\r\n|   | hadoop.hdfs.qjournal.server.TestJournalNodeSync |\r\n|   | hadoop.hdfs.TestDatanodeRegistration |\r\n|   | hadoop.hdfs.server.namenode.TestStartup |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:d4cc50f |\r\n| JIRA Issue | HDFS-13295 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12915354/HDFS-13295.2.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux ec1592574ba9 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 3ff6977 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23564/artifact/out/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23564/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23564/testReport/ |\r\n| Max. process+thread count | 4248 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23564/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-20T20:10:16.077+0000","updated":"2018-03-20T20:10:16.077+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13145425/comment/16415303","id":"16415303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"body":"Hi [~bharatviswa]\r\nDid you had time to take a look to the patch and test?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nfraison.criteo","name":"nfraison.criteo","key":"nfraison.criteo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Fraison","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-27T09:20:44.093+0000","updated":"2018-03-27T09:20:44.093+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-13295/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3rcqn:"}}