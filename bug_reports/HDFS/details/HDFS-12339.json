{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13096905","self":"https://issues.apache.org/jira/rest/api/2/issue/13096905","key":"HDFS-12339","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341434","id":"12341434","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2017-08-23T04:24:00.114+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Sep 23 19:49:29 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_824999855_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_1912040324","customfield_12312321":null,"resolutiondate":"2017-09-23T19:34:09.912+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-12339/watchers","watchCount":8,"isWatching":false},"created":"2017-08-23T03:16:49.837+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327181","id":"12327181","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-09-23T19:49:29.151+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320727","id":"12320727","name":"nfs"}],"timeoriginalestimate":null,"description":"\n\nWhen stopping NFS Gateway the following error is thrown in the NFS gateway role logs.\n\n2017-08-17 18:09:16,529 ERROR org.apache.hadoop.oncrpc.RpcProgram: Unregistration failure with localhost:2049, portmap entry: (PortmapMapping-100003:3:6:2049)\n\n2017-08-17 18:09:16,531 WARN org.apache.hadoop.util.ShutdownHookManager: ShutdownHook 'NfsShutdownHook' failed, java.lang.RuntimeException: Unregistration failure\njava.lang.RuntimeException: Unregistration failure\n..\nCaused by: java.net.SocketException: Socket is closed\nat java.net.DatagramSocket.send(DatagramSocket.java:641)\nat org.apache.hadoop.oncrpc.SimpleUdpClient.run(SimpleUdpClient.java:62)\n\nChecking rpcinfo -p : the following entry is still there:\n\" 100003 3 tcp 2049 nfs\"\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341434","id":"12341434","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12884974","id":"12884974","filename":"HDFS-12339.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-09-01T16:23:23.309+0000","size":4706,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12884974/HDFS-12339.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"NFS Gateway on Shutdown Gives Unregistration Failure. Does Not Unregister with rpcbind Portmapper","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saileshpatel","name":"saileshpatel","key":"saileshpatel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sailesh Patel","active":true,"timeZone":"Australia/Melbourne"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saileshpatel","name":"saileshpatel","key":"saileshpatel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sailesh Patel","active":true,"timeZone":"Australia/Melbourne"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16137817","id":"16137817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saileshpatel","name":"saileshpatel","key":"saileshpatel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sailesh Patel","active":true,"timeZone":"Australia/Melbourne"},"body":"2017-08-22 18:40:02,817 TRACE org.apache.hadoop.oncrpc.RpcCall: Xid:-2139249408, messageType:RPC_CALL, rpcVersion:2, program:100000, version:2, procedure:2, credential:(AuthFlavor:AUTH_NONE), verifier:(AuthFlavor:AUTH_NONE)\n2017-08-22 18:40:02,818 ERROR org.apache.hadoop.oncrpc.RpcProgram: Unregistration failure with localhost:2049, portmap entry: (PortmapMapping-100003:3:6:2049)\n2017-08-22 18:40:02,820 WARN org.apache.hadoop.util.ShutdownHookManager: ShutdownHook 'NfsShutdownHook' failed, java.lang.RuntimeException: Unregistration failure\njava.lang.RuntimeException: Unregistration failure\nat org.apache.hadoop.oncrpc.RpcProgram.register(RpcProgram.java:135)\nat org.apache.hadoop.oncrpc.RpcProgram.unregister(RpcProgram.java:118)\nat org.apache.hadoop.nfs.nfs3.Nfs3Base$NfsShutdownHook.run(Nfs3Base.java:80)\nat org.apache.hadoop.util.ShutdownHookManager$1.run(ShutdownHookManager.java:54)\nCaused by: java.net.SocketException: Socket is closed\nat java.net.DatagramSocket.send(DatagramSocket.java:641)\nat org.apache.hadoop.oncrpc.SimpleUdpClient.run(SimpleUdpClient.java:62)\nat org.apache.hadoop.oncrpc.RpcProgram.register(RpcProgram.java:130)\n... 3 more\n2017-08-22 18:40:02,898 TRACE org.apache.hadoop.oncrpc.RpcCall: Xid:-690614368, messageType:RPC_CALL, rpcVersion:2, program:100000, version:2, procedure:2, credential:(AuthFlavor:AUTH_NONE), verifier:(AuthFlavor:AUTH_NONE)\n2017-08-22 18:40:02,899 ERROR org.apache.hadoop.oncrpc.RpcProgram: Unregistration failure with localhost:4242, portmap entry: (PortmapMapping-100005:1:17:4242)\n2017-08-22 18:40:02,899 WARN org.apache.hadoop.util.ShutdownHookManager: ShutdownHook 'Unregister' failed, java.lang.RuntimeException: Unregistration failure\njava.lang.RuntimeException: Unregistration failure\nat org.apache.hadoop.oncrpc.RpcProgram.register(RpcProgram.java:135)\nat org.apache.hadoop.oncrpc.RpcProgram.unregister(RpcProgram.java:118)\nat org.apache.hadoop.mount.MountdBase$Unregister.run(MountdBase.java:100)\nat org.apache.hadoop.util.ShutdownHookManager$1.run(ShutdownHookManager.java:54)\nCaused by: java.net.SocketException: Socket is closed\nat java.net.DatagramSocket.send(DatagramSocket.java:641)\nat org.apache.hadoop.oncrpc.SimpleUdpClient.run(SimpleUdpClient.java:62)\nat org.apache.hadoop.oncrpc.RpcProgram.register(RpcProgram.java:130)\n... 3 more\n2017-08-22 18:40:02,900 INFO org.apache.hadoop.nfs.nfs3.Nfs3Base: SHUTDOWN_MSG:\n \n\nFurther testing:\n----------------\n1. service rpcbind stop\n2. start rpcbind in debug mode in foreground: rpcbind -d\n3. start NFS Gateway \n4. rpcbind will show the registrations calls made similar to:\n\nPMAP_SET request for (100005, 1) : Checking caller's adress (port = 40)\nPMAP_SET request for (100005, 2) : Checking caller's adress (port = 40)\nPMAP_SET request for (100005, 3) : Checking caller's adress (port = 40)\nPMAP_SET request for (100005, 1) : Checking caller's adress (port = 40)\nPMAP_SET request for (100005, 2) : Checking caller's adress (port = 40)\nPMAP_SET request for (100005, 3) : Checking caller's adress (port = 40)\nPMAP_SET request for (100003, 3) : Checking caller's adress (port = 40)\n\nrpcinfo -p shows:\n100005 1 udp 4242 mountd\n100005 2 udp 4242 mountd\n100005 3 udp 4242 mountd\n100005 1 tcp 4242 mountd\n100005 2 tcp 4242 mountd\n100005 3 tcp 4242 mountd\n100003 3 tcp 2049 nfs\n\n5. Stop NFS Gateway \n\n    Notice the errors in NFS Gateway Role log\n    Notice no unregistration calls arrived to rpcbind\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saileshpatel","name":"saileshpatel","key":"saileshpatel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sailesh Patel","active":true,"timeZone":"Australia/Melbourne"},"created":"2017-08-23T03:18:39.751+0000","updated":"2017-08-23T03:18:39.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16137866","id":"16137866","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jzhuge","name":"jzhuge","key":"jzhuge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jzhuge&avatarId=31264","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jzhuge&avatarId=31264","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jzhuge&avatarId=31264","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jzhuge&avatarId=31264"},"displayName":"John Zhuge","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~saileshpatel] for the great report with so much detail!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jzhuge","name":"jzhuge","key":"jzhuge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jzhuge&avatarId=31264","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jzhuge&avatarId=31264","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jzhuge&avatarId=31264","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jzhuge&avatarId=31264"},"displayName":"John Zhuge","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-08-23T04:24:00.114+0000","updated":"2017-08-23T04:24:00.114+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16147443","id":"16147443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Tagar","name":"Tagar","key":"tagar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Ruslan Dautkhanov","active":true,"timeZone":"America/Denver"},"body":"We think this might be the root cause for nfs clients hanging issue we see sometimes when gdfs nfs gateway stops.\nTimeouts don't work as an nfs client can see rpc service for nfs is up, but  there is no actual live service behind that rpc service.. \nkinda zombie rpc service if it makes sense to you. Although we are not entirely certain if that's the root cause. \nWould be great to have this fixed anyway.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Tagar","name":"Tagar","key":"tagar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Ruslan Dautkhanov","active":true,"timeZone":"America/Denver"},"created":"2017-08-30T15:31:47.132+0000","updated":"2017-08-30T15:31:47.132+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16150790","id":"16150790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Please find the attached patch which fixes this issue.\n\nI have tested this my starting a nfs server using ambari. Without this patch I was able to reproduce the issue.\n\nAlso after the patch, the nfs and mountd daemon are un-regisered.\n\n{code}\n[vagrant@c6803 ~]$ rpcinfo -p\n   program vers proto   port  service\n    100000    4   tcp    111  portmapper\n    100000    3   tcp    111  portmapper\n    100000    2   tcp    111  portmapper\n    100000    4   udp    111  portmapper\n    100000    3   udp    111  portmapper\n    100000    2   udp    111  portmapper\n    100024    1   udp  48682  status\n    100024    1   tcp  60059  status\n{code}\n\nFollowing is the snippet of the nfs3 logs after the fix.\n{code}\n2017-09-01 16:06:39,902 INFO  http.HttpServer2 (HttpServer2.java:bindListener(989)) - Jetty bound to port 50079                                                                                         \n2017-09-01 16:06:39,907 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26.hwx                                                                                                                   \n2017-09-01 16:06:41,397 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@0.0.0.0:50079                                                            \n2017-09-01 16:06:41,413 INFO  oncrpc.SimpleTcpServer (SimpleTcpServer.java:run(92)) - Started listening to TCP requests at port 2049 for Rpc program: NFS3 at localhost:2049 with workerCount 0         \n2017-09-01 16:12:08,534 INFO  nfs3.AsyncDataService (AsyncDataService.java:shutdown(85)) - Shutting down all async data service threads...                                                              \n2017-09-01 16:12:08,535 INFO  nfs3.AsyncDataService (AsyncDataService.java:shutdown(90)) - All async data service threads have been shut down                                                           \n2017-09-01 16:12:08,535 INFO  nfs3.OpenFileCtxCache (OpenFileCtxCache.java:run(265)) - StreamMonitor got interrupted                                                                                    \n2017-09-01 16:12:08,549 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@0.0.0.0:50079                                                            \n2017-09-01 16:12:08,550 WARN  http.HttpServer2 (HttpServer2.java:isRunning(544)) - HttpServer Acceptor: isRunning is false. Rechecking.                                                                 \n2017-09-01 16:12:08,552 WARN  http.HttpServer2 (HttpServer2.java:isRunning(553)) - HttpServer Acceptor: isRunning is false                                                                              \n2017-09-01 16:12:08,700 INFO  nfs3.Nfs3Base (LogAdapter.java:info(45)) - SHUTDOWN_MSG:              \n/************************************************************                                       \nSHUTDOWN_MSG: Shutting down Nfs3 at c6803.ambari.apache.org/192.168.68.103                          \n************************************************************/ \n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-09-01T16:26:43.481+0000","updated":"2017-09-01T16:26:43.481+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16150826","id":"16150826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"The issue in the current code is that for {{PrivilegedNfsGatewayStarter}}, the registration socket is closed as part of destroy.\n\n{code}\n  @Override\n  public void destroy() {\n    if (registrationSocket != null && !registrationSocket.isClosed()) {\n      registrationSocket.close();\n    }\n  }\n{code}\n\nWhere as the shutdown hook later uses this closed port to unregister the services. Hence causing the error in the logs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-09-01T16:55:40.210+0000","updated":"2017-09-01T16:55:40.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16150881","id":"16150881","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 14s{color} | {color:blue} Docker mode activated. {color} |\n|| || || || {color:brown} Prechecks {color} ||\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n|| || || || {color:brown} trunk Compile Tests {color} ||\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 45s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m  5s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 20m  9s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  2m  0s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 49s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  2s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\n|| || || || {color:brown} Patch Compile Tests {color} ||\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 14s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 29s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 11m  1s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 11m  1s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  2m  0s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 49s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 17s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 40s{color} | {color:green} the patch passed {color} |\n|| || || || {color:brown} Other Tests {color} ||\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 30s{color} | {color:green} hadoop-nfs in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  2m  5s{color} | {color:green} hadoop-hdfs-nfs in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 30s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 62m  5s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:71bbb86 |\n| JIRA Issue | HDFS-12339 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12884974/HDFS-12339.001.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 187cc9b46844 3.13.0-123-generic #172-Ubuntu SMP Mon Jun 26 18:04:35 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 99a7f5d |\n| Default Java | 1.8.0_144 |\n| findbugs | v3.1.0-RC1 |\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/20969/testReport/ |\n| modules | C: hadoop-common-project/hadoop-nfs hadoop-hdfs-project/hadoop-hdfs-nfs U: . |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/20969/console |\n| Powered by | Apache Yetus 0.6.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-01T17:33:03.144+0000","updated":"2017-09-01T17:33:03.144+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16173668","id":"16173668","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajayydv","name":"ajayydv","key":"ajayydv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Kumar","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the patch [~msingh]. For {{RpcProgramNfs3#stopDaemons}}, maybe we can change the log level for failure to error.  LGTM otherwise.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajayydv","name":"ajayydv","key":"ajayydv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Kumar","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-09-20T18:52:53.442+0000","updated":"2017-09-20T18:52:53.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16174478","id":"16174478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the review [~ajayydv], I feel that current logging in in {{RpcProgramNfs3#stopDaemons}} is sufficient as we are shutting down anyways. Please let me know of your opinion on this.\n\n{code}\n      try {\n        infoServer.stop();\n      } catch (Exception e) {\n        LOG.warn(\"Exception shutting down web server\", e);\n      }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-09-21T09:08:42.868+0000","updated":"2017-09-21T09:08:42.868+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16177951","id":"16177951","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anu","name":"anu","key":"anu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anu Engineer","active":true,"timeZone":"America/Los_Angeles"},"body":"+1, I will commit this shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anu","name":"anu","key":"anu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anu Engineer","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-09-23T19:24:52.178+0000","updated":"2017-09-23T19:24:52.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16177954","id":"16177954","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anu","name":"anu","key":"anu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anu Engineer","active":true,"timeZone":"America/Los_Angeles"},"body":"[~shailesh001], [~jzhuge], [~Tagar], [~ajayydv] Thanks for review comment. \n[~msingh] Thanks for the contribution. I have committed this to 3.1.0.\n\nif you would like this to be backported to 3.0, Please reopen this JIRA. I think we should have this in 3.0, but we are so close to beta1 I don't want to commit something unless it absolutely essential for beta1. I look forward to hearing all your thoughts on whether we should have this committed to beta1 branch before release.\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anu","name":"anu","key":"anu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anu Engineer","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-09-23T19:34:09.970+0000","updated":"2017-09-23T19:34:09.970+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13096905/comment/16177959","id":"16177959","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #12961 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/12961/])\n HDFS-12339. NFS Gateway on Shutdown Gives Unregistration Failure. Does (aengineer: rev ecc85620e83dc051502c3b85df11d2f50b0cd616)\n* (edit) hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3.java\n* (edit) hadoop-common-project/hadoop-nfs/src/main/java/org/apache/hadoop/mount/MountdBase.java\n* (edit) hadoop-common-project/hadoop-nfs/src/main/java/org/apache/hadoop/nfs/nfs3/Nfs3Base.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/PrivilegedNfsGatewayStarter.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-23T19:49:29.151+0000","updated":"2017-09-23T19:49:29.151+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-12339/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3j65r:"}}