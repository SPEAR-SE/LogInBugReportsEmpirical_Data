{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12862573","self":"https://issues.apache.org/jira/rest/api/2/issue/12862573","key":"HDFS-9038","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329057","id":"12329057","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12334863","id":"12334863","description":"2.7.4 release","name":"2.7.4","archived":false,"released":true,"releaseDate":"2017-08-04"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12337976","id":"12337976","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-09-09T06:14:44.654+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 10 09:38:30 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_4886170938_*|*_4_*:*_1_*:*_18008_*|*_5_*:*_2_*:*_50029375_*|*_10002_*:*_2_*:*_26681503713","customfield_12312321":null,"resolutiondate":"2016-09-08T21:10:54.182+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-9038/watchers","watchCount":21,"isWatching":false},"created":"2015-09-08T22:28:52.440+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"13.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12331979","id":"12331979","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[{"id":"12457728","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12457728","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12818786","key":"HDFS-8072","self":"https://issues.apache.org/jira/rest/api/2/issue/12818786","fields":{"summary":"Reserved RBW space is not released if client terminates while writing block","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12490799","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12490799","type":{"id":"12310050","name":"Regression","inward":"is broken by","outward":"breaks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310050"},"outwardIssue":{"id":"13033549","key":"HDFS-11312","self":"https://issues.apache.org/jira/rest/api/2/issue/13033549","fields":{"summary":"Fix incompatible tag number change for nonDfsUsed in DatanodeInfoProto","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12436837","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12436837","type":{"id":"12310050","name":"Regression","inward":"is broken by","outward":"breaks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310050"},"inwardIssue":{"id":"12668930","key":"HDFS-5215","self":"https://issues.apache.org/jira/rest/api/2/issue/12668930","fields":{"summary":"dfs.datanode.du.reserved is not considered while computing available space","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-05-10T09:38:30.307+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312927","id":"12312927","name":"datanode"}],"timeoriginalestimate":null,"description":"HDFS-5215 changed the DataNode volume available space calculation to consider the reserved space held by the {{dfs.datanode.du.reserved}} configuration property.  As a side effect, reserved space is now counted towards non-DFS used.  I don't believe it was intentional to change the definition of non-DFS used.  This issue proposes restoring the prior behavior: do not count reserved space towards non-DFS used.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12777828","id":"12777828","filename":"GetFree.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T21:25:43.656+0000","size":421,"mimeType":"text/x-java-source","content":"https://issues.apache.org/jira/secure/attachment/12777828/GetFree.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12770574","id":"12770574","filename":"HDFS-9038.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-04T11:44:23.606+0000","size":25151,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12770574/HDFS-9038.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12770754","id":"12770754","filename":"HDFS-9038-002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-05T06:37:19.342+0000","size":25601,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12770754/HDFS-9038-002.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12773455","id":"12773455","filename":"HDFS-9038-003.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-20T06:31:52.169+0000","size":25612,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12773455/HDFS-9038-003.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12773567","id":"12773567","filename":"HDFS-9038-004.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-20T19:03:20.822+0000","size":26737,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12773567/HDFS-9038-004.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12774823","id":"12774823","filename":"HDFS-9038-005.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-30T13:43:58.634+0000","size":29580,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12774823/HDFS-9038-005.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12776866","id":"12776866","filename":"HDFS-9038-006.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-10T19:04:33.624+0000","size":29621,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12776866/HDFS-9038-006.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12777066","id":"12777066","filename":"HDFS-9038-007.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-11T16:22:58.617+0000","size":30237,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12777066/HDFS-9038-007.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12822051","id":"12822051","filename":"HDFS-9038-008.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-04T12:34:03.819+0000","size":30665,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12822051/HDFS-9038-008.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12822418","id":"12822418","filename":"HDFS-9038-009.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-06T04:38:10.400+0000","size":31537,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12822418/HDFS-9038-009.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12825464","id":"12825464","filename":"HDFS-9038-010.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-25T12:51:12.430+0000","size":32206,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12825464/HDFS-9038-010.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12827080","id":"12827080","filename":"HDFS-9038-011.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-05T14:29:01.531+0000","size":32703,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12827080/HDFS-9038-011.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12827350","id":"12827350","filename":"HDFS-9038-branch-2.7.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-07T10:44:27.866+0000","size":32272,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12827350/HDFS-9038-branch-2.7.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"DFS reserved space is erroneously counted towards non-DFS used.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14735746","id":"14735746","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"I'd appreciate if some of the participants on HDFS-5215 could chime in with their opinions.  cc [~brahmareddy], [~umamaheswararao], [~yzhangal] and [~kihwal].  Thank you.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-08T22:30:50.019+0000","updated":"2015-09-08T22:30:50.019+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14736267","id":"14736267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"2 ways we can solve this, \n1) passing non-dfsused as a metric directly from DN side itself, similar to other stats, i.e. Moving the calculation to DN side\n2) passing 'reserved' values and using that to calculate non-dfs usage at NN side.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-09-09T06:14:44.654+0000","updated":"2015-09-09T06:14:44.654+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14736278","id":"14736278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Reserved is not updated in the DatanodeDescriptor so need to propogate back to NN side via heartbeat if we want to update that..So We can solve it by anyone of above apporach..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-09-09T06:21:48.674+0000","updated":"2015-09-09T06:21:48.674+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14741329","id":"14741329","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks brahma for the options.\n#1 would be better IMO.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-09-11T18:39:01.645+0000","updated":"2015-09-11T18:39:01.645+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14988555","id":"14988555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Moving out all non-critical / non-blocker issues that didn't make it out of 2.7.2 into 2.7.3.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-04T00:20:26.584+0000","updated":"2015-11-04T00:20:26.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14989411","id":"14989411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploading the patch to makes nonDFSUsed accurate by considering reservedForReplicas also.Actually bug is not there as mentioned in description,Since reserved was already subtracted from total capacity, nonDfsUsed was not including the reserved.\n\nBut getAvailable() value was calculated directly from DF, but there reserved was not considered, which was fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-04T11:44:23.609+0000","updated":"2015-11-04T11:44:23.609+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14989659","id":"14989659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 9s {color} | {color:blue} docker + precommit patch detected. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 6 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 4m 12s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 20s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 19s {color} | {color:green} trunk passed with JDK v1.7.0_79 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 24s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 35s {color} | {color:green} trunk passed {color} |\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red} 2m 14s {color} | {color:red} hadoop-hdfs-project/hadoop-hdfs in trunk cannot run convertXmlToText from findbugs {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 52s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 35s {color} | {color:green} trunk passed with JDK v1.7.0_79 {color} |\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red} 0m 29s {color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 14s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 14s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 14s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 9s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 9s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 9s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 23s {color} | {color:red} Patch generated 17 new checkstyle issues in hadoop-hdfs-project (total was 293, now 308). {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 31s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 4m 40s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 45s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 38s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 71m 52s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 54s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 67m 5s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_79. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 59s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_79. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 19s {color} | {color:red} Patch generated 56 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 174m 47s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.shortcircuit.TestShortCircuitCache |\n|   | hadoop.hdfs.TestRollingUpgrade |\n|   | hadoop.hdfs.TestAclsEndToEnd |\n| JDK v1.7.0_79 Failed junit tests | hadoop.hdfs.TestHDFSFileSystemContract |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker | Client=1.7.0 Server=1.7.0 Image:test-patch-base-hadoop-date2015-11-04 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12770574/HDFS-9038.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  javac  javadoc  mvninstall  unit  findbugs  checkstyle  compile  cc  |\n| uname | Linux b8b2da95b5cb 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HDFS-Build@2/patchprocess/apache-yetus-d0f6847/precommit/personality/hadoop.sh |\n| git revision | trunk / 73b9c7b |\n| Default Java | 1.7.0_79 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_79 |\n| findbugs | v3.0.0 |\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/branch-findbugs-hadoop-hdfs-project_hadoop-hdfs.html |\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_79.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_79.txt |\n| JDK v1.7.0_79  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 225MB |\n| Powered by | Apache Yetus   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13381/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-04T15:05:18.505+0000","updated":"2015-11-04T15:05:18.505+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14991236","id":"14991236","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploaded the patch fix the checkstyle issues.. Testcase failures are unrelated..Compilation errors are strange..? [~cnauroth]/[~vinayrpet] kindly review..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-05T06:40:02.561+0000","updated":"2015-11-05T06:40:02.561+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14991411","id":"14991411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 16s {color} | {color:blue} docker + precommit patch detected. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 6 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 4m 21s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 20s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 14s {color} | {color:green} trunk passed with JDK v1.7.0_79 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 27s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 35s {color} | {color:green} trunk passed {color} |\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red} 2m 24s {color} | {color:red} hadoop-hdfs-project/hadoop-hdfs in trunk cannot run convertXmlToText from findbugs {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 58s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 56s {color} | {color:green} trunk passed with JDK v1.7.0_79 {color} |\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red} 0m 33s {color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 37s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 37s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 37s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 20s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 20s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 20s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 25s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 293, now 295). {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 31s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 5m 4s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 2s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 58s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 75m 10s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 56s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 69m 30s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_79. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 1s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_79. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 21s {color} | {color:red} Patch generated 56 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 183m 44s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.server.namenode.ha.TestSeveralNameNodes |\n| JDK v1.7.0_79 Failed junit tests | hadoop.hdfs.TestBlockStoragePolicy |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker | Client=1.7.0 Server=1.7.0 Image:test-patch-base-hadoop-date2015-11-05 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12770754/HDFS-9038-002.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  javac  javadoc  mvninstall  unit  findbugs  checkstyle  compile  cc  |\n| uname | Linux 2224019fc6e8 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HDFS-Build/patchprocess/apache-yetus-e8bd3ad/precommit/personality/hadoop.sh |\n| git revision | trunk / 5667129 |\n| Default Java | 1.7.0_79 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_79 |\n| findbugs | v3.0.0 |\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/branch-findbugs-hadoop-hdfs-project_hadoop-hdfs.html |\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_79.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_79.txt |\n| JDK v1.7.0_79  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 226MB |\n| Powered by | Apache Yetus   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13397/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-05T09:42:34.357+0000","updated":"2015-11-05T09:42:34.357+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14991545","id":"14991545","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"{quote}-1\tmvninstall\t0m 33s\thadoop-hdfs in the patch failed.{quote}.\n\nCompile done on parent but mvn install done only on hadoop-hdfs.[~aw] can you please take look on this..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-05T11:13:11.164+0000","updated":"2015-11-05T11:13:11.164+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14991924","id":"14991924","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"Yup. Working as intended.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2015-11-05T16:29:19.036+0000","updated":"2015-11-05T16:29:19.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14992026","id":"14992026","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. Yup. Working as intended.\nIMO, since the patch contains multi-module changes (hadoop-hdfs-client and hadoop-hdfs),\neither \"mvn install\" should be done on parent directory, same as \"mvn test-compile\",\nor, should be executed in dependency order (hadoop-hdfs-client and hadoop-hdfs).\n\nRight?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-05T17:16:31.665+0000","updated":"2015-11-05T17:16:31.665+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14992041","id":"14992041","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"same case happened with HDFS-9057","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-05T17:20:20.350+0000","updated":"2015-11-05T17:20:20.350+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14992056","id":"14992056","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"bq. should be executed in dependency order (hadoop-hdfs-client and hadoop-hdfs).\n\nIt's being done in the dependency order as dictated by the Yetus hadoop personality.  If you feel the ordering is wrong, patches accepted.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2015-11-05T17:32:30.340+0000","updated":"2015-11-05T17:32:30.340+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/14999772","id":"14999772","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"YETUS-170 raised to handle mvn install issue..can somebody review patch now..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-11T01:40:52.345+0000","updated":"2015-11-11T01:40:52.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15000017","id":"15000017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"[~brahmareddy], thank you for working on this.  My earliest opportunity to code review this will be next Tuesday, 11/17.  Of course, if someone else in the community would like to take up the review, that's great too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-11T06:47:33.690+0000","updated":"2015-11-11T06:47:33.690+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15014806","id":"15014806","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"[~brahmareddy], thank you for the patch.  This looks pretty good to me, though I'd also appreciate a second code review, maybe from [~vinayrpet] or [~arpitagarwal].\n\nI just have one point of feedback right now.  In {{DatanodeStorageInfo#toStorageReport}}, should the call to the {{StorageReport}} constructor pass along {{nonDfsUsed}} instead of hard-coding {{0L}}?\n\nAfter that's addressed, I'll put this through some manual testing too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-20T00:03:36.549+0000","updated":"2015-11-20T00:03:36.549+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15015256","id":"15015256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. In DatanodeStorageInfo#toStorageReport, should the call to the StorageReport constructor pass along nonDfsUsed instead of hard-coding 0L?\nThat was a good catch. [~cnauroth]. \nApart from that everything else looks good to me as well. +1 once addressed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-20T05:41:11.241+0000","updated":"2015-11-20T05:41:11.241+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15015308","id":"15015308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~cnauroth] and [~vinayrpet] thanks a for your reviews..uploaded the patch to address above comment.Kindly review..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-20T06:34:20.030+0000","updated":"2015-11-20T06:34:20.030+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15015526","id":"15015526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 10s {color} | {color:blue} docker + precommit patch detected. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 6 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 8m 45s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 12s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 49s {color} | {color:green} trunk passed with JDK v1.7.0_79 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 24s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 43s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 31s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 4m 27s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 48s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 37s {color} | {color:green} trunk passed with JDK v1.7.0_79 {color} |\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red} 0m 32s {color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 8s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 2m 8s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 9m 52s {color} | {color:red} hadoop-hdfs-project-jdk1.8.0_66 with JDK v1.8.0_66 generated 3 new issues (was 49, now 49). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 2m 8s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 49s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 49s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 11m 41s {color} | {color:red} hadoop-hdfs-project-jdk1.7.0_79 with JDK v1.7.0_79 generated 3 new issues (was 51, now 51). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 49s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 25s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 293, now 295). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 42s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 30s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch has 1 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 4m 53s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 50s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 44s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 76m 2s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 10s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 78m 14s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_79. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 8s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_79. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 24s {color} | {color:red} Patch generated 56 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 201m 59s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.TestDFSPermission |\n|   | hadoop.hdfs.server.datanode.TestBlockScanner |\n|   | hadoop.hdfs.TestReadStripedFileWithMissingBlocks |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.server.namenode.TestNameNodeRespectsBindHostKeys |\n| JDK v1.7.0_79 Failed junit tests | hadoop.hdfs.server.blockmanagement.TestPendingInvalidateBlock |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure010 |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure130 |\n|   | hadoop.hdfs.qjournal.client.TestQuorumJournalManager |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:date2015-11-20 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12773455/HDFS-9038-003.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 2ccc37d6f170 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HDFS-Build/patchprocess/apache-yetus-3f4279a/precommit/personality/hadoop.sh |\n| git revision | trunk / 4539131 |\n| findbugs | v3.0.0 |\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\n| javac | hadoop-hdfs-project-jdk1.8.0_66: https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.8.0_66.txt |\n| javac | hadoop-hdfs-project-jdk1.7.0_79: https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.7.0_79.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/whitespace-eol.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_79.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_79.txt |\n| JDK v1.7.0_79  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 78MB |\n| Powered by | Apache Yetus   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13575/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-20T10:00:46.320+0000","updated":"2015-11-20T10:00:46.320+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15015584","id":"15015584","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Please check the failure of {{hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics}}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-20T10:48:38.806+0000","updated":"2015-11-20T10:48:38.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15018549","id":"15018549","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"This is not failing locally.But there is chance that this testcase can fail intermittently after this change(There is a chance that nonDFS usage might have slightly due to testlogs,).So I am keeping safeside as I did {{TestNamenodeCapacityReport.java}} \n\n *Check following results for same* \n\n||Testenv||dfsused||dfsremaining||nondfsused||TotalCapacity||difference||\n|Eclipse| 888|570023337984|74221730952|644245069824|0|\n|jenkins Run| 147456|20430970142720|2887306715136|23318276997120|8192|","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-20T19:05:32.940+0000","updated":"2015-11-20T19:05:32.940+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15018761","id":"15018761","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~brahmareddy], thanks for taking this up. The approach looks good.\n\n# The calculation in FsVolumeImpl#getNonDfsUsed looks wrong. Won't it always be zero? The correct calculation should replace getAvailable() with actual volume free space. Something like {{Files.getFileStore(currentDir.toPath()).getUnallocatedSpace()}} perhaps. Also I think reservedForReplicas need not be subtracted in the nonDFSUsed calculation, since it is purely a bytes on disk calculation.\n{code}\n  public long getAvailable() throws IOException {\n    long remaining = getCapacity() - getDfsUsed() - reservedForReplicas.get();\n...\n  public long getNonDfsUsed() throws IOException {\n    long nonDFSUsed = getCapacity() - getDfsUsed() - getAvailable()\n        - reservedForReplicas.get();\n{code}\n# Can you add a targeted unit test for the above calculation? A mock-based test would be ideal.\n# If the DN does not report nonDfsUsed, the NN should initialize it using the older calculation. Else the NN will report nonDfsUsed as zero for older DNs e.g. during upgrade. The fix can be done in {{PBHelperClient#convert(DatanodeInfoProto)}}.\n# We can expose nonDfsUsed via StorageTypeStats and DatanodeStatistics. Okay to do in a separate Jira.\n# Also we can expose reservedForReplicas in a separate Jira. Previously this space was accounted for in nonDfsUsed but now it will not be accounted for anywhere.\n# Unrelated - we should replace {{DatanodeInfo}} constructors with a builder pattern in a separate Jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-20T20:51:56.962+0000","updated":"2015-11-20T20:55:20.129+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15018962","id":"15018962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 8s {color} | {color:blue} docker + precommit patch detected. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 7 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 10m 28s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 34s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 10s {color} | {color:green} trunk passed with JDK v1.7.0_85 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 30s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 2m 2s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 35s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 5m 4s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 9s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 4s {color} | {color:green} trunk passed with JDK v1.7.0_85 {color} |\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red} 0m 37s {color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 27s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 2m 27s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 11m 28s {color} | {color:red} hadoop-hdfs-project-jdk1.8.0_66 with JDK v1.8.0_66 generated 3 new issues (was 49, now 49). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 2m 27s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 0s {color} | {color:green} the patch passed with JDK v1.7.0_85 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 2m 0s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 13m 28s {color} | {color:red} hadoop-hdfs-project-jdk1.7.0_85 with JDK v1.7.0_85 generated 3 new issues (was 51, now 51). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 2m 0s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 28s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 292, now 294). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 55s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 31s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 5m 28s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 9s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 4s {color} | {color:green} the patch passed with JDK v1.7.0_85 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 83m 24s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 30s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 76m 46s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_85. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 22s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_85. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 25s {color} | {color:red} Patch generated 57 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 215m 14s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.TestSafeModeWithStripedFile |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.hdfs.qjournal.client.TestQJMWithFaults |\n|   | hadoop.hdfs.qjournal.TestSecureNNWithQJM |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure |\n|   | hadoop.hdfs.server.namenode.TestFSImageWithSnapshot |\n|   | hadoop.hdfs.TestRecoverStripedFile |\n| JDK v1.7.0_85 Failed junit tests | hadoop.hdfs.server.datanode.TestFsDatasetCache |\n|   | hadoop.hdfs.server.namenode.TestNameNodeMetadataConsistency |\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure200 |\n|   | hadoop.hdfs.server.namenode.TestBackupNode |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:date2015-11-20 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12773567/HDFS-9038-004.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 060164f9f2ad 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HDFS-Build/patchprocess/apache-yetus-3f4279a/precommit/personality/hadoop.sh |\n| git revision | trunk / 4539131 |\n| findbugs | v3.0.0 |\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\n| javac | hadoop-hdfs-project-jdk1.8.0_66: https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.8.0_66.txt |\n| javac | hadoop-hdfs-project-jdk1.7.0_85: https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.7.0_85.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_85.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_85.txt |\n| JDK v1.7.0_85  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 79MB |\n| Powered by | Apache Yetus   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13581/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-20T22:44:09.077+0000","updated":"2015-11-20T22:44:09.077+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15020866","id":"15020866","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. The calculation in FsVolumeImpl#getNonDfsUsed looks wrong. Won't it always be zero? \nDo you mean, nonDfsUsed will be zero? from the logs and tests, nonDFSUsage, is giving not zero.\nFrom the earlier table, Brahma posted, Jenkins machine had 2887306715136 bytes of non-dfs usage out of 23318276997120 capacity, which seems reasonable.\n\nbq. The correct calculation should replace getAvailable() with actual volume free space. Something like Files.getFileStore(currentDir.toPath()).getUnallocatedSpace() perhaps.\nIMO, This is also good point. Though earlier calculation was not entirely wrong, which basically calculates the nonDfsUsed by subtracting available space and dfsUsed from capacity. Available space is based on {{File.getUsableSpace()}} api, which according to javadoc, usable by this JVM not of entire partition.\nEven though, I dont have any objection to use, {{Files.getFileStore(currentDir.toPath()).getUnallocatedSpace()}}, how about using {{currentDir.getFreeSpace()}}? Do you find any difference between them?\n  Updated calculation might look like this\n  {code}public long getNonDfsUsed() throws IOException {\n    long totalFreeSpace = currentDir.getFreeSpace();\n    return getCapacity() - getDfsUsed() - totalFreeSpace;\n  }{code}\n Is this looks okay [~arpitagarwal] ?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-22T06:44:29.833+0000","updated":"2015-11-22T06:44:29.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15021113","id":"15021113","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~vinayrpet], yes looks like it will be zero unless the {{remaining > available}} check is triggered in {{#getAvailable}}. \n\nbq. Even though, I dont have any objection to use, Files.getFileStore(currentDir.toPath()).getUnallocatedSpace(), how about using currentDir.getFreeSpace()? Do you find any difference between them?\nThat makes sense. Your code snippet LGTM.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-22T18:23:53.653+0000","updated":"2015-11-22T18:23:53.653+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15026008","id":"15026008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks you guys.. soon will update the patch based your comments..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-25T02:12:34.660+0000","updated":"2015-11-25T02:12:34.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15031784","id":"15031784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploaded the patch..Kindly review..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-30T13:43:58.639+0000","updated":"2015-11-30T13:43:58.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15032110","id":"15032110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Raised separate jira's for above three improvements (HDFS-9480,HDFS-9481 and HDFS-9482).And uploaded the patch to address [~vinayrpet] and [~arpitagarwal] comments,kindly review..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-11-30T17:17:03.345+0000","updated":"2015-11-30T17:17:03.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15032253","id":"15032253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 8 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 14m 23s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 20s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 33s {color} | {color:green} trunk passed with JDK v1.7.0_85 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 35s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 2m 18s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 38s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 6m 0s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 53s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 53s {color} | {color:green} trunk passed with JDK v1.7.0_85 {color} |\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red} 0m 44s {color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 48s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 3m 48s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 15m 16s {color} | {color:red} hadoop-hdfs-project-jdk1.8.0_66 with JDK v1.8.0_66 generated 3 new issues (was 49, now 49). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 3m 48s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 36s {color} | {color:green} the patch passed with JDK v1.7.0_85 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 2m 37s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 17m 54s {color} | {color:red} hadoop-hdfs-project-jdk1.7.0_85 with JDK v1.7.0_85 generated 3 new issues (was 51, now 51). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 2m 36s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 35s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 293, now 295). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 2m 48s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 49s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch has 1 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 7m 38s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 12s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 49s {color} | {color:green} the patch passed with JDK v1.7.0_85 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 115m 25s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 48s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 121m 39s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_85. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 43s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_85. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 32s {color} | {color:red} Patch generated 57 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 311m 11s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.TestBlockStoragePolicy |\n|   | hadoop.tracing.TestTracing |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.shortcircuit.TestShortCircuitCache |\n|   | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\n|   | hadoop.hdfs.TestCrcCorruption |\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailure |\n|   | hadoop.hdfs.server.balancer.TestBalancer |\n|   | hadoop.hdfs.TestSafeModeWithStripedFile |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.hdfs.server.namenode.ha.TestSeveralNameNodes |\n|   | hadoop.fs.TestSymlinkHdfsFileContext |\n|   | hadoop.hdfs.qjournal.TestSecureNNWithQJM |\n|   | hadoop.hdfs.server.namenode.TestNamenodeCapacityReport |\n|   | hadoop.hdfs.TestEncryptionZones |\n|   | hadoop.hdfs.server.namenode.ha.TestRequestHedgingProxyProvider |\n|   | hadoop.hdfs.server.datanode.TestDirectoryScanner |\n| JDK v1.7.0_85 Failed junit tests | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure |\n|   | hadoop.hdfs.TestDFSStripedInputStream |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure060 |\n|   | hadoop.hdfs.TestPersistBlocks |\n|   | hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations |\n|   | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailure |\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshot |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure080 |\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n|   | hadoop.hdfs.qjournal.TestSecureNNWithQJM |\n|   | hadoop.hdfs.server.namenode.TestNamenodeCapacityReport |\n|   | hadoop.hdfs.server.blockmanagement.TestPendingReplication |\n|   | hadoop.hdfs.server.namenode.ha.TestRequestHedgingProxyProvider |\n|   | hadoop.hdfs.server.datanode.TestDirectoryScanner |\n| JDK v1.7.0_85 Timed out junit tests | org.apache.hadoop.hdfs.server.namenode.ha.TestLossyRetryInvocationHandler |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12774823/HDFS-9038-005.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 51296cf527bc 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / c37c3f4 |\n| findbugs | v3.0.0 |\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\n| javac | hadoop-hdfs-project-jdk1.8.0_66: https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.8.0_66.txt |\n| javac | hadoop-hdfs-project-jdk1.7.0_85: https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.7.0_85.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/whitespace-eol.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_85.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_85.txt |\n| JDK v1.7.0_85  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 76MB |\n| Powered by | Apache Yetus   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13685/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-30T19:00:20.553+0000","updated":"2015-11-30T19:00:20.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15032865","id":"15032865","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the further reviews.  I'm catching up on patch v005 now.\n\n# The latest {{getNonDfsUsed}} switched to using {{File#getFreeSpace}}.  However, the {{getAvailable}} calculation uses {{File#getUsableSpace}} via {{DF#getAvailable}}.  The non-DFS used calculation prior to the HDFS-5215 patch also would have been using {{File#getUsableSpace}}.  I think we should stick with {{File#getUsableSpace}} here (or {{DF#getAvailable}} for symmetry with the pre-HDFS-5215 code).\n# The latest {{getNonDfsUsed}} does not include {{reservedForReplicas}}.  I think it should, since the {{reservedForReplicas}} amount is effectively in use by HDFS.\n# I think we should cap the returned value to 0 as a matter of defensive coding against negative values.  There could be a possibility of race conditions in between pulling the individual data items, resulting in an unexpected negative total.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-01T01:36:12.682+0000","updated":"2015-12-01T01:36:12.682+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15033527","id":"15033527","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. The latest getNonDfsUsed switched to using File#getFreeSpace. However, the getAvailable calculation uses File#getUsableSpace via DF#getAvailable. The non-DFS used calculation prior to the HDFS-5215 patch also would have been using File#getUsableSpace. I think we should stick with File#getUsableSpace here (or DF#getAvailable for symmetry with the pre-HDFS-5215 code).\nI agree that, to be in symmetry with pre HDFS-5215 code, we can use {{File#getUsableSpace}}, But since we are trying to calculate entire non-dfs usage of the partition/disk, {{File#getFreeSpace}} is required. Both might result in same values, unless some quota set for the user.\n\nHi [~arpitagarwal], what you think?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-01T11:13:50.365+0000","updated":"2015-12-01T11:13:50.365+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15034818","id":"15034818","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the updated patch [~brahmareddy].\n\nbq. 3. I think we should cap the returned value to 0 as a matter of defensive coding against negative values. \nHi [~cnauroth], this is a good idea.\n\nbq. 2. The latest getNonDfsUsed does not include reservedForReplicas. I think it should, since the reservedForReplicas amount is effectively in use by HDFS.\nBrahma changed this at my suggestion. Exposing reserved bytes through nonDfsUsed was inadvertent side effect of HDFS-6898. I see Brahma filed HDFS-9481 to expose reserved bytes as a separate counter which should present a clearer picture to administrators. What do you think?\n\nbq. I think we should stick with File#getUsableSpace here\nI looked at the JDK code to find the difference between {{File#getUsableSpace}} and {{File#getFreeSpace}}.\nhttp://hg.openjdk.java.net/jdk7/jdk7/jdk/file/9b8c96f96a0f/src/solaris/native/java/io/UnixFileSystem_md.c#l412\n\nSo it comes down to the difference between {{f_bavail}} and {{f_bfree}}.\n\n{code}\n           struct statvfs {\n               unsigned long  f_bsize;    /* filesystem block size */\n               unsigned long  f_frsize;   /* fragment size */\n               fsblkcnt_t     f_blocks;   /* size of fs in f_frsize units */\n               fsblkcnt_t     f_bfree;    /* # free blocks */\n               fsblkcnt_t     f_bavail;   /* # free blocks for unprivileged users */\n{code}\n{{f_bavail}} does not include some system-reserved partition space. The consequence of using {{f_bavail}} is that non-DFS used will include this space which is 5% of the volume size on ext2fs and successors, because {{File#getTotalSpace}} counts everything.\nhttp://www.microhowto.info/howto/reduce_the_space_reserved_for_root_on_an_ext2_ext3_or_ext4_filesystem.html\n\nThis may be confusing to administrators.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-01T23:12:17.272+0000","updated":"2015-12-01T23:12:17.272+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15035067","id":"15035067","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. Brahma changed this at my suggestion. Exposing reserved bytes through nonDfsUsed was inadvertent side effect of HDFS-6898.\n\nSorry, I missed that earlier comment.  I understand the rationale now, so I'll withdraw my comment about changing it.\n\nRegarding {{File#getUsableSpace}} vs. {{File#getFreeSpace}}, I've been approaching this as a regression introduced by HDFS-5215, with the goal of restoring the pre-HDFS-5215 behavior as closely as possible.  Before HDFS-5215, non-DFS used was based on {{File#getUsableSpace}}, indirectly because of use of {{getAvailable}} in the calculation.  This meant that \"free but unusable\" space would have counted towards non-DFS used.\n\nHowever, that would then lead me to expect seeing a non-zero non-DFS used for the typical 5% reserved for privileged users.  In practice, I haven't seen that happen though.  I'm not sure why not.\n\nI tried digging through revision history for past decisions.  The use of {{File#getUsableSpace}} traces back to HADOOP-5958, when the code switched from forking to {{df}} to using then-new JDK 1.6 APIs.  There is a question posted about which method to use, but no specific discussion about why {{File#getUsableSpace}} was chosen.\n\nI don't think switching to {{File#getFreeSpace}} is necessarily wrong, just different from the pre-HDFS-5215 calculation, which might cause some surprises.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-02T01:23:49.770+0000","updated":"2015-12-02T01:23:49.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15035075","id":"15035075","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"I wonder how these various methods react with pooled storage....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2015-12-02T01:30:10.636+0000","updated":"2015-12-02T01:30:10.636+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15037733","id":"15037733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. I don't think switching to File#getFreeSpace is necessarily wrong, just different from the pre-HDFS-5215 calculation, which might cause some surprises.\nYes, its surprising. \nDifference in HDFS user about that {{~5%}} space, \nbefore patch --> It was taken as already used by someone (non-dfs) because its not usable by HDFS.\nafter patch --> It will display actual usage of someone (non-dfs) even though its not usable.\n\nOnly matter is, value of metric. Which doesnt affect HDFS functionality anyway.\nBut assumption in calculattion in tests {{capacityUsed + capacityRemaining + capacityUsedNonDFS == capacityTotal}} might need to change, as {{capacityRemaining}} doesnt include, that {{~5%}}.\n\nFrom the above Test Failure of {{TestNameNodeMetrics}}, below values have got\n|CapacityTotal|23318276997120|\n|CapacityUsed |147456|\n|CapacityRemaining |20273827930112|\n|CapacityUsedNonDFS |1859806781440|\n|| Difference || ~5% ||\n\n *Now we have two options to go ahead with the patch.* \n* Update the tests with assumption of extra {{~5-6%}} space for privileged users\n* fallback to {{File.getUsablespace()}}\n\nWhich one do you prefer [~cnauroth],[~arpitagarwal]..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-03T12:40:42.014+0000","updated":"2015-12-03T12:40:42.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15037745","id":"15037745","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"btw, [~aw], is YETUS-170 included in recent precommit builds? when I checked for above failure, it was not there, so mvn install failed due to wrong order.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-03T12:53:06.332+0000","updated":"2015-12-03T12:53:06.332+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15045002","id":"15045002","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Ping [~cnauroth]/[~arpitagarwal]/[~vinayrpet] once again..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-07T14:16:09.656+0000","updated":"2015-12-07T14:16:09.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15049705","id":"15049705","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm in favor of using {{File#getUsableSpace}} for the sake of consistency with the pre-HDFS-5215 behavior.  I'd also like to make sure Arpit gets a chance to respond too, but I don't expect he'll have a chance to comment until next week.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-10T00:18:25.836+0000","updated":"2015-12-10T00:18:25.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15050607","id":"15050607","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Ok.will wait till [~arpitagarwal] give his thought.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-10T11:15:58.224+0000","updated":"2015-12-10T11:15:58.224+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15051217","id":"15051217","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry for the delay in responding, I am out this week. I just did some quick testing with a single DN using a 40GB ext4 partition.\n\nWith Brahma's v005 patch modified to use {{File#getUsableSpace}} non-DFS usage is reported as 2GB, i.e. ~5%. The actual disk usage was 49MB.\n{code}\n$ bin/hdfs dfsadmin -report\n...\nLive datanodes (1):\n\nName: 127.0.0.1:50010 (localhost)\nHostname: mint0\nDecommission Status : Normal\nConfigured Capacity: 42141548544 (39.25 GB)\nDFS Used: 24576 (24 KB)\nNon DFS Used: 2215555072 (2.06 GB)  <<<<\nDFS Remaining: 39925968896 (37.18 GB)\nDFS Used%: 0.00%\nDFS Remaining%: 94.74%\n\n$ df -h /mnt/sdb/\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/sdb         40G   49M   38G   1% /mnt/sdb <<<<\n{code}\n\nWith {{File#getFreeSpace}} i.e. the v005 patch, the non-DFS used is more accurate.\n{code}\n$ bin/hdfs dfsadmin -report\n\n...\nLive datanodes (1):\n\nName: 127.0.0.1:50010 (localhost)\nHostname: mint0\nDecommission Status : Normal\nConfigured Capacity: 42141548544 (39.25 GB)\nDFS Used: 24576 (24 KB)\nNon DFS Used: 51302400 (48.93 MB)\n{code}\n\nI also checked the current behavior in trunk (no patch). It is already broken, counting the system-reserved space towards non-DFS used.\n{code}\n$ bin/hdfs dfsadmin -report\n...\n\nName: 127.0.0.1:50010 (localhost)\nHostname: mint0\nDecommission Status : Normal\nConfigured Capacity: 42141548544 (39.25 GB)\nDFS Used: 24576 (24 KB)\nNon DFS Used: 2215555072 (2.06 GB)\n{code}\n\nI think {{File#getFreeSpace}} is the correct choice. However modifying Brahma's patch use {{File#getUsableSpace}} would not introduce a regression wrt what's in trunk already so it's fine to change it to address Chris's concern. I'll file a separate Jira to discuss fixing this part.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-10T16:46:11.267+0000","updated":"2015-12-10T16:55:58.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15051260","id":"15051260","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"I also edited the Jira title to mention \"DFS reserved space\", to distinguish it from system-reserved space.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-10T17:08:21.414+0000","updated":"2015-12-10T17:08:21.414+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15051473","id":"15051473","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~arpitagarwal] updated previous patch(004) as per Chris comments and added check for -ve values..\nbq. I'll file a separate Jira to discuss fixing this part.\nwill discuss further in seperate jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-10T19:07:46.957+0000","updated":"2015-12-10T19:07:46.957+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15051734","id":"15051734","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 8 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 8m 6s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 45s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 45s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 22s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 31s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 27s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 4m 5s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 33s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 18s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 1m 29s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 53s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 53s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 9m 16s {color} | {color:red} hadoop-hdfs-project-jdk1.8.0_66 with JDK v1.8.0_66 generated 3 new issues (was 49, now 49). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 53s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 50s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 50s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 11m 6s {color} | {color:red} hadoop-hdfs-project-jdk1.7.0_91 with JDK v1.7.0_91 generated 3 new issues (was 51, now 51). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 50s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 23s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 292, now 294). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 39s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 27s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch has 1 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 4m 31s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 41s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 27s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 55s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 67m 17s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 7s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 66m 31s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 19s {color} | {color:red} Patch generated 58 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 177m 30s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.TestFileCreationDelete |\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestFsVolumeList |\n|   | hadoop.hdfs.server.namenode.TestFsck |\n|   | hadoop.hdfs.server.namenode.ha.TestSeveralNameNodes |\n|   | hadoop.hdfs.server.datanode.TestFsDatasetCache |\n| JDK v1.7.0_91 Failed junit tests | hadoop.hdfs.server.namenode.ha.TestStandbyCheckpoints |\n|   | hadoop.hdfs.server.namenode.TestRecoverStripedBlocks |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure100 |\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestFsVolumeList |\n|   | hadoop.hdfs.server.namenode.TestCacheDirectives |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12776866/HDFS-9038-006.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 2d8f7c9f185e 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 21daa6c |\n| findbugs | v3.0.0 |\n| javac | hadoop-hdfs-project-jdk1.8.0_66: https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.8.0_66.txt |\n| javac | hadoop-hdfs-project-jdk1.7.0_91: https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.7.0_91.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/whitespace-eol.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 76MB |\n| Powered by | Apache Yetus 0.1.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13828/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-10T22:06:46.576+0000","updated":"2015-12-10T22:06:46.576+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15051894","id":"15051894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"I took patch v006 for a more thorough test run.  Unfortunately, I'm still seeing the bug that was introduced by HDFS-5215.  Even though non-DFS used is now calculated explicitly by the DataNode and sent in a dedicated RPC field, it's still using an incorrect calculation.\n\nTo help illustrate the problem better, I'd like to walk through the math for calculating non-DFS used, both before HDFS-5215 and after HDFS-5215.  Here is a bit of pseudo-code, prefixed with line numbers.\n\n*Before HDFS-5215:*\n{code}\n1: nonDfsUsed = capacity - dfsUsed - available\n2:            = (File#getTotalSpace - dfs.datanode.du.reserved) - dfsUsed - available\n3:            = (File#getTotalSpace - dfs.datanode.du.reserved) - dfsUsed - File#getUsableSpace\n4:            = File#getTotalSpace - dfs.datanode.du.reserved - dfsUsed - File#getUsableSpace\n{code}\n\n*After HDFS-5215*\n{code}\n1: nonDfsUsed = capacity - dfsUsed - available\n2:            = (File#getTotalSpace - dfs.datanode.du.reserved) - dfsUsed - available\n3:            = (File#getTotalSpace - dfs.datanode.du.reserved) - dfsUsed - (File#getUsableSpace - dfs.datanode.du.reserved)\n4:            = File#getTotalSpace - dfs.datanode.du.reserved - dfsUsed - File#getUsableSpace + dfs.datanode.du.reserved\n5:            = File#getTotalSpace - dfsUsed - File#getUsableSpace\n{code}\n\nThe most important point to note is the difference in line 3 of the expansions.  After HDFS-5215, the definition of {{available}} removes {{dfs.datanode.du.reserved}}.  However, the definition of {{capacity}} already removed {{dfs.datanode.du.reserved}}.  Carrying out the expansion further in lines 4 and 5, we see that the 2 occurrences of {{dfs.datanode.du.reserved}} cancel each other out.  That means implicitly that {{nonDfsUsed}} now includes (instead of excludes) {{dfs.datanode.du.reserved}}.\n\nPatch v006 still has the same fundamental problem in the logic, because {{FsVolumeImpl#getNonDfsUsed}} still reuses the implementation of {{FsVolumeImpl#getAvailable}}, which in turn removes {{dfs.datanode.du.reserved}}.\n\nI think {{FsVolumeImpl#getNonDfsUsed}} essentially needs to go back to the old pre-HDFS-5215 calculation of {{remaining}} instead of calling {{FsVolumeImpl#getAvailable}}.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-11T00:08:23.459+0000","updated":"2015-12-11T00:08:23.459+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15052039","id":"15052039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~cnauroth] for the explanation.\n\nLets go through one simple example.\nLets consider following\n1. Disk Capacity - 10GB -- {{File#getTotalSpace}}\n2. DFS reserved - 1GB   -- {{dfs.datanode.du.reserved}}\n3. DFS Usage     -  2GB  -- {{dfsUsed}}\n4. Usage by other files - 3GB -- Actual {{non-dfsusage}}.\n\nAssuming, System reserved ( which is ~5%) as 0 for this example.\ntotal disk used is 5GB = 2GB by dfs files + 3GB by non-dfs files.\n{{File.getUsableSpace()}} returns 5GB.\n\nLets substitute this values in derived expressions.\n*Before HDFS-5215*\n{noformat}\nnonDfsUsage=File#getTotalSpace - dfs.datanode.du.reserved - dfsUsed - File#getUsableSpace\n\nnonDfsUsage = 10G - 1G - 2G - 5G\nnonDfsUsage = 2G.\n{noformat}\n{color:red}{{nonDfsUsage=2GB}} is not same as actual non-dfs usage, 3GB.{color}\n\n*After HDFS-5215* and as per patch.\n{noformat}\nnonDfsUsage=(File#getTotalSpace - dfs.datanode.du.reserved) - dfsUsed - (File#getUsableSpace - dfs.datanode.du.reserved)\nnonDfSUsage= (10G - 1G ) - 2G - (5G - 1G)\nnonDfSUsage = 9G - 2G - 4G\nnonDfsUsage = 3G\n{noformat}\n{color:green}{{nonDfsUsage = 3G}} is same as expected actual usage. i.e. 3G{color}\n\nBy seeing the above example, \nI believe, post HDFS-5215, calculation turns out to be the correct one. \n{{dfs.datanode,du.reserved}} is expected to be the freespace, which should not be used by DFS. So its reasonable to subtract this in getAvailable(), but not while finding the non-dfs usage.\n\nDo you agree [~cnauroth]?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-11T02:24:14.152+0000","updated":"2015-12-11T02:24:14.152+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15052049","id":"15052049","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Meanwhile, [~brahmareddy], forgot to update the test {{TestFsVolumeList.testNonDfsUsedMetricForVolume}}?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-11T02:34:36.842+0000","updated":"2015-12-11T02:34:36.842+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15052994","id":"15052994","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~vinayrpet] thanks for pointing..Corrected and uploaded the patch.\n\nApart from that added null check in {{TestNameNodeMetrics#tearDown}} and fixed javadoc error in {{FsVolumeImpl#getDataset}} which are not related this jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-11T16:44:14.896+0000","updated":"2015-12-11T16:44:14.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15053202","id":"15053202","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. I believe, post HDFS-5215, calculation turns out to be the correct one.\n\nI disagree, because the post-HDFS-5215 calculation has broken previously established operations workflows.\n\nNon-DFS usage is \"space unexpectedly consumed on data volumes by things that are not HDFS\".  As a cluster administrator, I would monitor the non-DFS usage value.  If a node consistently showed a non-zero non-DFS usage, then that would signal me to login to the box, figure out where the space was consumed, free it up, and then address root cause (probably a rogue process running on the wrong box or misconfigured to write to the wrong volume).  It's important to fix this, because high non-DFS usage reduces disk capacity that had been planned for HDFS.\n\nAfter HDFS-5215, this workflow no longer works.  The monitoring will show false positives because of inclusion of {{dfs.datanode.du.reserved}}.  An administrator would need to use additional checks, or simply disable this monitoring due to the noise.\n\n{{dfs.datanode.du.reserved}} is a special case on top of what I described above.  Setting a non-zero {{dfs.datanode.du.reserved}} means that the administrator intentionally wants to hold back a portion of the volume, essentially making it invisible to HDFS.  This is the same reason that {{dfs.datanode.du.reserved}} gets subtracted from the capacity calculation.  This is why I think 3 GB is incorrect in the example above.  Non-DFS usage is really \"unexpected non-DFS usage\".  By setting {{dfs.datanode.du.reserved}} to 1 GB, you have stated that up to 1 GB of usage by something other than HDFS is expected, so it's incorrect to count it as part of \"unexpected non-DFS usage\".\n\nBottom line: I have seen the post-HDFS-5215 calculation cause confusion for administrators who had built a workflow around the old calculation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-11T18:52:21.725+0000","updated":"2015-12-11T18:52:21.725+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15053672","id":"15053672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 8 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 16m 3s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 4m 56s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 30s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 45s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 3m 9s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 51s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 7m 36s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 46s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 42s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 3m 0s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 5m 0s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 5m 0s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 20m 19s {color} | {color:red} hadoop-hdfs-project-jdk1.8.0_66 with JDK v1.8.0_66 generated 3 new issues (was 49, now 49). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 5m 0s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 35s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 3m 35s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 23m 54s {color} | {color:red} hadoop-hdfs-project-jdk1.7.0_91 with JDK v1.7.0_91 generated 3 new issues (was 51, now 51). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 3m 35s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 44s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 293, now 295). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 3m 12s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 50s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 8m 45s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 54s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 55s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 2m 24s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 105m 50s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 2m 8s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 1m 14s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 36s {color} | {color:red} Patch generated 61 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 198m 16s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.TestParallelShortCircuitRead |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure150 |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractMkdir |\n|   | hadoop.hdfs.server.namenode.TestCheckPointForSecurityTokens |\n|   | hadoop.hdfs.TestBlockStoragePolicy |\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandbyWithQJM |\n|   | hadoop.cli.TestDeleteCLI |\n|   | hadoop.hdfs.tools.TestDFSZKFailoverController |\n|   | hadoop.hdfs.TestFileLengthOnClusterRestart |\n|   | hadoop.hdfs.TestAppendSnapshotTruncate |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractRootDirectory |\n|   | hadoop.hdfs.server.namenode.TestDiskspaceQuotaUpdate |\n|   | hadoop.cli.TestHDFSCLI |\n|   | hadoop.hdfs.server.namenode.TestCheckpoint |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure200 |\n|   | hadoop.hdfs.TestDFSUpgradeFromImage |\n|   | hadoop.hdfs.TestReplaceDatanodeOnFailure |\n|   | hadoop.hdfs.tools.TestGetGroups |\n|   | hadoop.hdfs.TestRemoteBlockReader2 |\n|   | hadoop.hdfs.server.namenode.TestStartup |\n|   | hadoop.hdfs.server.namenode.TestNameNodeRetryCacheMetrics |\n|   | hadoop.hdfs.TestDFSStorageStateRecovery |\n|   | hadoop.hdfs.server.namenode.TestFSImageWithXAttr |\n|   | hadoop.hdfs.TestRemoteBlockReader |\n|   | hadoop.hdfs.TestMultiThreadedHflush |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractRename |\n|   | hadoop.hdfs.TestBlockReaderLocal |\n|   | hadoop.cli.TestCacheAdminCLI |\n|   | hadoop.hdfs.server.mover.TestMover |\n|   | hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits |\n|   | hadoop.hdfs.server.namenode.TestNameNodeRecovery |\n|   | hadoop.hdfs.server.namenode.ha.TestFailureOfSharedDir |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure |\n|   | hadoop.fs.loadGenerator.TestLoadGenerator |\n|   | hadoop.hdfs.server.namenode.TestFSImageWithAcl |\n|   | hadoop.hdfs.server.namenode.TestLargeDirectoryDelete |\n|   | hadoop.fs.TestFcHdfsSetUMask |\n|   | hadoop.hdfs.TestPread |\n|   | hadoop.hdfs.server.namenode.ha.TestQuotasWithHA |\n|   | hadoop.hdfs.crypto.TestHdfsCryptoStreams |\n|   | hadoop.fs.viewfs.TestViewFsFileStatusHdfs |\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerForAcl |\n|   | hadoop.hdfs.TestDFSAddressConfig |\n|   | hadoop.tracing.TestTracingShortCircuitLocalRead |\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandby |\n|   | hadoop.hdfs.server.namenode.TestFSDirectory |\n|   | hadoop.hdfs.server.namenode.TestNameNodeMetadataConsistency |\n|   | hadoop.tracing.TestTracing |\n|   | hadoop.hdfs.TestParallelRead |\n|   | hadoop.hdfs.TestDFSStripedInputStream |\n|   | hadoop.hdfs.tools.TestDelegationTokenFetcher |\n|   | hadoop.hdfs.TestRestartDFS |\n|   | hadoop.fs.TestWebHdfsFileContextMainOperations |\n|   | hadoop.hdfs.TestParallelShortCircuitReadNoChecksum |\n|   | hadoop.hdfs.TestParallelShortCircuitLegacyRead |\n|   | hadoop.net.TestNetworkTopology |\n|   | hadoop.hdfs.TestReadStripedFileWithMissingBlocks |\n|   | hadoop.hdfs.server.namenode.ha.TestDelegationTokensWithHA |\n|   | hadoop.hdfs.server.namenode.ha.TestPipelinesFailover |\n|   | hadoop.hdfs.tools.offlineEditsViewer.TestOfflineEditsViewer |\n|   | hadoop.fs.TestFcHdfsCreateMkdir |\n|   | hadoop.hdfs.server.namenode.TestDeadDatanode |\n|   | hadoop.hdfs.server.namenode.ha.TestNNHealthCheck |\n|   | hadoop.hdfs.TestHFlush |\n|   | hadoop.hdfs.server.namenode.ha.TestFailoverWithBlockTokensEnabled |\n|   | hadoop.hdfs.TestFetchImage |\n|   | hadoop.hdfs.server.namenode.ha.TestDNFencingWithReplication |\n|   | hadoop.hdfs.server.namenode.ha.TestDNFencing |\n|   | hadoop.hdfs.TestDFSUpgrade |\n|   | hadoop.fs.TestFcHdfsPermission |\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerWithStripedBlocks |\n|   | hadoop.hdfs.server.namenode.TestProtectedDirectories |\n|   | hadoop.hdfs.TestMissingBlocksAlert |\n|   | hadoop.hdfs.server.namenode.ha.TestHAMetrics |\n|   | hadoop.hdfs.TestQuota |\n|   | hadoop.hdfs.server.namenode.TestQuotaByStorageType |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure060 |\n|   | hadoop.hdfs.server.namenode.TestSaveNamespace |\n|   | hadoop.hdfs.tools.TestDebugAdmin |\n|   | hadoop.hdfs.TestPersistBlocks |\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogsDuringFailover |\n|   | hadoop.hdfs.server.namenode.TestNameNodeRpcServer |\n|   | hadoop.hdfs.server.namenode.TestSecureNameNode |\n|   | hadoop.hdfs.server.namenode.TestSnapshotPathINodes |\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewer |\n|   | hadoop.hdfs.TestModTime |\n|   | hadoop.hdfs.server.namenode.ha.TestXAttrsWithHA |\n|   | hadoop.hdfs.TestGetBlocks |\n|   | hadoop.hdfs.TestDFSStartupVersions |\n|   | hadoop.hdfs.TestRenameWhileOpen |\n|   | hadoop.fs.viewfs.TestViewFsWithXAttrs |\n|   | hadoop.cli.TestErasureCodingCLI |\n|   | hadoop.tools.TestJMXGet |\n|   | hadoop.hdfs.TestFileAppend4 |\n|   | hadoop.TestGenericRefresh |\n|   | hadoop.hdfs.TestRecoverStripedFile |\n|   | hadoop.hdfs.server.namenode.TestAddBlock |\n|   | hadoop.hdfs.protocol.TestLocatedBlock |\n|   | hadoop.hdfs.TestDataTransferKeepalive |\n|   | hadoop.hdfs.server.namenode.ha.TestRetryCacheWithHA |\n|   | hadoop.hdfs.TestFileAppend2 |\n|   | hadoop.hdfs.TestErasureCodeBenchmarkThroughput |\n|   | hadoop.hdfs.server.namenode.ha.TestGetGroupsWithHA |\n|   | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\n|   | hadoop.hdfs.server.namenode.TestAuditLogs |\n|   | hadoop.fs.TestSWebHdfsFileContextMainOperations |\n|   | hadoop.hdfs.TestInjectionForSimulatedStorage |\n|   | hadoop.hdfs.server.namenode.TestFsck |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractDelete |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractSetTimes |\n|   | hadoop.hdfs.TestLocalDFS |\n|   | hadoop.hdfs.server.namenode.TestListCorruptFileBlocks |\n|   | hadoop.hdfs.TestCrcCorruption |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure090 |\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerForXAttr |\n|   | hadoop.hdfs.TestConnCache |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure170 |\n|   | hadoop.hdfs.server.namenode.TestStripedINodeFile |\n|   | hadoop.hdfs.TestGetFileChecksum |\n|   | hadoop.hdfs.TestFileAppend |\n|   | hadoop.hdfs.TestReservedRawPaths |\n|   | hadoop.hdfs.TestReadStripedFileWithDecoding |\n|   | hadoop.TestRefreshCallQueue |\n|   | hadoop.hdfs.TestDisableConnCache |\n|   | hadoop.cli.TestXAttrCLI |\n|   | hadoop.hdfs.server.namenode.TestMetadataVersionOutput |\n|   | hadoop.hdfs.TestParallelShortCircuitReadUnCached |\n|   | hadoop.fs.TestUrlStreamHandler |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure020 |\n|   | hadoop.fs.TestEnhancedByteBufferAccess |\n|   | hadoop.hdfs.TestHDFSServerPorts |\n|   | hadoop.hdfs.server.namenode.TestAuditLogger |\n|   | hadoop.hdfs.TestRollingUpgrade |\n|   | hadoop.fs.viewfs.TestViewFileSystemWithXAttrs |\n|   | hadoop.fs.TestHDFSFileContextMainOperations |\n|   | hadoop.hdfs.TestSafeMode |\n|   | hadoop.hdfs.protocolPB.TestPBHelper |\n|   | hadoop.hdfs.server.namenode.TestBackupNode |\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyCheckpoints |\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyBlockManagement |\n|   | hadoop.hdfs.server.namenode.TestAclConfigFlag |\n|   | hadoop.hdfs.TestFileStatusWithECPolicy |\n|   | hadoop.hdfs.TestWriteRead |\n|   | hadoop.hdfs.tools.TestDFSAdminWithHA |\n|   | hadoop.hdfs.TestExternalBlockReader |\n|   | hadoop.hdfs.server.namenode.TestMetaSave |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractAppend |\n|   | hadoop.hdfs.server.namenode.ha.TestStateTransitionFailure |\n|   | hadoop.hdfs.TestDFSStripedOutputStream |\n|   | hadoop.hdfs.TestHdfsAdmin |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractOpen |\n|   | hadoop.hdfs.server.namenode.TestAddStripedBlocks |\n|   | hadoop.hdfs.server.namenode.TestGenericJournalConf |\n|   | hadoop.hdfs.TestFileCreation |\n|   | hadoop.hdfs.server.mover.TestStorageMover |\n|   | hadoop.hdfs.TestClientReportBadBlock |\n|   | hadoop.tracing.TestTraceAdmin |\n|   | hadoop.hdfs.server.namenode.TestSecurityTokenEditLog |\n|   | hadoop.hdfs.server.namenode.TestBlockUnderConstruction |\n|   | hadoop.hdfs.TestFileCorruption |\n|   | hadoop.hdfs.server.namenode.TestHDFSConcat |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.TestClose |\n|   | hadoop.hdfs.TestAbandonBlock |\n|   | hadoop.hdfs.server.namenode.ha.TestHAFsck |\n|   | hadoop.hdfs.server.namenode.TestBlockPlacementPolicyRackFaultTolerant |\n|   | hadoop.hdfs.TestDFSInputStream |\n|   | hadoop.hdfs.TestLeaseRecovery |\n|   | hadoop.hdfs.server.namenode.ha.TestSeveralNameNodes |\n|   | hadoop.hdfs.tools.TestDFSAdmin |\n|   | hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits |\n|   | hadoop.hdfs.TestWriteBlockGetsBlockLengthHint |\n|   | hadoop.hdfs.server.namenode.ha.TestPendingCorruptDnMessages |\n|   | hadoop.fs.viewfs.TestViewFsHdfs |\n|   | hadoop.hdfs.TestDFSClientSocketSize |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractConcat |\n|   | hadoop.hdfs.server.namenode.TestFileLimit |\n|   | hadoop.fs.viewfs.TestViewFileSystemAtHdfsRoot |\n|   | hadoop.hdfs.TestHDFSTrash |\n|   | hadoop.hdfs.TestSmallBlock |\n|   | hadoop.cli.TestCryptoAdminCLI |\n|   | hadoop.hdfs.TestFileCreationDelete |\n|   | hadoop.hdfs.server.namenode.ha.TestLossyRetryInvocationHandler |\n|   | hadoop.hdfs.tools.TestDFSHAAdminMiniCluster |\n|   | hadoop.hdfs.TestReplication |\n|   | hadoop.hdfs.server.namenode.ha.TestHAAppend |\n|   | hadoop.cli.TestAclCLI |\n|   | hadoop.fs.viewfs.TestViewFileSystemWithAcls |\n|   | hadoop.hdfs.server.namenode.TestEditLogAutoroll |\n|   | hadoop.fs.TestSymlinkHdfsFileContext |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure130 |\n|   | hadoop.hdfs.server.namenode.TestTransferFsImage |\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\n|   | hadoop.fs.TestSymlinkHdfsFileSystem |\n|   | hadoop.hdfs.TestFileAppend3 |\n|   | hadoop.fs.TestUnbuffer |\n|   | hadoop.hdfs.TestPipelines |\n|   | hadoop.hdfs.TestErasureCodingPolicies |\n|   | hadoop.hdfs.TestAclsEndToEnd |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n|   | hadoop.hdfs.server.namenode.ha.TestHASafeMode |\n|   | hadoop.hdfs.qjournal.TestSecureNNWithQJM |\n|   | hadoop.hdfs.TestBlockReaderFactory |\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyIsHot |\n|   | hadoop.hdfs.server.namenode.TestFileTruncate |\n|   | hadoop.hdfs.TestFSOutputSummer |\n|   | hadoop.hdfs.TestBlockReaderLocalLegacy |\n|   | hadoop.hdfs.server.namenode.TestFSImageWithSnapshot |\n|   | hadoop.fs.viewfs.TestViewFsWithAcls |\n|   | hadoop.hdfs.server.namenode.ha.TestHAStateTransitions |\n|   | hadoop.hdfs.TestEncryptionZones |\n|   | hadoop.fs.TestResolveHdfsSymlink |\n|   | hadoop.hdfs.server.namenode.TestCommitBlockWithInvalidGenStamp |\n|   | hadoop.hdfs.server.namenode.ha.TestRequestHedgingProxyProvider |\n|   | hadoop.hdfs.TestFileConcurrentReader |\n|   | hadoop.fs.viewfs.TestViewFsDefaultValue |\n|   | hadoop.hdfs.TestAppendDifferentChecksum |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractGetFileStatus |\n|   | hadoop.hdfs.server.namenode.TestCreateEditsLog |\n|   | hadoop.hdfs.server.namenode.TestFSNamesystemMBean |\n|   | hadoop.hdfs.server.namenode.ha.TestHarFileSystemWithHA |\n|   | hadoop.hdfs.server.namenode.TestQuotaWithStripedBlocks |\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerForContentSummary |\n|   | hadoop.hdfs.server.namenode.TestNameNodeXAttr |\n|   | hadoop.hdfs.protocol.datatransfer.sasl.TestSaslDataTransfer |\n|   | hadoop.fs.viewfs.TestViewFileSystemHdfs |\n|   | hadoop.hdfs.TestParallelUnixDomainRead |\n|   | hadoop.hdfs.tools.TestStoragePolicyCommands |\n|   | hadoop.hdfs.TestDFSRemove |\n|   | hadoop.fs.viewfs.TestViewFsAtHdfsRoot |\n|   | hadoop.hdfs.qjournal.TestNNWithQJM |\n|   | hadoop.hdfs.TestFileCreationClient |\n|   | hadoop.hdfs.TestRollingUpgradeDowngrade |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractCreate |\n|   | hadoop.fs.permission.TestStickyBit |\n|   | hadoop.hdfs.TestEncryptionZonesWithKMS |\n|   | hadoop.fs.TestSymlinkHdfsDisable |\n|   | hadoop.hdfs.server.namenode.snapshot.TestOpenFilesWithSnapshot |\n|   | hadoop.hdfs.server.namenode.TestDeleteRace |\n|   | hadoop.hdfs.TestLease |\n|   | hadoop.hdfs.TestLargeBlock |\n|   | hadoop.fs.TestGlobPaths |\n|   | hadoop.hdfs.server.namenode.TestFsckWithMultipleNameNodes |\n|   | hadoop.hdfs.server.namenode.TestEditLogJournalFailures |\n|   | hadoop.hdfs.server.namenode.TestNameNodeRespectsBindHostKeys |\n|   | hadoop.hdfs.TestClientProtocolForPipelineRecovery |\n|   | hadoop.hdfs.server.datanode.TestDirectoryScanner |\n|   | hadoop.hdfs.server.namenode.TestSecondaryWebUi |\n|   | hadoop.fs.contract.hdfs.TestHDFSContractSeek |\n|   | hadoop.fs.shell.TestHdfsTextCommand |\n|   | hadoop.hdfs.TestBlockMissingException |\n| JDK v1.8.0_66 Timed out junit tests | org.apache.hadoop.hdfs.server.namenode.TestAllowFormat |\n|   | org.apache.hadoop.hdfs.server.namenode.TestEditLog |\n|   | org.apache.hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\n|   | org.apache.hadoop.hdfs.server.namenode.TestINodeAttributeProvider |\n|   | org.apache.hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12777066/HDFS-9038-007.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 2adaf36d0177 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / b7b2923 |\n| findbugs | v3.0.0 |\n| javac | hadoop-hdfs-project-jdk1.8.0_66: https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.8.0_66.txt |\n| javac | hadoop-hdfs-project-jdk1.7.0_91: https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.7.0_91.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13835/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13835/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 75MB |\n| Powered by | Apache Yetus 0.1.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13835/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-11T22:12:55.122+0000","updated":"2015-12-11T22:12:55.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15053765","id":"15053765","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 8 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 7m 49s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 30s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 35s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 21s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 27s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 26s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 3m 50s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 31s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 15s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 1m 23s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 31s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 31s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 8m 39s {color} | {color:red} hadoop-hdfs-project-jdk1.8.0_66 with JDK v1.8.0_66 generated 3 new issues (was 49, now 49). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 31s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 36s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green} 1m 36s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 10m 16s {color} | {color:red} hadoop-hdfs-project-jdk1.7.0_91 with JDK v1.7.0_91 generated 3 new issues (was 51, now 51). {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 36s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 22s {color} | {color:red} Patch generated 4 new checkstyle issues in hadoop-hdfs-project (total was 293, now 295). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 26s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 24s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 4m 7s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 37s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 22s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 50s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 68m 27s {color} | {color:green} hadoop-hdfs in the patch passed with JDK v1.8.0_66. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 1s {color} | {color:green} hadoop-hdfs-client in the patch passed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 68m 35s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 22s {color} | {color:red} Patch generated 58 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 177m 44s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.7.0_91 Failed junit tests | hadoop.hdfs.TestDataTransferProtocol |\n|   | hadoop.hdfs.server.namenode.snapshot.TestOpenFilesWithSnapshot |\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailure |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12777066/HDFS-9038-007.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 6f155179183b 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 576b569 |\n| findbugs | v3.0.0 |\n| javac | hadoop-hdfs-project-jdk1.8.0_66: https://builds.apache.org/job/PreCommit-HDFS-Build/13836/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.8.0_66.txt |\n| javac | hadoop-hdfs-project-jdk1.7.0_91: https://builds.apache.org/job/PreCommit-HDFS-Build/13836/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project-jdk1.7.0_91.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13836/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13836/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13836/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13836/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/13836/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-client U: hadoop-hdfs-project |\n| Max memory used | 75MB |\n| Powered by | Apache Yetus 0.1.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13836/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-11T23:13:53.263+0000","updated":"2015-12-11T23:13:53.263+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15053971","id":"15053971","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. dfs.datanode.du.reserved means that the administrator intentionally wants to hold back a portion of the volume, essentially making it invisible to HDFS. This is the same reason that dfs.datanode.du.reserved gets subtracted from the capacity calculation. This is why I think 3 GB is incorrect in the example above. Non-DFS usage is really \"unexpected non-DFS usage\". By setting dfs.datanode.du.reserved to 1 GB, you have stated that up to 1 GB of usage by something other than HDFS is expected, so it's incorrect to count it as part of \"unexpected non-DFS usage\".\nSo you mean, when 1GB is configured as reserved, 'Non-DFS' usage metric should show 2GB, even though actual usage by files other than HDFS is 3GB.?\nI was thinking 'NonDfsUsage' should show actual non-dfs usage. Not only unexpected part of it. So if actual non-dfs usage is within this reserved limit, metric should show 0. right?\n\nIn that case, wouldn't it be better to rename the 'NonDfsUsage' metric to 'UnexpectedNonDfsUsage' to make it more clear? Or mention somewhere to clear confusion in people like me.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-12T02:27:42.133+0000","updated":"2015-12-12T02:27:42.133+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15056966","id":"15056966","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. So if actual non-dfs usage is within this reserved limit, metric should show 0. right?\n\nYes, that's my understanding, and that's the behavior pre-HDFS-5215.\n\nbq. In that case, wouldn't it be better to rename the 'NonDfsUsage' metric to 'UnexpectedNonDfsUsage' to make it more clear? Or mention somewhere to clear confusion in people like me.\n\nI don' t think it could be renamed easily due to backwards-compatibility, but I do think we could update Metrics.md.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-14T23:28:42.523+0000","updated":"2015-12-14T23:28:42.523+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15057077","id":"15057077","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"[~brahma], thanks for your patience as we work through the math. It may be useful to describe your proposed derivation as a Jira comment before you post another patch.\n\n[~cnauroth] I think you are right in conclusion but there is a misstep in the equations in [this comment|https://issues.apache.org/jira/browse/HDFS-9038?focusedCommentId=15051894&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15051894]. {{reserved}} _should_ cancel out and it should not factor in the final computation.\n\nThe problem with the v005 patch we missed earlier is that getCapacity() subtracts reserved space. We should use the raw capacity.\n\nOne way to fix it is:\n{code}\npublic long getNonDfsUsed() throws IOException {\n  long totalFreeSpace = currentDir.getFreeSpace();\n  long nonDfsUsed = getCapacity() + reserved - getDfsUsed() - totalFreeSpace;\n  return (nonDfsUsed >= 0) ? nonDfsUsed : 0;\n}\n{code}\n\nThen the derivation becomes:\n{code}\n1: non-DFS used = getCapacity() + reserved - getDfsUsed() - totalFreeSpace\n2:              = usage.getCapacity() - reserved + reserved - getDfsUsed() - totalFreeSpace\n3:              = usage.getCapacity() - getDfsUsed() - totalFreeSpace\n4:              = File#getTotalSpace - getDfsUsed() - File#getFreeSpace\n{code}\n\nHope that makes sense.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T00:45:10.858+0000","updated":"2015-12-15T00:46:11.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15057367","id":"15057367","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"[~arpitagarwal], thanks for jumping in for calculation.\n\nI think considering We use {{File#getUsableSpace}} instead of {{File#getFreeSpace}}, current code after HDFS-5215 also comes to same equation as mentioned by [~arpitagarwal], brahma's patch doesn't change anything in this, except subtracting 'reservedForReplicas' also.\n\nBut, I think what [~cnauroth] expects is, \n*Since {{reserved}} is hidden from the HDFS in {{getCapacity()}} itself, we can think that's already used for {{nonDfs}} and subtract it from actual ondisk {{nonDfsUsage}}, showing only HDFS visible {{nonDfsUsage}}*. {{nonDfsUsage}} metric will be positive, only if the ondisk nonDfsUsage crosses beyond {{reserved}}, and it shows only excess usage beyond {{reserved}}.\ni.e. nonDfsUsage will be {{2GB}} instead of  {{3GB}}  in my earlier example, where {{1GB}} was reserved.\n\nSo final equation would be {code}nonDfsUsage=File#getTotalSpace - dfsUsed - File#getUsableSpace - reserved{code}\n\nCode would look like this.\n{code}\n  public long getNonDfsUsed() throws IOException {\n    long nonDfsUsed = getCapacity() - getDfsUsed() - getAvailable() - reserved - getReservedForReplicas();\n    return (nonDfsUsed > 0) ? nonDfsUsed : 0;\n  }\n{code}\n\nAm I right [~cnauroth]?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-15T05:26:11.709+0000","updated":"2015-12-15T05:26:11.709+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15058764","id":"15058764","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks everyone for sticking with this.  This has turned out to be much trickier than I anticipated when I filed the issue.  I'd like to summarize current status.\n\nArpit and I are in agreement about my analysis of how the calculation changed after HDFS-5215.  However, we are not yet in agreement about which calculation is truly correct.  I believe the pre-HDFS-5215 calculation (subtracting {{dfs.datanode.du.reserved}}) is correct, because it allowed me to monitor for unexpected non-zero non-DFS usage and react.  Since this was an established operations workflow (at least for me), I argue that we have a responsibility to restore that behavior.  Arpit believes that it's correct to cancel out {{dfs.datanode.du.reserved}}, because then non-DFS used would report space used for non-HDFS purposes more accurately.  Essentially, it's a question of whether this metric means \"Raw Non-DFS Used\" or \"Unplanned Non-DFS Used\".\n\nWe also discovered an interesting side issue about {{File#getUsableSpace}} vs. {{File#getFreeSpace}}.  Pre-HDFS-5215, it could be considered a bug that we did not account for system reserved space.  Interestingly, it seems in our testing that ext holds back 5% by default, but xfs does not.\n\nI pushed pretty hard for restoring the pre-HDFS-5215 behavior in my earlier comments, but I'm just one voice.  I suggest that we leave this issue open for a while for others to comment.  I could be swayed if others think I'm approaching this incorrectly.  Meanwhile, [~brahmareddy], would you please hold off on posting more patches?  Let's wait for the discussion to settle a little more first.  Thanks for your patience.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T20:45:40.905+0000","updated":"2015-12-15T20:45:40.905+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15058805","id":"15058805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"I'd really like for someone to attach a simple test case so that we can run and see the differences on different file systems.  In particular, every time we change this code, we only ever test on one or two Linux file systems and end up causing really oddball behaviors on others, especially those that don't use the traditional disk->partition->filesystem layout (e.g., ZFS).  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2015-12-15T21:05:28.814+0000","updated":"2015-12-15T21:05:28.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15058858","id":"15058858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"tl; dr - We need agreement on the definition of non-DFS used.\n\nThe pre HDFS-5215 calculation had two bugs.\n# It incorrectly subtracted reserved space from the non-DFS used. (net negative). Chris suggests this is not really an issue as non-DFS used should be shown as zero unless it exceeds the DFS reserved value.\n# It used File#getUsableSpace to calculate the volume free space instead of File#getFreeSpace. (net positive)\n\nThe net effect was that non-DFS used was displayed as zero unless the actual non-DFS used exceeded {{DFS reserved - system reserved}}.\n\nHDFS-5215 fixed the first issue and the value that is now erroneously counted towards non-DFS used is in fact the system reserved 5%. \n\nAlso attached a trivial utility that dumps the free/available space.\n\nFrom a mostly empty 40GB Ext4 partition:\n{code}\n$ java GetFree /mnt/sdb/hadoop/\nFree space       : 42,090,229,760\nAvailable space  : 39,925,968,896\n{code}\n\nSame partition reformatted as XFS:\n{code}\nFree space       : 42,894,983,168\nAvailable space  : 42,894,983,168\n{code}\n\nSo Ext derivatives hold back 5% free space while XFS does not.\n\nEdit: Removed statement about Jira description being inaccurate since it too depends on how we define non-DFS used. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T21:25:43.660+0000","updated":"2015-12-15T21:34:33.325+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15059597","id":"15059597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~umamaheswararao]/[~hitliuyi]/[~szetszwo]/[~wheat9], \nDo You have any opinions to here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-16T06:53:53.974+0000","updated":"2015-12-16T06:53:53.974+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15105047","id":"15105047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Ping. \nAny update on this guys?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-01-18T10:03:25.343+0000","updated":"2016-01-18T10:03:25.343+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15144160","id":"15144160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Ping [~cnauroth].","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-02-12T06:50:13.084+0000","updated":"2016-02-12T06:50:13.084+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15177050","id":"15177050","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. I suggest that we leave this issue open for a while for others to comment. I could be swayed if others think I'm approaching this incorrectly\n\n[~cnauroth]/[~arpitagarwal]/[~vinayrpet] can we discuss in mailing list Or do you want specific people to comment here.. Please let me know..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-03-03T02:47:29.293+0000","updated":"2016-03-03T02:47:29.293+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15177060","id":"15177060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~brahmareddy], I am sorry this patch is stuck after all the effort you put into it.\n\nThere is a disagreement on the definition of non-DFS used space. Quoting [~cnauroth]:\nbq. Essentially, it's a question of whether this metric means \"Raw Non-DFS Used\" or \"Unplanned Non-DFS Used\".\n\nI don't see any harm in starting a discussion on hdfs-dev. I will think about this some more.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-03-03T02:55:55.523+0000","updated":"2016-03-03T02:57:32.422+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15186681","id":"15186681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajisakaa","name":"ajisakaa","key":"ajisakaa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ajisakaa&avatarId=17238","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ajisakaa&avatarId=17238","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ajisakaa&avatarId=17238","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ajisakaa&avatarId=17238"},"displayName":"Akira Ajisaka","active":true,"timeZone":"Asia/Tokyo"},"body":"bq. it's a question of whether this metric means \"Raw Non-DFS Used\" or \"Unplanned Non-DFS Used\".\n\nI prefer (I'm +0 for) the following calculation, which is straightforward for me.\n{noformat}\nNon-DFS used = f.getTotalSpace() - f.getFreeSpace() - getDfsUsed()\n{noformat}\n\nWhen we reach an agreement, it should be well-documented.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajisakaa","name":"ajisakaa","key":"ajisakaa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ajisakaa&avatarId=17238","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ajisakaa&avatarId=17238","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ajisakaa&avatarId=17238","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ajisakaa&avatarId=17238"},"displayName":"Akira Ajisaka","active":true,"timeZone":"Asia/Tokyo"},"created":"2016-03-09T07:37:30.444+0000","updated":"2016-03-09T07:37:30.444+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15321892","id":"15321892","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"I spent a few hours looking at this today. I now think that the current logic in FsVolumeImpl#getAvailable is too pessimistic and the impact of bug may be more severe than reported.\n\n{code}\npublic long getAvailable() throws IOException {\n  long remaining = getCapacity() - getDfsUsed() - reservedForReplicas.get();\n  long available = usage.getAvailable() - reserved\n      - reservedForReplicas.get();\n  if (remaining > available) {\n    remaining = available;\n  }\n  return (remaining > 0) ? remaining : 0;\n}\n{code}\n\nSpecifically {{available = usage.getAvailable() - reserved ... }} can account for the non-DFS usage twice. e.g. say 10GB is reserved and YARN is using all of that 10GB. usage.getAvailable() has already accounted for that 10GB and further subtracting it makes us underestimate available.\n\nInstead the calculation should only subtract the unused portion of non-DFS used. What do you guys think?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-06-09T05:01:33.154+0000","updated":"2016-06-09T05:02:11.106+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15321907","id":"15321907","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. Instead the calculation should only subtract the unused portion of non-DFS used. What do you guys think?\nI think below code change suggested by brahma in the mailing list does exactly what you suggesting. Right?\n\n{code}   public long getAvailable() throws IOException {\n     long remaining = getCapacity() - getDfsUsed() - reservedForReplicas.get();\n-    long available = usage.getAvailable() - reserved\n+    long available = usage.getAvailable() - getRemainingReserved()\n         - reservedForReplicas.get();\n     if (remaining > available) {\n       remaining = available;\n@@ -391,6 +391,31 @@ public long getAvailable() throws IOException {\n     return (remaining > 0) ? remaining : 0;\n   }\n\n+  private long getActualNonDfsUsed() throws IOException {\n+    return usage.getUsed() - getDfsUsed();\n+  }\n+\n+  private long getRemainingReserved() throws IOException {\n+    long actualNonDfsUsed = getActualNonDfsUsed();\n+    if (actualNonDfsUsed < reserved) {\n+      return reserved - actualNonDfsUsed;\n+    }\n+    return 0L;\n+  }\n+\n+  /**\n+   * Unplanned Non-DFS usage, i.e. Extra usage beyond reserved.\n+   * @return\n+   * @throws IOException\n+   */\n+  public long getNonDfsUsed() throws IOException {\n+    long actualNonDfsUsed = getActualNonDfsUsed();\n+    if (actualNonDfsUsed < reserved) {\n+      return 0L;\n+    }\n+    return actualNonDfsUsed - reserved;\n+  }\n+\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-06-09T05:15:36.164+0000","updated":"2016-06-09T05:15:36.164+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15322988","id":"15322988","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Vinay. I see [~szetszwo] already brought this up on the mailing list thread. Brahma's proposed update looks good to me.\n\nWill this delta be applied on top of the v7 patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-06-09T17:57:18.596+0000","updated":"2016-06-09T17:57:18.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15323871","id":"15323871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Cool.. I will update v7 patch. thanks vinay and arpit..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-06-10T04:53:09.900+0000","updated":"2016-06-10T04:53:09.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15407668","id":"15407668","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploaded the patch.. [~arpitagarwal] and [~vinayrpet] kindly review.. and sorry for long delay.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-04T12:36:48.594+0000","updated":"2016-08-04T12:36:48.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15407816","id":"15407816","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 12s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 8 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 30s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 55s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 24s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 38s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 25s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 24s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m  8s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 18s{color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  7s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 18s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 23s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  1m 23s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  1m 23s{color} | {color:red} hadoop-hdfs-project generated 1 new + 51 unchanged - 1 fixed = 52 total (was 52) {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 33s{color} | {color:orange} hadoop-hdfs-project: The patch generated 7 new + 540 unchanged - 2 fixed = 547 total (was 542) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 25s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 20s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 36s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 12s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 54s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 58m 20s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 18s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 86m 46s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.tracing.TestTracing |\n|   | hadoop.hdfs.server.namenode.TestNamenodeCapacityReport |\n|   | hadoop.hdfs.server.balancer.TestBalancerWithSaslDataTransfer |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:9560f25 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12822051/HDFS-9038-008.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 039d0e6011f7 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 70c2781 |\n| Default Java | 1.8.0_101 |\n| findbugs | v3.0.0 |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/16316/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/16316/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/16316/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/16316/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/16316/console |\n| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-08-04T14:05:33.500+0000","updated":"2016-08-04T14:05:33.500+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15410466","id":"15410466","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploaded the patch to fix checkstyle issues..Testcases are passing locally..Seems to be there is a difference in jenkins and local run...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-06T04:38:10.405+0000","updated":"2016-08-06T04:38:10.405+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15410512","id":"15410512","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 59s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 9 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 29s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 23s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 55s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 42s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 53s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 28s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 31s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 20s{color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  7s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 44s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 48s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  1m 48s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  1m 48s{color} | {color:red} hadoop-hdfs-project generated 1 new + 51 unchanged - 1 fixed = 52 total (was 52) {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 40s{color} | {color:orange} hadoop-hdfs-project: The patch generated 2 new + 594 unchanged - 5 fixed = 596 total (was 599) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 49s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 45s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 15s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 58s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 76m 40s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 20s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}109m 41s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.hdfs.server.namenode.TestNameNodeMetadataConsistency |\n|   | hadoop.tracing.TestTracing |\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\n|   | hadoop.hdfs.TestFileCreationDelete |\n|   | hadoop.hdfs.server.namenode.TestNamenodeCapacityReport |\n|   | hadoop.security.TestRefreshUserMappings |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:9560f25 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12822418/HDFS-9038-009.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 16bca1a0834f 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 10ed06a |\n| Default Java | 1.8.0_101 |\n| findbugs | v3.0.0 |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/16333/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/16333/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/16333/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/16333/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/16333/console |\n| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-08-06T06:28:43.065+0000","updated":"2016-08-06T06:28:43.065+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15414078","id":"15414078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~brahmareddy], thanks for the updated patch. I will try to review this next week. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-08-09T19:20:00.023+0000","updated":"2016-08-09T19:20:00.023+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15425739","id":"15425739","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"2.7.3 is under release process, changing target-version to 2.7.4.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-08-18T01:14:54.820+0000","updated":"2016-08-18T01:14:54.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15436778","id":"15436778","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploaded the patch to fix the checkstyle issue and testcases fix. As ext filesystems will reserve 5% space which is not considered in non-dfs,hence {{TestNamenodeCapacityReport}} and {{TestNameNodeMetrics}} are failing.. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-25T12:50:21.874+0000","updated":"2016-08-25T12:50:21.874+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15437020","id":"15437020","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 20s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 9 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  6s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 17s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 48s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  2m  1s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 29s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 38s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 22s{color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  6s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 36s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 52s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  1m 52s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  1m 52s{color} | {color:red} hadoop-hdfs-project generated 1 new + 51 unchanged - 1 fixed = 52 total (was 52) {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 40s{color} | {color:orange} hadoop-hdfs-project: The patch generated 1 new + 583 unchanged - 5 fixed = 584 total (was 588) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 46s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 59s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 12s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 57s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 77m  0s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 21s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}109m  7s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.hdfs.server.mover.TestStorageMover |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:9560f25 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12825464/HDFS-9038-010.patch |\n| JIRA Issue | HDFS-9038 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 4f982e9d4706 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 525d52b |\n| Default Java | 1.8.0_101 |\n| findbugs | v3.0.0 |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/16537/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/16537/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/16537/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/16537/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/16537/console |\n| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-08-25T14:47:48.644+0000","updated":"2016-08-25T14:47:48.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15446268","id":"15446268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~arpiagariu] can you please look into latest patch..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-29T15:58:58.432+0000","updated":"2016-08-29T15:58:58.432+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15450427","id":"15450427","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for sticking with this difficult fix [~brahmareddy]. The patch looks good to me (I am still reviewing unit tests). Nitpick - {{convert(DatanodeInfoProto di)}} can use the new {{DataNodeInfo}} constructor.\n\n[~vinayrpet], [~cnauroth], [~szetszwo], do you have any comments on the latest patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-08-30T23:10:28.771+0000","updated":"2016-08-30T23:10:28.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15460609","id":"15460609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~arpitagarwal] thanks for review.. will update patch once your review completed..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-03T07:38:56.654+0000","updated":"2016-09-03T07:38:56.654+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15460919","id":"15460919","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"The tests also look fine to me. Thanks [~brahmareddy]. We should hold off committing for until next week in case Chris or Vinayakumar want to take a look at the new patch since they reviewed earlier revisions.\n\nIt'd be great to have a targeted unit test for {{PBHelperClient#convert(DatanodeInfoProto di)}} that verifies deserialization of protobufs with and without the new non-dfs used field.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-03T11:19:58.225+0000","updated":"2016-09-03T11:19:58.225+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15461883","id":"15461883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"[~brahmareddy], [~arpitagarwal] and [~vinayrpet], thank you for your dedication working through this issue.  I am +1 to proceed with the patch after addressing Arpit's last round of feedback.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-03T23:35:52.100+0000","updated":"2016-09-03T23:35:52.100+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15465140","id":"15465140","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Attaching the updated patch with new test.\n\nbq. Nitpick - convert(DatanodeInfoProto di) can use the new DataNodeInfo constructor\nThis constructor was used intentionally as new constructor was expecting all fields to be specified, instead of just DatanodeID\n\nPlease review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-05T14:29:01.535+0000","updated":"2016-09-05T14:29:39.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15465359","id":"15465359","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 27s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 10 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  8s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m  7s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 35s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 45s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 34s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 27s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 19s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 18s{color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  7s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 21s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 26s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  1m 26s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  1m 26s{color} | {color:red} hadoop-hdfs-project generated 1 new + 51 unchanged - 1 fixed = 52 total (was 52) {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 40s{color} | {color:orange} hadoop-hdfs-project: The patch generated 1 new + 639 unchanged - 5 fixed = 640 total (was 644) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 48s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 25s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m  0s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 15s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m  2s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 77m 35s{color} | {color:green} hadoop-hdfs in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 22s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}108m 19s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:9560f25 |\n| JIRA Issue | HDFS-9038 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12827080/HDFS-9038-011.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 3ecb99211ffb 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 07650bc |\n| Default Java | 1.8.0_101 |\n| findbugs | v3.0.0 |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/16636/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/16636/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/16636/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/16636/console |\n| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-05T16:27:42.880+0000","updated":"2016-09-05T16:27:42.880+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15466291","id":"15466291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 lgtm. The javac warning is due to a deprecated function which we must invoke to handle wire compatibility. The checkstyle issue was also not introduced by this patch.\n\nThanks again [~brahmareddy] for persistently driving this issue to closure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-06T03:38:12.477+0000","updated":"2016-09-06T03:38:40.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15466360","id":"15466360","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"+1 for the latest changes.\n\nThanks [~brahmareddy], [~arpitagarwal], [~cnauroth] for the co-operations.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-06T04:21:01.223+0000","updated":"2016-09-06T04:21:01.223+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15468536","id":"15468536","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Pushed to 2.8.0. Hit numerous conflicts cherry-picking to branch-2.7 that I didn't look into. 2.7.4 will likely need an updated patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-06T20:53:50.607+0000","updated":"2016-09-06T20:53:50.607+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15468552","id":"15468552","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #10401 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/10401/])\nHDFS-9038. DFS reserved space is erroneously counted towards non-DFS (arp: rev 5f23abfa30ea29a5474513c463b4d462c0e824ee)\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/blockmanagement/TestBlockManager.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/extdataset/ExternalDatasetImpl.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestDeadDatanode.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/metrics/TestNameNodeMetrics.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsDatasetImpl.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStats.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManagerTestUtil.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/TestFsVolumeList.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs-client/src/main/proto/hdfs.proto\n* (edit) hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/protocol/DatanodeInfo.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/protocolPB/TestPBHelper.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/NNThroughputBenchmark.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/SimulatedFSDataset.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestNamenodeCapacityReport.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/protocolPB/PBHelperClient.java\n* (edit) hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/server/protocol/StorageReport.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-06T21:00:48.837+0000","updated":"2016-09-06T21:00:48.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15468897","id":"15468897","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"Gentle reminder, please set the appropriate 3.0.0 fix version when committing to trunk. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-06T23:08:01.923+0000","updated":"2016-09-06T23:08:01.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15470267","id":"15470267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Uploading the branch-2.7 patch..And thanks for Arpit,Vinay and Chris for helping closure of this issue .Please review branch-2.7 patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-07T10:44:27.871+0000","updated":"2016-09-07T10:44:27.871+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15470273","id":"15470273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Reopening issue to run jenkins on branch-2.7 patch...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-07T10:47:40.008+0000","updated":"2016-09-07T10:47:40.008+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15470539","id":"15470539","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 14s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 9 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m  0s{color} | {color:green} branch-2.7 passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  1s{color} | {color:green} branch-2.7 passed with JDK v1.8.0_101 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 59s{color} | {color:green} branch-2.7 passed with JDK v1.7.0_111 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 30s{color} | {color:green} branch-2.7 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  0s{color} | {color:green} branch-2.7 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 15s{color} | {color:green} branch-2.7 passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 54s{color} | {color:green} branch-2.7 passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 58s{color} | {color:green} branch-2.7 passed with JDK v1.8.0_101 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 41s{color} | {color:green} branch-2.7 passed with JDK v1.7.0_111 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 51s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 56s{color} | {color:green} the patch passed with JDK v1.8.0_101 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  0m 56s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  0m 56s{color} | {color:red} hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_101 with JDK v1.8.0_101 generated 1 new + 44 unchanged - 1 fixed = 45 total (was 45) {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 59s{color} | {color:green} the patch passed with JDK v1.7.0_111 {color} |\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  0m 59s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  0m 59s{color} | {color:red} hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_111 with JDK v1.7.0_111 generated 1 new + 47 unchanged - 1 fixed = 48 total (was 48) {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 28s{color} | {color:orange} hadoop-hdfs-project/hadoop-hdfs: The patch generated 4 new + 523 unchanged - 3 fixed = 527 total (was 526) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 57s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 13s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 7569 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  3m 11s{color} | {color:red} The patch 137 line(s) with tabs. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m  8s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 55s{color} | {color:green} the patch passed with JDK v1.8.0_101 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 40s{color} | {color:green} the patch passed with JDK v1.7.0_111 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 44m 22s{color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_111. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 19s{color} | {color:red} The patch generated 3 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}122m 57s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_101 Failed junit tests | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |\n| JDK v1.7.0_111 Failed junit tests | hadoop.hdfs.TestDatanodeRegistration |\n|   | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:c420dfe |\n| JIRA Issue | HDFS-9038 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12827350/HDFS-9038-branch-2.7.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  cc  |\n| uname | Linux 4d52efe9b1e9 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.7 / 67204f2 |\n| Default Java | 1.7.0_111 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_101 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_111 |\n| findbugs | v3.0.0 |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_101.txt |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/diff-compile-javac-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_111.txt |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/whitespace-eol.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/whitespace-tabs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_111.txt |\n| JDK v1.7.0_111  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/16656/console |\n| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-07T12:51:36.740+0000","updated":"2016-09-07T12:51:36.740+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15470742","id":"15470742","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"{{checkstyle}} : can be ignored ,those are related to file length,method parameters (>7) and hiddenfield.\n{{javac}}: which is not introduced by this patch.\n{{whitespace}} : Seems to be some problem with report..?\n{{asflicense}} : Not related to this patch\n{{unittest failures}} : Not related to this patch\n\n[~arpitagarwal] can please review  branch-2.7 patch..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-07T14:10:02.010+0000","updated":"2016-09-07T14:10:02.010+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15471751","id":"15471751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 for the branch-2.7 patch also. Thanks Brahma.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-07T20:48:14.190+0000","updated":"2016-09-07T20:48:14.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15475022","id":"15475022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Pushed to branch-2.7.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-08T21:10:54.331+0000","updated":"2016-09-08T21:10:54.331+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15996340","id":"15996340","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maobaolong","name":"maobaolong","key":"maobaolong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maobaolong&avatarId=31477","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maobaolong&avatarId=31477","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maobaolong&avatarId=31477","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maobaolong&avatarId=31477"},"displayName":"maobaolong","active":true,"timeZone":"Etc/UTC"},"body":"{code}\npublic long getNonDfsUsed() throws IOException {\n    long actualNonDfsUsed = getActualNonDfsUsed();\n    if (actualNonDfsUsed < reserved) {\n      return 0L;\n    }\n    return actualNonDfsUsed - reserved;\n  }\n{code}\n\nThe code block above is the function to caculate nonDfsUsed, but in fact it will let the result to be 0L out of expect. Such as this following situation:\n\ndu.reserved  = 50G\nDisk Capacity = 2048G\nDisk Available = 2000G\nDfs used = 30G\n\nusage.getUsed() = dirFile.getTotalSpace() - dirFile.getFreeSpace()\n                            = 2048G - 2000G\n                            = 48G\ngetActualNonDfsUsed  =  usage.getUsed() - getDfsUsed()\n                                      =  48G - 30G\n                                      = 18G\n18G < 50G, so the function `getNonDfsUsed` actualNonDfsUsed < reserved, and the NonDfsUsed will return 0, is that logic make sense?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maobaolong","name":"maobaolong","key":"maobaolong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maobaolong&avatarId=31477","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maobaolong&avatarId=31477","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maobaolong&avatarId=31477","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maobaolong&avatarId=31477"},"displayName":"maobaolong","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-04T08:26:44.912+0000","updated":"2017-05-04T08:29:05.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/15996609","id":"15996609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"{code}\n  /**\n   * Unplanned Non-DFS usage, i.e. Extra usage beyond reserved.\n   *\n   * @return\n   * @throws IOException\n   */\n  public long getNonDfsUsed() throws IOException {\n    long actualNonDfsUsed = getActualNonDfsUsed();\n    if (actualNonDfsUsed < reserved) {\n      return 0L;\n    }\n    return actualNonDfsUsed - reserved;\n  }{code}\n\nAs the javadoc says, its the UnPlanned  Non-DFS usage beyond reserved. If the actual NonDFS usage is within reserved limits, this returns 0. You can see multiple discussions happened earlier in comments.\nSo YES, this logic makes sense.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-05-04T11:58:34.521+0000","updated":"2017-05-04T11:58:34.521+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12862573/comment/16004400","id":"16004400","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maobaolong","name":"maobaolong","key":"maobaolong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maobaolong&avatarId=31477","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maobaolong&avatarId=31477","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maobaolong&avatarId=31477","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maobaolong&avatarId=31477"},"displayName":"maobaolong","active":true,"timeZone":"Etc/UTC"},"body":"[~vshreyas] Thank you, I have known the NonDFS used mean.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maobaolong","name":"maobaolong","key":"maobaolong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maobaolong&avatarId=31477","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maobaolong&avatarId=31477","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maobaolong&avatarId=31477","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maobaolong&avatarId=31477"},"displayName":"maobaolong","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-10T09:38:30.307+0000","updated":"2017-05-10T09:38:30.307+0000"}],"maxResults":97,"total":97,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-9038/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2jwzz:"}}