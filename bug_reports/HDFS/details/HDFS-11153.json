{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13021382","self":"https://issues.apache.org/jira/rest/api/2/issue/13021382","key":"HDFS-11153","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-11-17T14:20:44.709+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jun 21 08:16:43 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11153/watchers","watchCount":3,"isWatching":false},"created":"2016-11-17T08:27:45.660+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12335732","id":"12335732","description":"3.0.0-alpha1 release","name":"3.0.0-alpha1","archived":false,"released":true,"releaseDate":"2016-09-03"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-06-21T08:16:43.811+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12330102","id":"12330102","name":"ipc"}],"timeoriginalestimate":null,"description":"HA mode,the _*\"ipc.client.connect.max.retries.on.timeouts\"*_ and _*\"ipc.client.connect.max.retries\"*_ is set zero,but if met active NN's ip changed,it will detect the change,but won't reconnect because exceed the max retry times,after do 15 times failover and then throw connection or standby exception.\nmaybe if found the address is changed,should reconnect immediately no matter the retry times limit.\n----\nlog is below:\n{noformat}\n2016-11-16 17:00:20,844 (WARN org.apache.hadoop.ipc.Client 510): Address change detected. Old: *****:9000 New: XXXXX:9000\n2016-11-16 17:01:09,893 (WARN org.apache.hadoop.ipc.Client 510): Address change detected. Old: *****::9000 New: XXXXX:9000\n2016-11-16 17:01:09,893 (WARN org.apache.hadoop.io.retry.RetryInvocationHandler 118): Exception while invoking class org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.getFileInfo. Not retrying because failovers (15) exceeded maximum allowed (15)\n{noformat}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12839508","id":"12839508","filename":"HDFS-1153.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-11-18T06:16:14.010+0000","size":5227,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12839508/HDFS-1153.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12869388","id":"12869388","filename":"stupid.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-23T02:48:45.464+0000","size":378918,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12869388/stupid.png"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"RPC Client detect address changed should reconnect immediately","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13021382/comment/15673846","id":"15673846","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kihwal","name":"kihwal","key":"kihwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kihwal&avatarId=34594","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kihwal&avatarId=34594","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kihwal&avatarId=34594","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kihwal&avatarId=34594"},"displayName":"Kihwal Lee","active":true,"timeZone":"America/Chicago"},"body":"You can enable this through config. Here is an example:\n{noformat}\ndfs.client.retry.policy.enabled=true\ndfs.client.retry.policy.spec=1000,2\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kihwal","name":"kihwal","key":"kihwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kihwal&avatarId=34594","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kihwal&avatarId=34594","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kihwal&avatarId=34594","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kihwal&avatarId=34594"},"displayName":"Kihwal Lee","active":true,"timeZone":"America/Chicago"},"created":"2016-11-17T14:20:44.709+0000","updated":"2016-11-17T14:20:44.709+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13021382/comment/15675579","id":"15675579","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"body":"[~kihwal] In the case ,it's should reconnect irrespective of retry policy maybe better. \nAnd the *_ConnectTimeoutException_* not handle by _MultipleLinearRandomRetry_ retry policy.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-11-18T03:08:41.855+0000","updated":"2016-11-18T03:08:41.855+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13021382/comment/16020587","id":"16020587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"body":"As default behavior,why found host is changed,but do nothing.it's unreasonable,and we can't release very corrected configuration for every client.  [~kihwal]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-23T02:47:01.762+0000","updated":"2017-05-23T02:47:44.411+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13021382/comment/16020593","id":"16020593","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=magnum","name":"magnum","key":"magnum","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"KWON BYUNGCHANG","active":true,"timeZone":"Asia/Seoul"},"body":"This problem also occurs in ResourceManager. \nI think this issue seems to fit the hadoop common jira.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=magnum","name":"magnum","key":"magnum","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"KWON BYUNGCHANG","active":true,"timeZone":"Asia/Seoul"},"created":"2017-05-23T02:59:42.237+0000","updated":"2017-05-23T02:59:42.237+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13021382/comment/16057160","id":"16057160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"body":"at least,should config dfs.client.failover.connection.retries.on.timeouts=1 as default by not 0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Deng+FEI","name":"Deng FEI","key":"deng fei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"DENG FEI","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-06-21T08:16:43.811+0000","updated":"2017-06-21T08:16:43.811+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11153/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i36fvz:"}}