{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13069067","self":"https://issues.apache.org/jira/rest/api/2/issue/13069067","key":"HDFS-11753","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334218","id":"12334218","description":"2.9.0 release","name":"2.9.0","archived":false,"released":true,"releaseDate":"2017-11-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335737","id":"12335737","description":"3.0.0-beta1 release","name":"3.0.0-beta1","archived":false,"released":true,"releaseDate":"2017-10-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2017-05-08T04:19:12.015+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jun 26 09:22:05 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_2_*:*_322805772_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_37494127236","customfield_12312321":null,"resolutiondate":"2018-07-16T01:38:27.770+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11753/watchers","watchCount":6,"isWatching":false},"created":"2017-05-04T08:56:14.792+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337976","id":"12337976","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339198","id":"12339198","name":"2.8.1","archived":false,"released":true,"releaseDate":"2017-06-08"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12340353","id":"12340353","name":"2.8.2","archived":false,"released":true,"releaseDate":"2017-10-24"}],"issuelinks":[{"id":"12538687","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12538687","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"13100840","key":"HDFS-12407","self":"https://issues.apache.org/jira/rest/api/2/issue/13100840","fields":{"summary":"Journal nodes fails to shutdown cleanly if JournalNodeHttpServer or JournalNodeRpcServer fails to start","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-07-16T01:38:27.796+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319803","id":"12319803","name":"journal-node","description":"Journal Node for the QJM"}],"timeoriginalestimate":null,"description":"Add exception catch and termination. If I start journalnode multiple times, I get multiple journalnode daemons that don't work for I config the same port.\n{quote}[hdfs@localhost ~]$ jps\n*10107 JournalNode*\n*46023 JournalNode*\n57944 NameNode\n46539 Jps\n57651 DFSZKFailoverController\n57909 DataNode\n*57739 JournalNode*\n*45721 JournalNode*{quote}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12866360","id":"12866360","filename":"HDFS-11753.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-04T09:01:27.261+0000","size":2617,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12866360/HDFS-11753.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Multiple JournalNode Daemons Coexist","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/15996428","id":"15996428","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"body":"Add some enhancements to journalnode, please check, thanks in advance.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-04T09:26:10.015+0000","updated":"2017-05-04T09:26:10.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/15997847","id":"15997847","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"body":"Add relationship with https://issues.apache.org/jira/browse/HDFS-3723","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-05T06:31:43.178+0000","updated":"2017-05-05T06:31:43.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16000241","id":"16000241","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 18s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 13m 53s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 47s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 37s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 54s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 15s{color} | {color:green} trunk passed {color} |\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  1m 41s{color} | {color:red} hadoop-hdfs-project/hadoop-hdfs in trunk has 10 extant Findbugs warnings. {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 49s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 44s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 44s{color} | {color:green} the patch passed {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 33s{color} | {color:orange} hadoop-hdfs-project/hadoop-hdfs: The patch generated 3 new + 6 unchanged - 0 fixed = 9 total (was 6) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 50s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 11s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 45s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 36s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 74m 12s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 23s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}100m 40s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.hdfs.server.namenode.ha.TestPipelinesFailover |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure080 |\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureReporting |\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailure |\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure030 |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:14b5c93 |\n| JIRA Issue | HDFS-11753 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12866360/HDFS-11753.001.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux e7bb02ca3183 3.13.0-107-generic #154-Ubuntu SMP Tue Dec 20 09:57:27 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / a9a3d21 |\n| Default Java | 1.8.0_121 |\n| findbugs | v3.1.0-RC1 |\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/19338/artifact/patchprocess/branch-findbugs-hadoop-hdfs-project_hadoop-hdfs-warnings.html |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/19338/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/19338/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/19338/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/19338/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-08T04:19:12.015+0000","updated":"2017-05-08T04:19:12.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16001008","id":"16001008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"body":"Add some explanation about QA results, welcome suggestions.\n1.test4tests\nThe patch is not that complicated, and can be verified by simple steps as follows.\n1.1 Add support -h for *hdfs journalnode*, since it only has general options, I add a brief statement about journalnode followed the style of secondary namenode.\n1.2 I use *hdfs journalnode* with different config files, i.e. start journalnode several times on one node, I get several journalnode daemons. Details will be pasted soon.\n2.checkstyle\nVery meaningful, plan to make a new patch soon, but I haven't realized the relationship with my patch, is there any opinions? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-08T16:14:34.401+0000","updated":"2017-05-08T16:14:34.401+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16007576","id":"16007576","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"body":"I made more tests these days, and the conclusion about multiple jn daemons was:\n\n*1.Branch-2(e.g. 2.8.1,2.7.3,2.6.0) does have the bug*\n{code:title=A. First a normal environment.|borderStyle=solid}\nhdfs@localhost:~> jps\n46453 DFSZKFailoverController\n5119 Jps\n4311 JournalNode\n46859 NameNode\n46888 DataNode\n{code}\n\n{code:title=B. Start jn once more and it hangs up while nn or dn don't have the problem.|borderStyle=solid}\nhdfs@localhost:~> hdfs journalnode\n2017-05-12 10:32:17,291 INFO org.apache.hadoop.hdfs.qjournal.server.JournalNode: STARTUP_MSG: \n/************************************************************\nSTARTUP_MSG: Starting JournalNode\nSTARTUP_MSG:   host = localhost/127.0.0.1\nSTARTUP_MSG:   args = []\n......\n2017-05-12 10:32:18,571 INFO org.apache.hadoop.http.HttpServer2: HttpServer.start() threw a non Bind IOException\njava.net.BindException: Port in use: 0.0.0.0:8480\n        at org.apache.hadoop.http.HttpServer2.openListeners(HttpServer2.java:919)\n        at org.apache.hadoop.http.HttpServer2.start(HttpServer2.java:856)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNodeHttpServer.start(JournalNodeHttpServer.java:69)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNode.start(JournalNode.java:163)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNode.run(JournalNode.java:137)\n        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)\n        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:84)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNode.main(JournalNode.java:310)\nCaused by: java.net.BindException: address in use\n        at sun.nio.ch.Net.bind0(Native Method)\n        at sun.nio.ch.Net.bind(Net.java:444)\n        at sun.nio.ch.Net.bind(Net.java:436)\n        at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:214)\n        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74)\n        at org.mortbay.jetty.nio.SelectChannelConnector.open(SelectChannelConnector.java:216)\n        at org.apache.hadoop.http.HttpServer2.openListeners(HttpServer2.java:914)\n        ... 7 more\nException in thread \"main\" java.net.BindException: Port in use: 0.0.0.0:8480\n        at org.apache.hadoop.http.HttpServer2.openListeners(HttpServer2.java:919)\n        at org.apache.hadoop.http.HttpServer2.start(HttpServer2.java:856)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNodeHttpServer.start(JournalNodeHttpServer.java:69)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNode.start(JournalNode.java:163)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNode.run(JournalNode.java:137)\n        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)\n        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:84)\n        at org.apache.hadoop.hdfs.qjournal.server.JournalNode.main(JournalNode.java:310)\nCaused by: java.net.BindException: address in use\n        at sun.nio.ch.Net.bind0(Native Method)\n        at sun.nio.ch.Net.bind(Net.java:444)\n        at sun.nio.ch.Net.bind(Net.java:436)\n        at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:214)\n        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74)\n        at org.mortbay.jetty.nio.SelectChannelConnector.open(SelectChannelConnector.java:216)\n        at org.apache.hadoop.http.HttpServer2.openListeners(HttpServer2.java:914)\n        ... 7 more\n\n{code}\n\n{code:title=C. Get multiple jn daemons.|borderStyle=solid}\nhdfs@localhost:~> jps\n45930 JournalNode\n46453 DFSZKFailoverController\n4311 JournalNode\n46305 Jps\n46859 NameNode\n46888 DataNode\n{code}\n\n{code:title=Appendix. Abnormal jn thread dump.|borderStyle=solid}\nhdfs@localhost:~> jstack 45930\n2017-05-12 10:42:52\nFull thread dump Java HotSpot(TM) 64-Bit Server VM (24.55-b03 mixed mode):\n\n\"Attach Listener\" daemon prio=10 tid=0x00007f87e478b800 nid=0x110a3 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"DestroyJavaVM\" prio=10 tid=0x00007f87e400f000 nid=0xb392 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"pool-1-thread-1\" prio=10 tid=0x00007f87e4a2e000 nid=0xb3ae waiting on condition [0x00007f87d9a92000]\n   java.lang.Thread.State: TIMED_WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00000000ef60b7a8> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:226)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2082)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1090)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:807)\n        at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\n\n\"Timer for 'JournalNode' metrics system\" daemon prio=10 tid=0x00007f87e4896000 nid=0xb3ac in Object.wait() [0x00007f87d9de4000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00000000ed889a90> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Timer.java:552)\n        - locked <0x00000000ed889a90> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Timer.java:505)\n\n\"Service Thread\" daemon prio=10 tid=0x00007f87e40a8000 nid=0xb3a2 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread1\" daemon prio=10 tid=0x00007f87e40a5800 nid=0xb3a1 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread0\" daemon prio=10 tid=0x00007f87e40a2800 nid=0xb3a0 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Signal Dispatcher\" daemon prio=10 tid=0x00007f87e4098800 nid=0xb39f runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n......\n{code}\n\nThese exceptions should be caught and make later jn daemon exit, I apply my patch, and start jn once more, it exit.\n\n*2.Trunk has made excellent shell rewrite and improvement that avoid multiple jn daemons in advance*\n{code:title=Shell makes protection|borderStyle=solid}\nroot:~/version/hadoop-3.0.0-alpha2/bin$ ./hdfs journalnode\njournalnode is running as process 30273.  Stop it first.\n{code}\n\nYet I still think journalnode itself  should catch exceptions as namenode and datanode do, this will be better.  \n\nAbove all, I split usage into HDFS-11806. And modify this issue to focus on solving multiple journalnode daemons.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-05-12T03:18:19.733+0000","updated":"2017-05-12T03:18:19.733+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16509511","id":"16509511","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"AFAIK, HDFS-12407 address this issue.. can you please confirm..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-06-12T11:34:27.085+0000","updated":"2018-06-12T11:34:27.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16509518","id":"16509518","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |\r\n| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m  7s{color} | {color:red} HDFS-11753 does not apply to trunk. Rebase required? Wrong Branch? See https://wiki.apache.org/hadoop/HowToContribute for help. {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| JIRA Issue | HDFS-11753 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12866360/HDFS-11753.001.patch |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/24423/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-06-12T11:41:08.470+0000","updated":"2018-06-12T11:41:08.470+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16523463","id":"16523463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"body":"[~brahmareddy] Sorry for late and thank you, I confirm HDFS-12407, could you please assign this to me, so I can mark it as duplicated?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=doris","name":"doris","key":"doris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=doris&avatarId=30271","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=doris&avatarId=30271","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=doris&avatarId=30271","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=doris&avatarId=30271"},"displayName":"Doris Gu","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-06-26T09:14:11.395+0000","updated":"2018-06-26T09:14:11.395+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13069067/comment/16523471","id":"16523471","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for confirmation. Added you as HDFS contributor and assigned the issue to you.. Now onwards you can assign the issues yourself.\r\n\r\nPlease colse this issue as duplicate of HDFS-12407.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-06-26T09:22:05.563+0000","updated":"2018-06-26T09:22:05.563+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11753/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3eh5r:"}}