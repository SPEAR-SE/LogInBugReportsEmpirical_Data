{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13179089","self":"https://issues.apache.org/jira/rest/api/2/issue/13179089","key":"HDFS-13828","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2018-08-15T16:14:09.027+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Aug 24 04:12:42 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_742710261_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2018-08-24T04:13:10.362+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-13828/watchers","watchCount":2,"isWatching":false},"created":"2018-08-15T13:54:40.126+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12331979","id":"12331979","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-24T04:13:10.385+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312927","id":"12312927","name":"datanode"}],"timeoriginalestimate":null,"description":"We were observing the breach of the xceiver count 4096, On a particular set of nodes from 5 - 8 nodes in a 900 nodes cluster.\r\nAnd we stopped the datanode services on those nodes and made to replicate across the cluster. After that also, we observed the same issue on a new set of nodes.\r\n\r\nQ1: Why on a particular node, and also after decommissioning the node the data should be replicated across the cluster, But why again difference set of node?\r\n\r\nAssumptions :\r\nReading a particular block/ data on that node might be the cause for this but it should be mitigated after the decommission but not why? So suspected that those MR jobs are triggered from Hive, so the query might be referring to the same block mulitple times  in different stages and creating this issue?\r\n\r\nFrom Thread Dump :\r\n\r\nThread dump of datanode says that out of 4090+ xceiver threads created on that node nearly 4000+ where belong to the same AppId of multiple mappers with state no operation.\r\n\r\n \r\n\r\nAny suggestions on this?\r\n\r\n \r\n\r\n \r\n\r\n ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"DataNode breaching Xceiver Count","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Amithsha","name":"Amithsha","key":"amithsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amithsha","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Amithsha","name":"Amithsha","key":"amithsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amithsha","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13179089/comment/16581298","id":"16581298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"It doesn't seem like a bug to me. There are scenarios where the default 4096 transxcever count may be exceeded, and depending on the scenario, you might want to raise the max tranxcever count.\r\n\r\nAlso note that jira is not a forum for questions but for bug reports. If you think there are bugs, please attach relevant logs and setups.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-08-15T16:14:09.027+0000","updated":"2018-08-15T16:14:09.027+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13179089/comment/16581356","id":"16581356","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Amithsha","name":"Amithsha","key":"amithsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amithsha","active":true,"timeZone":"Etc/UTC"},"body":"Agree on xceiver count may be not sufficient but why for a particular node. And also its not happening on one node it's on a particular set of nodes.\r\nAdding the thread dump and datanode log.\r\n\r\n\"DataXceiver for client DFSClient_attempt_1526704594842_1801529_m_008193_0_1144052212_1 at /x.x.x.x:38313 [Waiting for operation #28|#28]\" #55366018 daemon prio=5 os_prio=0 tid=0x00007fcdaa0ca000 nid=0x128c runnable [0x00007fcd24485000]\r\n\r\n   java.lang.Thread.State: RUNNABLE\r\n\r\n        at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\r\n\r\n        at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)\r\n\r\n        at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)\r\n\r\n        at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)\r\n\r\n        - locked <0x0000000794fde658> (a sun.nio.ch.Util$2)\r\n\r\n        - locked <0x0000000794fde640> (a java.util.Collections$UnmodifiableSet)\r\n\r\n        - locked <0x00000007b072db98> (a sun.nio.ch.EPollSelectorImpl)\r\n\r\n        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)\r\n\r\n        at org.apache.hadoop.net.SocketIOWithTimeout$SelectorPool.select(SocketIOWithTimeout.java:335)\r\n\r\n        at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:157)\r\n\r\n        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)\r\n\r\n        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)\r\n\r\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)\r\n\r\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:265)\r\n\r\n        - locked <0x00000005e9dc1de0> (a java.io.BufferedInputStream)\r\n\r\n        at java.io.DataInputStream.readShort(DataInputStream.java:312)\r\n\r\n        at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.readOp(Receiver.java:58)\r\n\r\n        at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:227)\r\n\r\n        at java.lang.Thread.run(Thread.java:745)\r\n\r\n \r\n\r\n\"DataXceiver for client DFSClient_attempt_1526704594842_1801529_m_003865_0_-1268040697_1 at /x.x.x.x:9258 [Sending block BP-1733841164-x.x.x.x-1440204182440:blk_8704233925_7644500095]\" #55361352 daemon prio=5 os_prio=0 tid=0x00007fcdaa360000 nid=0xc93d runnable [0x00007fcca559e000]\r\n\r\n   java.lang.Thread.State: RUNNABLE\r\n\r\n        at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\r\n\r\n        at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)\r\n\r\n        at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)\r\n\r\n        at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)\r\n\r\n        - locked <0x00000007a5ae6e30> (a sun.nio.ch.Util$2)\r\n\r\n        - locked <0x00000007a5ae6e18> (a java.util.Collections$UnmodifiableSet)\r\n\r\n        - locked <0x000000079d242470> (a sun.nio.ch.EPollSelectorImpl)\r\n\r\n        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)\r\n\r\n \r\n\r\n \r\n\r\n \r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Amithsha","name":"Amithsha","key":"amithsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amithsha","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-15T17:06:07.808+0000","updated":"2018-08-15T17:06:38.394+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13179089/comment/16591139","id":"16591139","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Amithsha","name":"Amithsha","key":"amithsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amithsha","active":true,"timeZone":"Etc/UTC"},"body":"We found that hive job referring to one particular block.\r\n\r\nWhich caused the spike in Xceiver count.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Amithsha","name":"Amithsha","key":"amithsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amithsha","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-24T04:12:42.411+0000","updated":"2018-08-24T04:12:42.411+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-13828/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3x2kn:"}}