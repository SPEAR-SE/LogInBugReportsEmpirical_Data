{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12543863","self":"https://issues.apache.org/jira/rest/api/2/issue/12543863","key":"HDFS-3001","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2012-02-23T18:14:30.172+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue May 29 15:44:40 UTC 2012","customfield_12310420":"229101","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_8289606720_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-05-29T15:44:40.806+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-3001/watchers","watchCount":7,"isWatching":false},"created":"2012-02-23T17:04:34.228+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318885","id":"12318885","description":"0.23.1 - Performance release","name":"0.23.1","archived":false,"released":true,"releaseDate":"2012-02-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnvijoe","name":"johnvijoe","key":"johnvijoe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John George","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-05-29T15:44:40.943+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312928","id":"12312928","name":"hdfs-client"}],"timeoriginalestimate":null,"description":"With a valid hdfs kerberos ticket, the dfsadmin subcommand '-refreshServiceAcl' still fails on Kerb authentication. Please see the comment for more details.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"114064","customfield_12312823":null,"summary":"dfsadmin -refreshServiceAcl fails Kerb authentication with valid Kerb ticket, other subcommands succeed","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=patwhitey2007","name":"patwhitey2007","key":"patwhitey2007","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"patrick white","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=patwhitey2007","name":"patwhitey2007","key":"patwhitey2007","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"patrick white","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12543863/comment/13214901","id":"13214901","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"With a valid hdfs kerberos ticket, the dfsadmin subcommand '-refreshServiceAcl' still fails on Kerb authentication with\nthe following error:\n\nbash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/\ndfsadmin -refreshServiceAcl\nrefreshServiceAcl: User hdfs/USER@DOMAIN (auth:KERBEROS) is not authorized for protocol\ninterface org.apache.hadoop.security.authorize.Refresh\nAuthorizationPolicyProtocol, expected client Kerberos principal is null\n\nHowever, other dfsadmin commands like '-printTopology', '-refreshNamenodes', '-safemode', '-report', which should use\nthe same privilege level, do not give authentication errors and work successfully:\n\n- kerb ticket -\nbash-3.2$ klist -5\nTicket cache: FILE:/tmp/path/kbtickets/hdfs.kerberos.ticket\nDefault principal: hdfs/USER@DOMAIN\n\nValid starting Expires Service principal\n01/18/12 23:59:53 01/19/12 23:59:53 krbtgt/USER@DOMAIN\nrenew until 01/25/12 23:59:53\n\n- -printTopology subcommand -\nbash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/\ndfsadmin -printTopology\nRack: /IPADDR1.0\nIPADDR2.43:1004 (HOST1.com)\nIPADDR3.44:1004 (HOST2.com)\nIPADDRn.60:1004 (HOSTn.com)\n\nRack: /default-rack\nHOSTr.com\n\n- -refreshNamenodes subcommand -\nbash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/\ndfsadmin -fs hdfs://NNHOST:8020 -refreshNamenodes DNHOST:8020\nbash-3.2$ echo $?\n0\n\n- -safemode subcommand -\nbash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/\ndfsadmin -fs hdfs://NNHOST:8020 -safemode get\nSafe mode is OFF\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-02-23T18:14:30.172+0000","updated":"2012-02-23T18:14:30.172+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12543863/comment/13217372","id":"13217372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"Hmm  \"hdfs/USER@DOMAIN\" seems suspicious.  Typical user-escalation-type principal configurations would make this look like user/hdfs@DOMAIN .  Is this just a configuration problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2012-02-27T18:43:57.798+0000","updated":"2012-02-27T18:43:57.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12543863/comment/13223607","id":"13223607","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=patwhitey2007","name":"patwhitey2007","key":"patwhitey2007","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"patrick white","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for the feedback and good point, this might be the case. John was working to reproduce this but did not see the issue, we checked to confirm that i was running as a privileged user. I was, however the environment has a Kerb user translation rule in the site config's 'hadoop.security.auth_to_local' setting which remaps the running userid, this is likely the cause for the issue. Trying to get some bandwidth in order to confirm.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=patwhitey2007","name":"patwhitey2007","key":"patwhitey2007","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"patrick white","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-06T20:07:00.105+0000","updated":"2012-03-06T20:07:00.105+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12543863/comment/13284886","id":"13284886","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnvijoe","name":"johnvijoe","key":"johnvijoe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John George","active":true,"timeZone":"America/Los_Angeles"},"body":"Pat,\nI am going to close this as not-reproducible anymore. If you disagree, please feel free to re-open.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnvijoe","name":"johnvijoe","key":"johnvijoe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John George","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-29T15:44:40.891+0000","updated":"2012-05-29T15:44:40.891+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-3001/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0jvov:"}}