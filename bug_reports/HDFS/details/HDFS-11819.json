{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13071686","self":"https://issues.apache.org/jira/rest/api/2/issue/13071686","key":"HDFS-11819","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2017-05-12T23:29:12.189+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 17 01:38:42 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_358359000_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2017-05-17T01:38:42.615+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11819/watchers","watchCount":8,"isWatching":false},"created":"2017-05-12T22:06:03.703+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337976","id":"12337976","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-05-17T01:38:42.699+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"When the hedged read thread pool is exhausted, the current behavior is that callable will be executed in the current thread context. The callable can throw out IOExceptions which is not handled and it will not start a 'hedged' read. \n\nhttps://github.com/apache/hadoop/blob/trunk/hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/DFSInputStream.java#L1131\n\nPlease see the following exception:\n{code}\n2017-05-11 22:42:35,883 WARN org.apache.hadoop.hdfs.BlockReaderFactory: I/O error constructing remote block reader.\norg.apache.hadoop.net.ConnectTimeoutException: 3000 millis timeout while waiting for channel to be ready for connect. ch : java.nio.channels.SocketChannel[connection-pending remote=/*.*.*.*:50010]\n        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:533)\n        at org.apache.hadoop.hdfs.DFSClient.newConnectedPeer(DFSClient.java:3527)\n        at org.apache.hadoop.hdfs.BlockReaderFactory.nextTcpPeer(BlockReaderFactory.java:840)\n        at org.apache.hadoop.hdfs.BlockReaderFactory.getRemoteBlockReaderFromTcp(BlockReaderFactory.java:755)\n        at org.apache.hadoop.hdfs.BlockReaderFactory.build(BlockReaderFactory.java:376)\n        at org.apache.hadoop.hdfs.DFSInputStream.actualGetFromOneDataNode(DFSInputStream.java:1179)\n        at org.apache.hadoop.hdfs.DFSInputStream.access$300(DFSInputStream.java:91)\n        at org.apache.hadoop.hdfs.DFSInputStream$2.call(DFSInputStream.java:1141)\n        at org.apache.hadoop.hdfs.DFSInputStream$2.call(DFSInputStream.java:1133)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at java.util.concurrent.ThreadPoolExecutor$CallerRunsPolicy.rejectedExecution(ThreadPoolExecutor.java:2022)\n        at org.apache.hadoop.hdfs.DFSClient$2.rejectedExecution(DFSClient.java:3571)\n        at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)\n        at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1369)\n        at java.util.concurrent.ExecutorCompletionService.submit(ExecutorCompletionService.java:181)\n        at org.apache.hadoop.hdfs.DFSInputStream.hedgedFetchBlockByteRange(DFSInputStream.java:1280)\n        at org.apache.hadoop.hdfs.DFSInputStream.pread(DFSInputStream.java:1477)\n        at org.apache.hadoop.hdfs.DFSInputStream.read(DFSInputStream.java:1439)\n        at org.apache.hadoop.fs.FSDataInputStream.read(FSDataInputStream.java:92)\n        at org.apache.hadoop.hbase.io.FileLink$FileLinkInputStream.read(FileLink.java:167)\n        at org.apache.hadoop.fs.FSDataInputStream.read(FSDataInputStream.java:92)\n        at org.apache.hadoop.hbase.io.hfile.HFileBlock.positionalReadWithExtra(HFileBlock.java:757)\n        at org.apache.hadoop.hbase.io.hfile.HFileBlock$AbstractFSReader.readAtOffset(HFileBlock.java:1457)\n        at org.apache.hadoop.hbase.io.hfile.HFileBlock$FSReaderImpl.readBlockDataInternal(HFileBlock.java:1682)\n        at org.apache.hadoop.hbase.io.hfile.HFileBlock$FSReaderImpl.readBlockData(HFileBlock.java:1542)\n        at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.readBlock(HFileReaderV2.java:445)\n        at org.apache.hadoop.hbase.util.CompoundBloomFilter.contains(CompoundBloomFilter.java:100)\n        at org.apache.hadoop.hbase.regionserver.StoreFile$Reader.passesGeneralBloomFilter(StoreFile.java:1383)\n        at org.apache.hadoop.hbase.regionserver.StoreFile$Reader.passesBloomFilter(StoreFile.java:1247)\n        at org.apache.hadoop.hbase.regionserver.StoreFileScanner.shouldUseScanner(StoreFileScanner.java:469)\n        at org.apache.hadoop.hbase.regionserver.StoreScanner.selectScannersFrom(StoreScanner.java:393)\n        at org.apache.hadoop.hbase.regionserver.StoreScanner.getScannersNoCompaction(StoreScanner.java:312)\n        at org.apache.hadoop.hbase.regionserver.StoreScanner.<init>(StoreScanner.java:192)\n        at org.apache.hadoop.hbase.regionserver.HStore.createScanner(HStore.java:2106)\n        at org.apache.hadoop.hbase.regionserver.HStore.getScanner(HStore.java:2096)\n        at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.<init>(HRegion.java:5544)\n        at org.apache.hadoop.hbase.regionserver.HRegion.instantiateRegionScanner(HRegion.java:2569)\n        at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:2555)\n        at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:2536)\n        at org.apache.hadoop.hbase.regionserver.HRegion.get(HRegion.java:6791)\n        at org.apache.hadoop.hbase.regionserver.HRegion.get(HRegion.java:6770)\n        at org.apache.hadoop.hbase.regionserver.RSRpcServices.get(RSRpcServices.java:2025)\n        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:33644)\n        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2170)\n        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:109)\n        at org.apache.hadoop.hbase.ipc.RpcExecutor$Handler.run(RpcExecutor.java:185)\n        at org.apache.hadoop.hbase.ipc.RpcExecutor$Handler.run(RpcExecutor.java:165)\n\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"HDFS client with hedged read, handle exceptions from callable  when the hedged read thread pool is exhausted","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13071686/comment/16008794","id":"16008794","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"body":"Can someone help to assign the jira to me? I will try  to work on a patch, thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-12T22:07:39.580+0000","updated":"2017-05-12T22:07:39.580+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13071686/comment/16008902","id":"16008902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"Added and assigned, thanks [~huaxiang]!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-05-12T23:29:12.189+0000","updated":"2017-05-12T23:29:12.189+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13071686/comment/16008937","id":"16008937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"body":"Thanks Andrew!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-12T23:55:55.960+0000","updated":"2017-05-12T23:55:55.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13071686/comment/16009550","id":"16009550","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"body":"While trying to work on a patch, I went through the java code, https://github.com/apache/hadoop/blob/trunk/hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/DFSInputStream.java#L1131 is not supposed to throw out the IOException, and the IOException will be handled in following future.get(). This seems not a valid issue, will look at my logs more and report back, thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-13T23:33:17.345+0000","updated":"2017-05-13T23:33:17.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13071686/comment/16013362","id":"16013362","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"body":"Update after more log reading, so when the hedged read thread pool is exhausted, the hedged read does not work anymore.\nSince the thread is not interrupted, it is easy to exhaust the thread pool in some error conditions.\n\nhttps://github.com/apache/hadoop/blob/trunk/hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/DFSInputStream.java#L1228\n\nDiscussed with [~atm] and [~jzhuge], they will follow up with the new jira if it can be improved after research. I am closing this one as invalid. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-17T01:38:08.946+0000","updated":"2017-05-17T01:38:08.946+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13071686/comment/16013363","id":"16013363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"body":"The exception is handled, close it as invalid.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huaxiang","name":"huaxiang","key":"huaxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"huaxiang sun","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-17T01:38:42.695+0000","updated":"2017-05-17T01:38:42.695+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11819/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3exan:"}}