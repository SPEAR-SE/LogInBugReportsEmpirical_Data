{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12956024","self":"https://issues.apache.org/jira/rest/api/2/issue/12956024","key":"HDFS-10257","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2016-04-05T03:56:31.986+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon May 16 20:42:40 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_52059986_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-04-05T17:39:07.290+0000","workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-10257/watchers","watchCount":3,"isWatching":false},"created":"2016-04-05T03:11:27.351+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":259200,"aggregatetimeoriginalestimate":259200,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334241","id":"12334241","description":"2.6.4 release","name":"2.6.4","archived":false,"released":true,"releaseDate":"2016-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-05-16T20:42:40.770+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313126","id":"12313126","name":"libhdfs","description":"The C++ interface to HDFS."}],"timeoriginalestimate":259200,"description":"In   jni_helper.c   in the   getJNIEnv    function \n\nThe     “THREAD_LOCAL_STORAGE_SET_QUICK(env);”   Macro   is   in the  wrong location;   \n\nIt should precede   the  “threadLocalStorageSet(env)”   as follows ::  \n\n    THREAD_LOCAL_STORAGE_SET_QUICK(env);\n\n    if (threadLocalStorageSet(env)) {\n      return NULL;\n    }\n\nAND IN   “thread_local_storage.h”   the macro:   “THREAD_LOCAL_STORAGE_SET_QUICK”\nshould be as follows :: \n\n#ifdef HAVE_BETTER_TLS\n  #define THREAD_LOCAL_STORAGE_GET_QUICK() \\\n    static __thread JNIEnv *quickTlsEnv = NULL; \\\n    { \\\n      if (quickTlsEnv) { \\\n        return quickTlsEnv; \\\n      } \\\n    }\n\n  #define THREAD_LOCAL_STORAGE_SET_QUICK(env) \\\n    { \\\n      quickTlsEnv = (env); \\\n      return env;\n    }\n#else\n  #define THREAD_LOCAL_STORAGE_GET_QUICK()\n  #define THREAD_LOCAL_STORAGE_SET_QUICK(env)\n#endif\n\n\n","customfield_10010":null,"timetracking":{"originalEstimate":"72h","remainingEstimate":"72h","originalEstimateSeconds":259200,"remainingEstimateSeconds":259200},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":259200,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Quick Thread Local Storage set-up has a small flaw","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":259200,"percent":0},"customfield_12311024":null,"environment":"Linux ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":259200,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15225641","id":"15225641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"body":"Can you explain why you think this is a flaw?  If the {{threadLocalStorageSet}} function fails, I don't think we want the data lingering in the other TLS location.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-05T03:56:31.986+0000","updated":"2016-04-05T03:56:31.986+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15225659","id":"15225659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for your quick reply :)\n\nThe problem is  \"threadLocalStorageSet\"  should not be executed  when someone wants to use  \"HAVE_BETTER_TLS\"    \n\nThe changes  I recommended would fix this \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-05T04:18:40.616+0000","updated":"2016-04-05T04:18:40.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15225669","id":"15225669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"body":"When someone wants to use   \"HAVE_BETTER_TLS\"   (quick thread local storage)\n\nThe code should  not execute \"\"threadLocalStorageSet\"   because it is not needed and not required.   \n\nThe changes I recommended would fix this \n\nFirst the  MACRO  \"THREAD_LOCAL_STORAGE_SET_QUICK\"  should be changed \n\nso that after  \n\n   quickTlsEnv = (env);   is set   \n\nThen  we should   \n\n   return env;\n\nSecondly   \n\nthe order for invoking the MACRO should be changed \n\nTHREAD_LOCAL_STORAGE_SET_QUICK(env);\n\nif (threadLocalStorageSet(env)) \n{ return NULL; } \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-05T04:28:22.997+0000","updated":"2016-04-05T04:28:22.997+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15226681","id":"15226681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"I disagree with the proposed change.\n\nEven when we use {{__thread}} to avoid mutex contention, we still have a reliance on the pthreads destructor function to detach the thread from the JVM.  This happens in os/posix/thread_local_storage.c.  According to the documentation of [{{pthread_key_create}}|http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_key_create.html], the destructor function is only called if there is a non-null value associated with the TLS key.\n\nbq. At thread exit, if a key value has a non-NULL destructor pointer, and the thread has a non-NULL value associated with that key, the value of the key is set to NULL, and then the function pointed to is called with the previously associated value as its sole argument.\n\nTherefore, we still need to call {{threadLocalStorageSet}} to make sure a value is associated with the key and it can be accessed by the thread destructor.\n\nPlease let me know if I missed something or perhaps misunderstood some subtlety of pthreads.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-05T17:11:37.911+0000","updated":"2016-04-05T17:11:37.911+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15226718","id":"15226718","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Chris;   \n\nYou are correct; I forgot about the thread attach/detach requirements \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-05T17:31:40.636+0000","updated":"2016-04-05T17:31:40.636+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15226731","id":"15226731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"Great, thanks for confirming [~stevebovy].  I'll go ahead and close this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-05T17:39:07.322+0000","updated":"2016-04-05T17:39:07.322+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15232916","id":"15232916","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for following up, guys.  I agree that we need the pthread destructor in order to avoid leaking memory.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-08T20:59:13.719+0000","updated":"2016-04-08T20:59:23.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15232929","id":"15232929","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"body":"Yes, it shames me that I forgot about this.     \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-08T21:08:40.615+0000","updated":"2016-04-08T21:08:40.615+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15233213","id":"15233213","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"body":"No need to be ashamed!  It's good to have more people looking at the code and getting more familiar with it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-09T00:31:36.475+0000","updated":"2016-04-09T00:31:36.475+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15285003","id":"15285003","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"body":" \n\nSo I tried using   >>     cmake    .    <<<<<\n\n \n\nAnd I got  >>  You must set the CMake variable GENERATED_JAVAH\n\n \n\nSo how to is use cmake on a stand-alone basis   (without maven)  to build libhdfs \n\n \n\nI guess I need a shell  script for set-up purposes ???   What do I need to set   ??    \n\n \n\nIt should not be that difficult \n\n \n\n \n\n[root@sandbox src]# cmake .\n\n-- The C compiler identification is GNU 4.4.7\n\n-- The CXX compiler identification is GNU 4.4.7\n\n-- Check for working C compiler: /usr/bin/cc\n\n-- Check for working C compiler: /usr/bin/cc -- works\n\n-- Detecting C compiler ABI info\n\n-- Detecting C compiler ABI info - done\n\n-- Check for working CXX compiler: /usr/bin/c++\n\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n\n-- Detecting CXX compiler ABI info\n\n-- Detecting CXX compiler ABI info - done\n\nJAVA_HOME=, JAVA_JVM_LIBRARY=/usr/lib/jvm/java/jre/lib/amd64/server/libjvm.so\n\nJAVA_INCLUDE_PATH=/usr/lib/jvm/java/include, JAVA_INCLUDE_PATH2=/usr/lib/jvm/java/include/linux\n\nLocated all JNI components successfully.\n\n-- Performing Test HAVE_BETTER_TLS\n\n-- Performing Test HAVE_BETTER_TLS - Success\n\n-- Performing Test HAVE_INTEL_SSE_INTRINSICS\n\n-- Performing Test HAVE_INTEL_SSE_INTRINSICS - Success\n\n-- Looking for dlopen in dl\n\n-- Looking for dlopen in dl - found\n\n-- Found JNI: /usr/lib/jvm/java/jre/lib/amd64/libjawt.so  \n\n \n\nCMake Error at CMakeLists.txt:84 (MESSAGE):\n\n  You must set the CMake variable GENERATED_JAVAH\n\n \n\n \n\n \n\n-- Configuring incomplete, errors occurred!\n\nSee also \"/root/hadoop-2.7.2-src/hadoop-hdfs-project/hadoop-hdfs/src/CMakeFiles/CMakeOutput.log\".\n\n[root@sandbox src]#\n\n \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-16T18:25:40.630+0000","updated":"2016-05-16T18:25:40.630+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12956024/comment/15285256","id":"15285256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Chris;\n\nI got the build to work by disabling the error message for   :  GENERATED_JAVAH\nAnd commenting out its usage\n\nfind_package(JNI REQUIRED)\nif (NOT GENERATED_JAVAH)\n    # Must identify where the generated headers have been placed\n    #MESSAGE(FATAL_ERROR \"You must set the CMake variable GENERATED_JAVAH\")\nendif (NOT GENERATED_JAVAH)\n\ninclude_directories(\n    #${GENERATED_JAVAH}\n    ${CMAKE_CURRENT_SOURCE_DIR}\n    ${CMAKE_BINARY_DIR}\n    ${JNI_INCLUDE_DIRS}\n    main/native\n    main/native/libhdfs\n    ${OS_DIR}\n)\n\nI would like to find out what this variable is for?\nIs this something that has to be pre-defined  OR  is it something that is supposed to be created by the build process?  \n\n\nFrom: Steve and Grace Bovy [mailto:sg.bovy@ca.rr.com] \nSent: Monday, May 16, 2016 11:24 AM\nTo: 'Chris Nauroth (JIRA)' <jira@apache.org>\nSubject: RE: [jira] [Commented] (HDFS-10257) Quick Thread Local Storage set-up has a small flaw\n\n\nSo I tried using   >>     cmake    .    <<<<<\n\nAnd I got  >>  You must set the CMake variable GENERATED_JAVAH\n\nSo how to is use cmake on a stand-alone basis   (without maven)  to build libhdfs \n\nI guess I need a shell  script for set-up purposes ???   What do I need to set   ??    \n\nIt should not be that difficult \n\n\n[root@sandbox src]# cmake .\n-- The C compiler identification is GNU 4.4.7\n-- The CXX compiler identification is GNU 4.4.7\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\nJAVA_HOME=, JAVA_JVM_LIBRARY=/usr/lib/jvm/java/jre/lib/amd64/server/libjvm.so\nJAVA_INCLUDE_PATH=/usr/lib/jvm/java/include, JAVA_INCLUDE_PATH2=/usr/lib/jvm/java/include/linux\nLocated all JNI components successfully.\n-- Performing Test HAVE_BETTER_TLS\n-- Performing Test HAVE_BETTER_TLS - Success\n-- Performing Test HAVE_INTEL_SSE_INTRINSICS\n-- Performing Test HAVE_INTEL_SSE_INTRINSICS - Success\n-- Looking for dlopen in dl\n-- Looking for dlopen in dl - found\n-- Found JNI: /usr/lib/jvm/java/jre/lib/amd64/libjawt.so  \n\nCMake Error at CMakeLists.txt:84 (MESSAGE):\n  You must set the CMake variable GENERATED_JAVAH\n\n\n\n-- Configuring incomplete, errors occurred!\nSee also \"/root/hadoop-2.7.2-src/hadoop-hdfs-project/hadoop-hdfs/src/CMakeFiles/CMakeOutput.log\".\n[root@sandbox src]#\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevebovy","name":"stevebovy","key":"stevebovy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Bovy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-16T20:42:40.638+0000","updated":"2016-05-16T20:42:40.638+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-10257/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2vn2f:"}}