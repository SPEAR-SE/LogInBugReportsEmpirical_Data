{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12602237","self":"https://issues.apache.org/jira/rest/api/2/issue/12602237","key":"HDFS-3772","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-08-08T14:24:33.864+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 15 17:24:35 UTC 2012","customfield_12310420":"257237","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-3772/watchers","watchCount":11,"isWatching":false},"created":"2012-08-08T13:43:11.939+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12320353","id":"12320353","description":"hadoop-2.0.0-alpha release","name":"2.0.0-alpha","archived":false,"released":true,"releaseDate":"2012-05-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-08-15T17:24:35.813+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312926","id":"12312926","name":"namenode"}],"timeoriginalestimate":null,"description":"If the NN restarts with a new minimum replication (dfs.namenode.replication.min), any files created with the old replication count will expected to bump up to the new minimum upon restart automatically. However, the real case is that if the NN restarts will a new minimum replication which is bigger than the old one, the NN will hang in safemode and never come out.\nThe corresponding test case can pass is because we have missing some test coverage. It had been discussed in HDFS-3734.\nIf the NN received enough number of reported block which is satisfying the new minimum replication, it will exit safe mode. However, if we change a bigger minimum replication, there will be no enough amount blocks which are satisfying the limitation.\nLook at the code segment in FSNamesystem.java:\nprivate synchronized void incrementSafeBlockCount(short replication) {\n      if (replication == safeReplication) {\n        this.blockSafe++;\n        checkMode();\n      }\n    }\nThe DNs report blocks to NN and if the replication is equal to safeReplication(It is assigned by the new minimum replication.), we will increment blockSafe. But if we change a bigger minimum replication, all the blocks whose replications are lower than it can not satisfy this equal relationship. But actually the NN had received complete block information. It cause blockSafe will not increment as usual and not reach the enough amount to exit safe mode and then NN hangs.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"114301","customfield_12312823":null,"summary":"HDFS NN will hang in safe mode and never come out if we change the dfs.namenode.replication.min bigger.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13431115","id":"13431115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"body":"After survey the source code, I found that after modifying the minimum replication, the HDFS persistent storage has no information about the former minimum replication. So we can not get the it after restart. So we need to think out of box.\nI have found the blockThreshold(dfs.namenode.safemode.threshold-pct) specifies the percentage of blocks that should satisfy the minimal replication requirement defined by dfs.namenode.replication.min. I think we can change the sementics of this parameter to the percentage of blocks that satisfy the real replication of each file. And then we compare the NN received replication with the real replication of each file. If they are equal, we increment blockSafe.\nAnyone who have some opinions? If this scenario is ok, I will fix it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-08-08T13:48:44.694+0000","updated":"2012-08-08T13:48:44.694+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13431131","id":"13431131","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"yes, we will not persist min replication parameter and also this is not a per file config item. It will be common in cluster for all files.\n\n{quote}\nAnd then we compare the NN received replication with the real replication of each file. If they are equal, we increment blockSafe.\n{quote}\nClient's write will succeed if it meets min replication. ( So, it is possible that replication might not met the replication factor for that file yet). At that moment, if cluster restarts , this check may not allow NN to come out of safemode right? because real replication and file replication is not equal yet.\n\nI am not sure we have scenarios to increasing the min-replication factor. Because that will be safe replication count. And we have actual replication count separately which will be modified by users.\n\nWhy can't you come out of safe mode explicitely by giving admin command and let replication happen. After this, restarts will not have issue.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-08T14:24:33.864+0000","updated":"2012-08-08T14:24:33.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13431637","id":"13431637","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"body":"{quote}\nClient's write will succeed if it meets min replication. ( So, it is possible that replication might not met the replication factor for that file yet).\n{quote}\nIndeedï¼Œthe min replication is used as this.\nI also suspect whether we need to restart cluster with a bigger minimum replication. But the parameter in hdfs-site.xml is not limited to only smaller. Whether we need to add this limitation in the parameter description? \n{quote}\nWhy can't you come out of safe mode explicitely by giving admin command and let replication happen. After this, restarts will not have issue.\n{quote}\nIt can resolve this problem when we know the hang is blocked by this issue clearly. But if the cluster just hang in safe mode and users can not judge whether is blocked by this issue. It's dangerous to exit safe mode explicitly and may cause HDFS metadata corruption. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-08-09T07:34:01.728+0000","updated":"2012-08-09T07:34:01.728+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13431674","id":"13431674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"{quote}\nIt can resolve this problem when we know the hang is blocked by this issue clearly. But if the cluster just hang in safe mode and users can not judge whether is blocked by this issue.\n{quote}\nBut admin only modified this min replication property. In this case, deffinitely it will hang right. It should be clear for the admins I feel, when they modify it.\n\npersisting this parameter at file level will be really unnecessary and this parameter is common for all. \n\nSo, the other option would be to persist this parameter in Image along with the LAYOUT_VERSION..etc. We can bump the leyout version number and while loading image, if the version number is this new version number, then read that min replication from image file and use for the safemode validations.\n\nBut I am not sure about the case, whether we need this really or not.\nSo, Before moving let's take others opinion as well.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-09T08:37:01.924+0000","updated":"2012-08-09T08:37:01.924+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13431678","id":"13431678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"body":"{quote}\nSo, the other option would be to persist this parameter in Image along with the LAYOUT_VERSION..etc. We can bump the leyout version number and while loading image, if the version number is this new version number, then read that min replication from image file and use for the safemode validations.\n{quote}\nAgree with this solution and waiting for others opinion!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-08-09T08:44:12.523+0000","updated":"2012-08-09T08:44:12.523+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13434293","id":"13434293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"I was writing this when Jira went down. Will try to reproduce that comment.\n\n> files created with the old replication count will expected to bump up to the new minimum upon restart automatically\n\nThis is not an expected behavior.\n{{dfs.namenode.replication.min}} has two purposes:\n# Counting the blocks satisfying the new minimum replication during startup.\n# Controls the minimal number of replicas that must be created during pipeline in order to call the data transfer successful.\n\nSetting {{replication.min}} to higher value does not mean NN replicates blocks to that min. \nIt means NN will wait for that many replicas to be reported during startup before exiting SafeMode.\nIf you set it too high, this is one of the ways to never let NN go out of SafeMode automatically.\n\nSafeMode prohibits replication or deletion of blocks or modification of the namespace,\nso block replication will not happen until NN leaves SafeMode.\nIf you are trying to increase block replication for all files in your file system you should use\n{{setReplication()}} on the root recursively. But replication will start only after SafeMode is OFF.\n\n> I think we can change the semantics of this parameter to the percentage of blocks that satisfy the real replication of each file.\n\nNot a good idea. In general, changing semantics of existing parameters is confusing. \nAnd in particular, because this will make NN stay in SafeMode forever if some DataNodes don't come up.\n\nI think the question here is what you are trying to achieve with this? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-14T17:40:54.447+0000","updated":"2012-08-14T17:40:54.447+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13434859","id":"13434859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"body":"Change semantics of the existing parameter or persistent the replication.min parameter to disk, we can choose one from the two alternatives.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-08-15T07:29:27.508+0000","updated":"2012-08-15T07:29:27.508+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13434913","id":"13434913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"What problem are you solving?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-15T09:46:33.541+0000","updated":"2012-08-15T09:46:33.541+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13434915","id":"13434915","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"body":"the hang in safe mode.\nwe have the two alternative solution you can reference the above comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yanboliang","name":"yanboliang","key":"yanboliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanbo Liang","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-08-15T09:49:13.962+0000","updated":"2012-08-15T09:49:13.962+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13435307","id":"13435307","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"It is not the hang. It works as designed. You increase {{replication.min}} and SafeMode waits for replicas to reach that safe replication limit.\nYou seem to assume that bumping up {{replication.min}} will result in more replicas, but it is not the case. You can use setReplication() for that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-15T17:12:05.693+0000","updated":"2012-08-15T17:12:05.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12602237/comment/13435321","id":"13435321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"And you can use \n{code}hadoop dfsadmin -safemode leave{code}\ncommand to manually exit safemode whenever it \"hangs\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-15T17:24:35.810+0000","updated":"2012-08-15T17:24:35.810+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-3772/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0jx5j:"}}