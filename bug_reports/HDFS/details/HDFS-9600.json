{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12924254","self":"https://issues.apache.org/jira/rest/api/2/issue/12924254","key":"HDFS-9600","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329057","id":"12329057","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12333995","id":"12333995","description":"2.7.3 release","name":"2.7.3","archived":false,"released":true,"releaseDate":"2016-08-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12334241","id":"12334241","description":"2.6.4 release","name":"2.6.4","archived":false,"released":true,"releaseDate":"2016-02-11"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335732","id":"12335732","description":"3.0.0-alpha1 release","name":"3.0.0-alpha1","archived":false,"released":true,"releaseDate":"2016-09-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-12-25T10:13:39.169+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Aug 25 23:00:57 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_695940_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_1120852598","customfield_12312321":null,"resolutiondate":"2016-01-07T06:30:36.530+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-9600/watchers","watchCount":13,"isWatching":false},"created":"2015-12-25T06:58:08.036+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"7.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12480201","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12480201","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13000562","key":"HDFS-10810","self":"https://issues.apache.org/jira/rest/api/2/issue/13000562","fields":{"summary":" Setreplication removing block from underconstrcution temporarily when batch IBR is enabled.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12452813","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12452813","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12923424","key":"HDFS-9586","self":"https://issues.apache.org/jira/rest/api/2/issue/12923424","fields":{"summary":"listCorruptFileBlocks should not output files that all replications are decommissioning","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-09-13T21:08:27.362+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"When appending a file, we will update pipeline to bump a new GS and the old GS will be considered as out of date. When changing GS, in BlockInfo.setGenerationStampAndVerifyReplicas we will remove replicas having old GS which means we will remove all replicas because no DN has new GS until the block with new GS is added to blockMaps again by DatanodeProtocol.blockReceivedAndDeleted.\n\nIf we check replication of this block before it is added back, it will be regarded as missing. The probability is low but if there are decommissioning nodes the DecommissionManager.Monitor will scan all blocks belongs to decommissioning nodes with a very fast speed so the probability of finding missing block is very high but actually they are not missing. \n\nFurthermore, after closing the appended file, in FSNamesystem.finalizeINodeFileUnderConstruction, it will checkReplication. If some of nodes are decommissioning, this block with new GS will be added to UnderReplicatedBlocks map so there are two blocks with same ID in this map, one is in QUEUE_WITH_CORRUPT_BLOCKS and the other is in QUEUE_HIGHEST_PRIORITY or QUEUE_UNDER_REPLICATED. And there will be many missing blocks warning in NameNode website but there is no corrupt files...\n\nTherefore, I think the solution is we should not check replication if the block is under construction. We only check complete blocks.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329057","id":"12329057","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12333995","id":"12333995","description":"2.7.3 release","name":"2.7.3","archived":false,"released":true,"releaseDate":"2016-08-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12334241","id":"12334241","description":"2.6.4 release","name":"2.6.4","archived":false,"released":true,"releaseDate":"2016-02-11"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779934","id":"12779934","filename":"HDFS-9600-branch-2.6.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T09:11:17.640+0000","size":6545,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779934/HDFS-9600-branch-2.6.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779933","id":"12779933","filename":"HDFS-9600-branch-2.7.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T09:11:17.637+0000","size":6968,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779933/HDFS-9600-branch-2.7.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779932","id":"12779932","filename":"HDFS-9600-branch-2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T09:11:17.633+0000","size":6889,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779932/HDFS-9600-branch-2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779493","id":"12779493","filename":"HDFS-9600-v1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-25T07:09:20.863+0000","size":957,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779493/HDFS-9600-v1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779638","id":"12779638","filename":"HDFS-9600-v2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-28T11:09:49.547+0000","size":5585,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779638/HDFS-9600-v2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779756","id":"12779756","filename":"HDFS-9600-v3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-29T05:33:16.695+0000","size":6693,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779756/HDFS-9600-v3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12779897","id":"12779897","filename":"HDFS-9600-v4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T03:42:37.569+0000","size":6751,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12779897/HDFS-9600-v4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"do not check replication if the block is under construction","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15071487","id":"15071487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red} 0m 0s {color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 7m 51s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 41s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 39s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 16s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 53s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 54s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 7s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 48s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 51s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 41s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 41s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 42s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 42s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 15s {color} | {color:red} Patch generated 1 new checkstyle issues in hadoop-hdfs-project/hadoop-hdfs (total was 161, now 162). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 54s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 0s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 5s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 50s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 73m 55s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 73m 42s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 28s {color} | {color:green} Patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 174m 43s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.server.blockmanagement.TestReplicationPolicyConsiderLoad |\n|   | hadoop.hdfs.server.blockmanagement.TestBlockTokenWithDFSStriped |\n|   | hadoop.hdfs.TestRollingUpgrade |\n|   | hadoop.hdfs.server.balancer.TestBalancerWithMultipleNameNodes |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n|   | hadoop.hdfs.server.namenode.snapshot.TestOpenFilesWithSnapshot |\n| JDK v1.7.0_91 Failed junit tests | hadoop.hdfs.server.blockmanagement.TestReplicationPolicyConsiderLoad |\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12779493/HDFS-9600-v1.patch |\n| JIRA Issue | HDFS-9600 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 23b5d771b649 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 6553784 |\n| Default Java | 1.7.0_91 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13995/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13995/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13995/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13995/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13995/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13995/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Max memory used | 76MB |\n| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13995/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-25T10:13:39.169+0000","updated":"2015-12-25T10:13:39.169+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15071494","id":"15071494","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"The unit tests failed, but it seems that it is not caused by my patch, right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-25T10:29:22.738+0000","updated":"2015-12-25T10:29:22.738+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15071592","id":"15071592","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"I find the reason of test case breaking  and open a new issue to fix it on HDFS-9602","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-25T12:20:23.647+0000","updated":"2015-12-25T12:20:23.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15072637","id":"15072637","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Upload v2 patch which adds a testcase to reproduce this bug","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-28T11:09:49.551+0000","updated":"2015-12-28T11:09:49.551+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15072685","id":"15072685","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for filing this bug and providing a patch.  You are right that we should not check replication if the block is under construction.  Good catch!\n\nFor the patch, I think it should check if getUnderConstructionFeature() == null instead of isComplete().  Do you agree?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-28T12:40:53.480+0000","updated":"2015-12-28T12:40:53.480+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15072703","id":"15072703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi,\nThanks for your reply. I'm not sure what is the difference between getUnderConstructionFeature() == null and isComplete(), I thought they equals each other so I use the simpler one. Is there any chance that isComplete()==false but we still check the replication or isComplete()==true but we should not check replication? Please correct me if I am wrong :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-28T13:01:12.643+0000","updated":"2015-12-28T13:01:12.643+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15072713","id":"15072713","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"Indeed, two conditions are the same.\n\n+1 on the current patch.  Will wait for the Jenkins report before committing the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-28T13:22:02.586+0000","updated":"2015-12-28T13:22:02.586+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15072731","id":"15072731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks!\nI find that branch-2.6 and branch-2.7 have a different interface on isNeededReplication, I'm not familiar with the process of contribution, should I submit another patch for 2.6/2.7 ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-28T13:49:32.639+0000","updated":"2015-12-28T13:49:32.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15072732","id":"15072732","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 7m 37s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 53s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 44s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 16s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 57s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 55s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 8s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 54s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 50s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 52s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 52s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 43s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 43s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 15s {color} | {color:red} Patch generated 1 new checkstyle issues in hadoop-hdfs-project/hadoop-hdfs (total was 161, now 162). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 52s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 11s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 0s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 3s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 42s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 63m 41s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 61m 31s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 21s {color} | {color:green} Patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 152m 41s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n| JDK v1.7.0_91 Failed junit tests | hadoop.hdfs.TestRollingUpgrade |\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12779638/HDFS-9600-v2.patch |\n| JIRA Issue | HDFS-9600 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 1d8bb4671749 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / a0249da |\n| Default Java | 1.7.0_91 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/13999/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13999/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/13999/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/13999/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/13999/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/13999/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Max memory used | 76MB |\n| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/13999/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-28T13:51:23.234+0000","updated":"2015-12-28T13:51:23.234+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15073501","id":"15073501","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"testDecommissionStatus failed, upload v3 patch to pass it.\nIn DecommissionManager.isSufficient, it skips blocks which do not need  replication and will remove the block from watching list. Now we can not skip by isNeededReplication.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-29T05:13:46.308+0000","updated":"2015-12-29T05:13:46.308+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15073609","id":"15073609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 7m 24s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 39s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 40s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 18s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 51s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 14s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 53s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 7s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 49s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 45s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 39s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 39s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 38s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 38s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 17s {color} | {color:red} Patch generated 2 new checkstyle issues in hadoop-hdfs-project/hadoop-hdfs (total was 164, now 166). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 49s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 11s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 1s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 4s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 47s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 54m 11s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 54m 22s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 24s {color} | {color:green} Patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 134m 42s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.server.namenode.ha.TestSeveralNameNodes |\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyCheckpoints |\n|   | hadoop.hdfs.server.datanode.TestBlockScanner |\n| JDK v1.7.0_91 Failed junit tests | hadoop.hdfs.TestWriteReadStripedFile |\n|   | hadoop.hdfs.server.namenode.TestNameNodeMXBean |\n|   | hadoop.hdfs.TestHDFSFileSystemContract |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12779756/HDFS-9600-v3.patch |\n| JIRA Issue | HDFS-9600 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 625db7d39dcd 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / d0a22ba |\n| Default Java | 1.7.0_91 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/14004/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14004/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14004/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/14004/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/14004/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/14004/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Max memory used | 76MB |\n| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/14004/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-29T07:53:07.070+0000","updated":"2015-12-29T07:53:07.070+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15073618","id":"15073618","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"I run tests that failed in the latest Jenkins report, they all pass on my own computer, I think they are unrelated with my patch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-29T08:05:01.952+0000","updated":"2015-12-29T08:05:01.952+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15073824","id":"15073824","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the great find and patch [~yangzhe1991]. \n\nMeanwhile, could you fix checkstyle warnings too? both are line length > 80. \n\n+1 once addressed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-29T11:42:24.387+0000","updated":"2015-12-29T11:42:24.387+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074341","id":"15074341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuml07","name":"liuml07","key":"liuml07","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liuml07&avatarId=29203","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liuml07&avatarId=29203","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liuml07&avatarId=29203","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liuml07&avatarId=29203"},"displayName":"Mingliang Liu","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~yangzhe1991] for reporting this. The fix looks good to me.\n\nNit for test: Should we call {{cluster.waitActive();}} before operating the mini cluster?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuml07","name":"liuml07","key":"liuml07","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liuml07&avatarId=29203","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liuml07&avatarId=29203","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liuml07&avatarId=29203","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liuml07&avatarId=29203"},"displayName":"Mingliang Liu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-29T21:53:55.781+0000","updated":"2015-12-29T21:53:55.781+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074602","id":"15074602","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"upload v4 patch to remove checkstyle warnings and add cluster.waitActive().\n\nDo I need make another patch for 2.6/2.7? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T03:42:37.573+0000","updated":"2015-12-30T03:42:37.573+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074665","id":"15074665","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 8m 22s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 5s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 52s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 22s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 6s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 17s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 10s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 21s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 2m 10s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 58s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 1m 4s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 1m 4s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 50s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 50s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 21s {color} | {color:red} Patch generated 1 new checkstyle issues in hadoop-hdfs-project/hadoop-hdfs (total was 164, now 164). {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 59s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 12s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 12s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 6s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 46s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 59m 28s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 55m 34s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 26s {color} | {color:green} Patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 145m 28s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_66 Failed junit tests | hadoop.hdfs.server.datanode.TestDataNodeMetrics |\n|   | hadoop.hdfs.server.blockmanagement.TestComputeInvalidateWork |\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\n|   | hadoop.hdfs.server.datanode.TestBlockScanner |\n|   | hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\n|   | hadoop.hdfs.server.namenode.TestNameNodeRecovery |\n| JDK v1.8.0_66 Timed out junit tests | org.apache.hadoop.hdfs.TestDatanodeRegistration |\n| JDK v1.7.0_91 Failed junit tests | hadoop.hdfs.TestDFSUpgradeFromImage |\n|   | hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits |\n|   | hadoop.hdfs.TestRenameWhileOpen |\n|   | hadoop.hdfs.TestRollingUpgrade |\n|   | hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\n|   | hadoop.hdfs.TestFileCorruption |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12779897/HDFS-9600-v4.patch |\n| JIRA Issue | HDFS-9600 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux b16fb8275d6a 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / ad997fa |\n| Default Java | 1.7.0_91 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/14008/artifact/patchprocess/diff-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14008/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14008/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-HDFS-Build/14008/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt https://builds.apache.org/job/PreCommit-HDFS-Build/14008/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/14008/testReport/ |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Max memory used | 76MB |\n| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/14008/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-30T06:14:06.192+0000","updated":"2015-12-30T06:14:06.192+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074696","id":"15074696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Latest patch looks good. +1.\n\nI tried committing, but patch doesnt apply cleanly to branch-2 as well.\n\nbq. Do I need make another patch for 2.6/2.7? Thanks.\nYou need to create branch-2 and 2.7/2.6 patches as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-30T06:50:24.504+0000","updated":"2015-12-30T06:50:24.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074817","id":"15074817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"upload patches for branch-2, branch-2.7 and branch 2.6.\n\nIn branch-2, the LocatedBlock returned by namenode.updateBlockForPipeline has no StorageIDs in it so I use the old StorageIDs in testcase.\n\nIn branch-2.7, the parameter of isNeededReplication is Block, so we need get BlockInfoContiguous first for isComplete().\n\nIn branch-2.6, we use BlockInfo just like 2.7's BlockInfoContiguous. And BlockManager.isNeededReplication is private that is not visible for testcase. So I change it to package visibility by removing private keyword.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T09:11:17.644+0000","updated":"2015-12-30T09:11:17.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074893","id":"15074893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 10m 32s {color} | {color:green} branch-2.6 passed {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 42s {color} | {color:red} hadoop-hdfs in branch-2.6 failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 44s {color} | {color:red} hadoop-hdfs in branch-2.6 failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 21s {color} | {color:green} branch-2.6 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 57s {color} | {color:green} branch-2.6 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 20s {color} | {color:green} branch-2.6 passed {color} |\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red} 2m 54s {color} | {color:red} hadoop-hdfs-project/hadoop-hdfs in branch-2.6 has 272 extant Findbugs warnings. {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 11s {color} | {color:green} branch-2.6 passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 52s {color} | {color:green} branch-2.6 passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 53s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 39s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 0m 39s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 43s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 0m 43s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 17s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 54s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 1s {color} | {color:red} The patch has 2664 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 1m 10s {color} | {color:red} The patch has 95 line(s) with tabs. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 52s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 5s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 48s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 0m 41s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 0m 43s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 36s {color} | {color:red} Patch generated 73 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 47m 57s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:date2015-12-30 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12779934/HDFS-9600-branch-2.6.patch |\n| JIRA Issue | HDFS-9600 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux f985a816dd21 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.6 / 0f9dd48 |\n| Default Java | 1.7.0_91 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/branch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/branch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| findbugs | v1.3.9 |\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/branch-findbugs-hadoop-hdfs-project_hadoop-hdfs-warnings.html |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/whitespace-eol.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/whitespace-tabs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Max memory used | 71MB |\n| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/14011/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-30T10:06:23.638+0000","updated":"2015-12-30T10:06:23.638+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15074934","id":"15074934","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Why 2.6 patch failed on compiling... :( \nIt failed on native code?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-30T11:00:30.121+0000","updated":"2015-12-30T11:00:30.121+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15075079","id":"15075079","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 10m 28s {color} | {color:green} branch-2.6 passed {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 45s {color} | {color:red} hadoop-hdfs in branch-2.6 failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 45s {color} | {color:red} hadoop-hdfs in branch-2.6 failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 21s {color} | {color:green} branch-2.6 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 59s {color} | {color:green} branch-2.6 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 20s {color} | {color:green} branch-2.6 passed {color} |\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red} 2m 55s {color} | {color:red} hadoop-hdfs-project/hadoop-hdfs in branch-2.6 has 272 extant Findbugs warnings. {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 12s {color} | {color:green} branch-2.6 passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 53s {color} | {color:green} branch-2.6 passed with JDK v1.7.0_91 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 55s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 43s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 0m 43s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 42s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 0m 42s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 17s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 53s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 12s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 1s {color} | {color:red} The patch has 2997 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 1m 14s {color} | {color:red} The patch has 95 line(s) with tabs. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 3m 13s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 11s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 53s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 0m 48s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.8.0_66. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 0m 50s {color} | {color:red} hadoop-hdfs in the patch failed with JDK v1.7.0_91. {color} |\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red} 0m 37s {color} | {color:red} Patch generated 73 ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 48m 17s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:date2015-12-30 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12779934/HDFS-9600-branch-2.6.patch |\n| JIRA Issue | HDFS-9600 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 34689ff9cf1c 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.6 / 0f9dd48 |\n| Default Java | 1.7.0_91 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/branch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/branch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| findbugs | v1.3.9 |\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/branch-findbugs-hadoop-hdfs-project_hadoop-hdfs-warnings.html |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/whitespace-eol.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/whitespace-tabs.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.8.0_66.txt |\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-unit-hadoop-hdfs-project_hadoop-hdfs-jdk1.7.0_91.txt |\n| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/testReport/ |\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/artifact/patchprocess/patch-asflicense-problems.txt |\n| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\n| Max memory used | 70MB |\n| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/14013/console |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-30T14:52:12.709+0000","updated":"2015-12-30T14:52:12.709+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15075109","id":"15075109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. It failed on native code?\nI think, its the problem with docker image used to run branch-2.6\nIn Non-docker mode, its fine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-30T15:29:57.970+0000","updated":"2015-12-30T15:29:57.970+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15075782","id":"15075782","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Ok, what should I do now?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-12-31T06:33:30.519+0000","updated":"2015-12-31T06:33:30.519+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15081324","id":"15081324","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kihwal","name":"kihwal","key":"kihwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kihwal&avatarId=34594","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kihwal&avatarId=34594","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kihwal&avatarId=34594","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kihwal&avatarId=34594"},"displayName":"Kihwal Lee","active":true,"timeZone":"America/Chicago"},"body":"bq. I think, its the problem with docker image used to run branch-2.6. In Non-docker mode, its fine.\nThe native build fails when libwebhdfs in contrib is built. This is not the case if you simply do {{-Pnative}}. I think it is HDFS-8346.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kihwal","name":"kihwal","key":"kihwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kihwal&avatarId=34594","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kihwal&avatarId=34594","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kihwal&avatarId=34594","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kihwal&avatarId=34594"},"displayName":"Kihwal Lee","active":true,"timeZone":"America/Chicago"},"created":"2016-01-04T16:26:30.980+0000","updated":"2016-01-04T16:26:30.980+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15086858","id":"15086858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. The native build fails when libwebhdfs in contrib is built. This is not the case if you simply do -Pnative. I think it is HDFS-8346.\nMight be another reason for failure in branch-2.\nBut I have seen with both docker and non-docker mode in branch-2.6. It fails in branch-2.6 with docker mode because dev-support/DockerFile doesnot exist in branch-2.6.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-01-07T05:50:44.026+0000","updated":"2016-01-07T05:50:44.026+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15086911","id":"15086911","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Committed to trunk, branch-2, branch-2.7 and branch-2.6\n\nThanks all.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-01-07T06:29:52.895+0000","updated":"2016-01-07T06:29:52.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15086927","id":"15086927","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Merged to branch-2.8 as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-01-07T06:43:42.101+0000","updated":"2016-01-07T06:43:42.101+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15086928","id":"15086928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-trunk-Commit #9064 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/9064/])\nHDFS-9600. do not check replication if the block is under construction (vinayakumarb: rev 34cd7cd76505d01ec251e30837c94ab03319a0c1)\n* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java\n* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/blockmanagement/TestBlockManager.java\n* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/DecommissionManager.java\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-07T06:44:24.029+0000","updated":"2016-01-07T06:44:24.029+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15087292","id":"15087292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-01-07T12:29:13.021+0000","updated":"2016-01-07T12:29:13.021+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15135372","id":"15135372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yzhangal","name":"yzhangal","key":"yzhangal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yongjun Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"HI [~yangzhe1991], [~szetszwo] and [~vinayrpet],\n\nThanks for your earlier work here. I noticed that in branch-2.6 \n\n{code}\n  /**\n   * Return true if there are any blocks on this node that have not\n   * yet reached their replication factor. Otherwise returns false.\n   */\n  boolean isReplicationInProgress(DatanodeDescriptor srcNode) {\n    boolean status = false;\n    boolean firstReplicationLog = true;\n    int underReplicatedBlocks = 0;\n    int decommissionOnlyReplicas = 0;\n    int underReplicatedInOpenFiles = 0;\n    final Iterator<? extends Block> it = srcNode.getBlockIterator();\n    while(it.hasNext()) {\n      final Block block = it.next();\n      BlockCollection bc = blocksMap.getBlockCollection(block);\n\n      if (bc != null) {\n        NumberReplicas num = countNodes(block);\n        int curReplicas = num.liveReplicas();\n        int curExpectedReplicas = getReplication(block);\n\n        if (curReplicas < curExpectedReplicas\n            || !isPlacementPolicySatisfied(block)) {\n{code}\n\nAnd clause {{ blockInfo.isComplete()}} is added to the following method but not in the above method, Would any of you please explain why {{blockInfo.isComplete()}}  is not needed in the above code? Thanks a lot.\n\n{code}\n  boolean isNeededReplication(Block b, int expected, int current) {\n    BlockInfo blockInfo;\n    if (b instanceof BlockInfo) {\n      blockInfo = (BlockInfo) b;\n    } else {\n      blockInfo = getStoredBlock(b);\n    }\n    return blockInfo.isComplete()\n        && (current < expected || !isPlacementPolicySatisfied(b));\n  }\n{code}\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yzhangal","name":"yzhangal","key":"yzhangal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yongjun Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-06T00:56:20.978+0000","updated":"2016-02-06T00:56:20.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15135908","id":"15135908","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~yzhangal]\nBlockManager.isReplicationInProgress is used by DatanodeManager.checkDecommissionState, if all blocks hold by a decommissioning node are not \"isReplicationInProgress\", it will be set as decommissioned. If there is a block that is not complete, it will not be NeededReplication  but if it is not isReplicationInProgress, the datanode will be set as decommissioned and the block may be missed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yangzhe1991","name":"yangzhe1991","key":"yangzhe1991","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yangzhe1991&avatarId=22883","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yangzhe1991&avatarId=22883","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yangzhe1991&avatarId=22883","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yangzhe1991&avatarId=22883"},"displayName":"Phil Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-02-06T18:03:36.272+0000","updated":"2016-02-06T18:03:36.272+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15135936","id":"15135936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yzhangal","name":"yzhangal","key":"yzhangal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yongjun Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~yangzhe1991]!\n\nI studied the code further and have the following thoughts:\n\n{code}\n /**\n   * Return true if there are any blocks on this node that have not\n   * yet reached their replication factor. Otherwise returns false.\n   */\n  boolean isReplicationInProgress(DatanodeDescriptor srcNode) {\n{code}\nAs you said, this method is used by DatanodeManager.checkDecommissionState, if all blocks hold by a decommissioning node are not \"isReplicationInProgress\", then it will be set decommissioned. The current criteria is:\n{code}\n        if (curReplicas < curExpectedReplicas\n            || !isPlacementPolicySatisfied(block)) {\n{code}\nWe do not check whether the block is complete or not, because the most concern is whether we have enough replicas. However, I found couple of  things here:\n\n1. If the block is not complete, especially if the block is being written to right now, we seem to be able to still decommission this node (isReplicationInProgress returns false). That may be ok for replication factor bigger than 1 (let the remaining replicas to carry on the ongoing write), but if it's 1, then we would lost the replica, and the block. Isn't that a problem? \n\n2. If the block is complete, and the replication factor is 1, similarly, the isReplicationInProgress method will return false and we are still able to decommission the node. \n\nSo seems that we need to handle replication factor 1 with extra care. The solution would be to over-replicate first, then decommission the node. I am not sure whether the de-commissioner handles that.\n\nThoughts?\n\nThanks.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yzhangal","name":"yzhangal","key":"yzhangal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yongjun Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-06T18:38:13.042+0000","updated":"2016-02-06T18:38:13.042+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15136419","id":"15136419","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. 1. If the block is not complete, especially if the block is being written to right now, we seem to be able to still decommission this node (isReplicationInProgress returns false). That may be ok for replication factor bigger than 1 (let the remaining replicas to carry on the ongoing write), but if it's 1, then we would lost the replica, and the block. Isn't that a problem?\n\nFor open files, we only let it decom if the UC block stays above minReplication (default 1). Note the {{curReplicas > minReplication}} check.\n\nbq. 2. If the block is complete, and the replication factor is 1, similarly, the isReplicationInProgress method will return false and we are still able to decommission the node.\n\nNote that the {{liveReplicas}} from the {{countNodes}} function does not include decommissioning nodes. So for this case {{curReplicas}} will be 0, less than the {{curExpectedReplicas}} of 1. The way {{status}} is set is pretty confusing in this function.\n\nOne question I have is where we add blocks to {{neededReplications}} at the end of {{isReplicationInProgress}}. We should be checking that the block is complete here right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-07T20:25:25.031+0000","updated":"2016-02-07T20:25:25.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15136526","id":"15136526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yzhangal","name":"yzhangal","key":"yzhangal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yongjun Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for looking into and commenting Andrew!\n\nI agree that how the status is set is confusing here.\n\n{quote}\nFor open files, we only let it decom if the UC block stays above minReplication (default 1). Note the curReplicas > minReplication check.\n{quote}\n\nThe {{isReplicationInProgress}} method initialize {{status}} to false, for replicationFactor==1 case, the check {{curReplicas > minReplication}} will be false, thus the method will return false, and the node that contains the single replica will be marked as decommissioned, thus the block will be lost , unless we over replicate all replicas on the node before decommissioning for replicationFactor==1 case. Am I right? Did we do over-replicate before decommissioning?\n\n\nOne point in my earlier comment is, If a replica is currently being written to (under construction), in order for us to decommission this node, either 1, the client need to reconstruct the write pipeline without this node, or 2, we need to wait for the block to be complete, and satisfy the replication count before this node can be decommissioned. Since it may take long to finish writing a block, I think likely it's case 1. If we go with case 1, then for replicationFactor==1 case, the client need to rewrite all data of the same block to other node. I wonder if  this is the current behavior?\n\nHope other folks who are more familiar with the code can answer your question. It'd be nice to have some good document about the handling.\n\nThanks.\n\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yzhangal","name":"yzhangal","key":"yzhangal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yongjun Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-07T23:54:02.611+0000","updated":"2016-02-07T23:54:02.611+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924254/comment/15438039","id":"15438039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Closing the JIRA as part of 2.7.3 release.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-08-25T23:00:57.469+0000","updated":"2016-08-25T23:00:57.469+0000"}],"maxResults":35,"total":35,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-9600/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2qarz:"}}