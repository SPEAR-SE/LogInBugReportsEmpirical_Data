{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12457390","self":"https://issues.apache.org/jira/rest/api/2/issue/12457390","key":"HDFS-1001","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314241","id":"12314241","description":"","name":"0.22.0","archived":false,"released":true,"releaseDate":"2011-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315571","id":"12315571","description":"","name":"0.23.0","archived":false,"released":true,"releaseDate":"2011-11-11"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-02-25T08:27:25.554+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Nov 19 09:12:34 UTC 2010","customfield_12310420":"16589","customfield_12312320":null,"customfield_12310222":"10002_*:*_5_*:*_21360887445_*|*_1_*:*_5_*:*_1710812921_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2010-11-19T09:12:34.287+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-1001/watchers","watchCount":5,"isWatching":false},"created":"2010-02-25T08:24:13.921+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12330481","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12330481","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12455118","key":"HDFS-941","self":"https://issues.apache.org/jira/rest/api/2/issue/12455118","fields":{"summary":"Datanode xceiver protocol should allow reuse of a connection","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-11-19T09:12:34.252+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312927","id":"12312927","name":"datanode"}],"timeoriginalestimate":null,"description":"Running the TestPread with additional debug statements reveals that the BlockReader sends CHECKSUM_OK when the DataXceiver doesn't expect it. Currently it doesn't matter since DataXceiver closes the connection after each op, and CHECKSUM_OK is the last thing on the wire. But if we want to cache connections, they need to agree on the exchange of CHECKSUM_OK.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12437622","id":"12437622","filename":"HDFS-1001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T17:36:56.655+0000","size":9159,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12437622/HDFS-1001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12437640","id":"12437640","filename":"HDFS-1001.patch.1","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T21:00:58.346+0000","size":9216,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12437640/HDFS-1001.patch.1"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12440991","id":"12440991","filename":"HDFS-1001-2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-07T05:19:16.178+0000","size":17866,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12440991/HDFS-1001-2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12443214","id":"12443214","filename":"HDFS-1001-3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-29T18:38:56.359+0000","size":17882,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12443214/HDFS-1001-3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12443126","id":"12443126","filename":"HDFS-1001-3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-28T21:53:21.701+0000","size":17890,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12443126/HDFS-1001-3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12443323","id":"12443323","filename":"HDFS-1001-4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-30T20:58:36.091+0000","size":17903,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12443323/HDFS-1001-4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12459971","id":"12459971","filename":"HDFS-1001-5.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T05:08:02.564+0000","size":17641,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12459971/HDFS-1001-5.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12459984","id":"12459984","filename":"HDFS-1001-6.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T08:54:53.334+0000","size":17593,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12459984/HDFS-1001-6.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12438935","id":"12438935","filename":"HDFS-1001-rebased.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-16T16:29:45.163+0000","size":9216,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12438935/HDFS-1001-rebased.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"13610","customfield_12312823":null,"summary":"DataXceiver and BlockReader disagree on when to send/recv CHECKSUM_OK","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12838242","id":"12838242","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"This is a bug on the datanode side, right? The tests from HDFS-877 at least ensure that CHECKSUM_OK works properly where it's supposed to.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-02-25T08:27:25.554+0000","updated":"2010-02-25T08:27:25.554+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12839015","id":"12839015","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Yes, Todd. The client sends CHECKSUM_OK when it reads to the end of the data. The DN expects CHECKSUM_OK only when it sends the entire block.\n\nIt's my goal that either side can independently decide whether a CHECKSUM_OK is supposed to be present. (A good protocol should do that.) So I propose:\n1. The client keeps its current behaviour, sending CHECKSUM_OK when it reads to the end of the data.\n2. The DN, after sending all the data, always expects a CHECKSUM_OK. If it's not there, it will close the client connection.\n3. Point #2 does not matter currently, since the DN always closes the client connection. But HDFS-941 may change that.\n\nI can't think of a good way to write a test for this. Any suggestions please?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-02-26T21:08:21.735+0000","updated":"2010-02-26T21:08:21.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12839021","id":"12839021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Testing this is a bit difficult. I think the one _very_ important test is the negative test - ie that we don't end up calling datanode.blockScanner.verifiedByClient() for a partial read.\n\nI think you could add this as another test case in TestClientBlockVerification - just like testCompletePartialRead, except also replace the datanode.blockScanner with a spy and verify that verifiedByClient is *not* called for the partial read.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-02-26T21:21:37.821+0000","updated":"2010-02-26T21:21:37.821+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840048","id":"12840048","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"I have a patch. But I can't assign this issue to myself. Could someone please fix Jira to let me work on it? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T07:20:22.670+0000","updated":"2010-03-02T07:20:22.670+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840051","id":"12840051","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org\n  against trunk revision 916902.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/257/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-02T07:34:40.844+0000","updated":"2010-03-02T07:34:40.844+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840253","id":"12840253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Updated documentation on the semantics of CHECKSUM_OK. Code fixes and added a new test for negative block verification, as Todd suggested.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T17:36:56.708+0000","updated":"2010-03-02T17:36:56.708+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840292","id":"12840292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey bc,\nI think there may be a small error in the test. In testCompletePartialRead, you spy on the blockScanner, but don't assign the spy back into this.getDataNode() - thus the verifiedByClient call won't go through the spy object and the test will always pass (at least by my understanding of how mockito works). I think you need to do:\n\n{code}\nDataBlockScanner scanner = spy(this.getDataNode().blockScanner);\nthis.getDatanode().blockScanner = scanner;\n...\n{code}\n\nCan you verify that the test fails properly if the change to the code is reverted?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-03-02T19:20:08.490+0000","updated":"2010-03-02T19:20:08.490+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840314","id":"12840314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"> Can you verify that the test fails properly if the change to the code is reverted?\n\nThe test fails if I verify the opposite.\n\n{code}\nTestcase: testCompletePartialRead took 0.609 sec\n        Caused an ERROR\n\nWanted but not invoked:\ndataBlockScanner.verifiedByClient(\n    isA(org.apache.hadoop.hdfs.protocol.Block)\n);\n-> at org.apache.hadoop.hdfs.server.datanode.TestDataXceiver.testCompletePartialRead(TestDataXceiver.java:146)\nActually, there were zero interactions with this mock.\n\nWanted but not invoked:\ndataBlockScanner.verifiedByClient(\n    isA(org.apache.hadoop.hdfs.protocol.Block)\n);\n-> at org.apache.hadoop.hdfs.server.datanode.TestDataXceiver.testCompletePartialRead(TestDataXceiver.java:146)\nActually, there were zero interactions with this mock.\n\n        at org.apache.hadoop.hdfs.server.datanode.TestDataXceiver.testCompletePartialRead(TestDataXceiver.java:146)\n{code}\n\nAccording to Mockito documentation, they don't recommend operating on the spy object directly. Also see Q1 here:\n<http://mockito.googlecode.com/svn/branches/1.6/javadoc/org/mockito/Mockito.html>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T20:32:27.265+0000","updated":"2010-03-02T20:32:27.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840316","id":"12840316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"bq. The test fails if I verify the opposite.\n\nBut what if you verify what you're trying to test, and then revert the code so it breaks? I think the way you're using the spy right now will always think there are no interactions.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-03-02T20:39:11.592+0000","updated":"2010-03-02T20:39:11.592+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840321","id":"12840321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Ah, I misunderstood the documentation. You're right. Good catch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T21:00:58.393+0000","updated":"2010-03-02T21:00:58.393+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840331","id":"12840331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12437622/HDFS-1001.patch\n  against trunk revision 916902.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    -1 contrib tests.  The patch failed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/258/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/258/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/258/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/258/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-02T21:26:22.902+0000","updated":"2010-03-02T21:26:22.902+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12840342","id":"12840342","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Test failure (in TestSecurityTokenEditLog) seems to be HDFS-1015.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-02T21:50:09.514+0000","updated":"2010-03-02T21:50:09.514+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12846574","id":"12846574","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12438935/HDFS-1001-rebased.patch\n  against trunk revision 923467.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    -1 contrib tests.  The patch failed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/271/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/271/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/271/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/271/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-17T20:39:28.065+0000","updated":"2010-03-17T20:39:28.065+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12847052","id":"12847052","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"The body of patch looks good to me. But could we merge TestClientBlockVerification and the new TestDataXceiver? I recall you made the new test so you could be in the server.datanode package, but could the cases of TestClientBlockVerification move in here too? If not, maybe we can at least share a bit of the test code (most of the code except for the test case itself is duplicated)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-03-18T18:28:51.770+0000","updated":"2010-03-18T18:28:51.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12854351","id":"12854351","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Factored out common test code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-07T05:19:16.184+0000","updated":"2010-04-07T05:19:16.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12861955","id":"12861955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Rebased patch HDFS-1001-3.patch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-28T21:53:21.799+0000","updated":"2010-04-28T21:53:21.799+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12862335","id":"12862335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Ousp. Previous patch was in reverse direction.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-29T18:38:56.439+0000","updated":"2010-04-29T18:38:56.439+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12862370","id":"12862370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 Nice change. \n\nNits:\n* in DataNode  \"DataNode always expects\" should read \"always checks\" since the response is optional. \n* Would rename readCasually to something like readBytesCheckEOS\n* In DataXceiver \"from client\" should read \"from the client\" \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-29T19:40:45.281+0000","updated":"2010-04-29T19:40:45.281+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12862862","id":"12862862","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"New -4 patch per Eli's comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-04-30T20:58:36.187+0000","updated":"2010-04-30T20:58:36.187+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12865828","id":"12865828","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Note that this change does not increase the client read latency. The existing code is already sending CHECKSUM_OK even for partial block read. The fix codifies this behaviour and makes sure that the DN side *expects* this CHECKSUM_OK.\n\nAnother way to fix this bug is to make the client *not* send CHECKSUM_OK for partial block reads. However, that complicates the protocol and makes it unclean. The cost of sending the CHECKSUM_OK is small enough. It is one extra syscall. But it's not network latency since the client doesn't need a response.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bcwalrus","name":"bcwalrus","key":"bcwalrus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"bc Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-10T17:08:48.722+0000","updated":"2010-05-10T17:08:48.722+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12865936","id":"12865936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. Another way to fix this bug is to make the client not send CHECKSUM_OK for partial block reads. However, that complicates the protocol and makes it unclean. \n\nAgree the way you currently have it is better.  Latest patch looks good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-10T21:30:10.048+0000","updated":"2010-05-10T21:30:10.048+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12933681","id":"12933681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Patch attached rebased against trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T05:08:02.639+0000","updated":"2010-11-19T05:08:02.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12933727","id":"12933727","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Attached a patch fixes a warning in the last patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T08:54:53.375+0000","updated":"2010-11-19T08:54:53.375+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12933735","id":"12933735","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Unit test results look the same as trunk before the latest patch.\n \n{noformat}\n     [exec] \n     [exec] +1 overall.  \n     [exec] \n     [exec]     +1 @author.  The patch does not contain any @author tags.\n     [exec] \n     [exec]     +1 tests included.  The patch appears to include 9 new or modified tests.\n     [exec] \n     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.\n     [exec] \n     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n     [exec] \n     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n     [exec] \n     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n     [exec] \n     [exec]     +1 system test framework.  The patch passed system test framework compile.\n     [exec] \n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T09:08:04.993+0000","updated":"2010-11-19T09:08:04.993+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12457390/comment/12933740","id":"12933740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"I've committed this to trunk and branch 22.  Thanks bc!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T09:12:34.207+0000","updated":"2010-11-19T09:12:34.207+0000"}],"maxResults":25,"total":25,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-1001/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i02oqv:"}}