{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12930167","self":"https://issues.apache.org/jira/rest/api/2/issue/12930167","key":"HDFS-9650","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-05-23T07:34:07.977+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jun 15 05:35:08 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-9650/watchers","watchCount":6,"isWatching":false},"created":"2016-01-14T15:23:53.324+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyao","name":"xyao","key":"xyao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xiaoyu Yao","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-06-15T05:35:08.425+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Description;\nHadoop 2.7.1. 2 namenodes in HA. 14 Datanodes.\n\nEnough CPU,disk and RAM.\n\nJust discovered that some datanodes must have been corrupted somehow.\n\nWhen restarting  a 'defect' ( works without failure except when restarting) the active namenode suddenly is logging a lot of : \"Redundant addStoredBlock request received\"\nand finally the failover-controller takes the namenode down, fails over to other node. This node also starts logging the same, and as soon as the fisrt node is bac online, the failover-controller again kill the active node, and does failover.\nThis node now was started after the datanode, and doesn't log \"Redundant addStoredBlock request received\" anymore, and restart of the second name-node works fine.\nIf I again restarts the datanode- the process repeats itself.\n\nProblem is logging of \"Redundant addStoredBlock request received\" and why does it happen ? \nThe failover-controller acts the same way as it did on 2.5/6 when we had a lot of 'block does not belong to any replica'-messages. Namenode is too busy to respond to heartbeats, and is taken down...\n\nTo resolve this, I have to take down the datanode, delete all data from it, and start it up. Then cluster will reproduce the missing blocks, and the failing datanode is working fine again...","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Problem is logging of \"Redundant addStoredBlock request received\"","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=frha","name":"frha","key":"frha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Frode Halvorsen","active":true,"timeZone":"Europe/Oslo"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=frha","name":"frha","key":"frha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Frode Halvorsen","active":true,"timeZone":"Europe/Oslo"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12930167/comment/15102436","id":"15102436","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=frha","name":"frha","key":"frha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Frode Halvorsen","active":true,"timeZone":"Europe/Oslo"},"body":"I have an addition;\nWhen I 'cleaned out' the datanode, it started out with 0 blocks, and did of course not do any harm to the name-node when restarting.\nToday I tried to restart it again, after it had recieved a few blocks, and the log on the namenode started getting those masseages again.\nThis time, however, the datanode didn't have enough blocks to spam the namenode long enough to take i down. The namenode just reported those redundant addStoreBlock for the new blocks on the datanode, and finished up before the failovercontroller shut it down...  \nSo just now, I have a few datanodes I cannot restart... ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=frha","name":"frha","key":"frha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Frode Halvorsen","active":true,"timeZone":"Europe/Oslo"},"created":"2016-01-15T20:39:34.323+0000","updated":"2016-01-15T20:39:34.323+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12930167/comment/15296037","id":"15296037","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"[~frha] Have you resolved this problem or able to root cause it? I am also hitting a similar issue. DataNode restart leads to these logs in NameNode making serviceRPC latency huge. So not able to perform DN restarts.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-05-23T07:34:07.977+0000","updated":"2016-05-23T07:34:07.977+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12930167/comment/15296169","id":"15296169","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=frha","name":"frha","key":"frha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Frode Halvorsen","active":true,"timeZone":"Europe/Oslo"},"body":"Not resolved in 2.7.2. We still have same issues every time we restart DN's","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=frha","name":"frha","key":"frha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Frode Halvorsen","active":true,"timeZone":"Europe/Oslo"},"created":"2016-05-23T09:47:56.259+0000","updated":"2016-05-23T09:47:56.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12930167/comment/15296209","id":"15296209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"I changed the log statement to 'debug' level (restarting NN) and was able to do rolling restart of DN. The problem is that log level was WARN. Hence reducing log level resolved the problem. I could see this change is already available in Trunk code.\n\nSeems HDFS-9906 fixes this. It's available in 2.8.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-05-23T10:38:04.436+0000","updated":"2016-05-23T10:38:04.436+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12930167/comment/15331126","id":"15331126","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~frha],can't we close this as duplicate of HDFS-9906..?  [~xyao] are you planning additional to HDFS-9906..? I think, we can backport HDFS-9906 to branch-2.7..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-06-15T04:26:52.358+0000","updated":"2016-06-15T04:26:52.358+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12930167/comment/15331182","id":"15331182","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyao","name":"xyao","key":"xyao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xiaoyu Yao","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~brahma] for the heads up. Yes, we do need to backport HDFS-9906 to branch-2.7. \nIn our case, adding a dedicated serviceRPC port help avoiding the NN failover.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyao","name":"xyao","key":"xyao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xiaoyu Yao","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-06-15T05:35:08.425+0000","updated":"2016-06-15T05:35:08.425+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-9650/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2rau7:"}}