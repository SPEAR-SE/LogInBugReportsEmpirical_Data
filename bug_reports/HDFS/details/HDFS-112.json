{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12334176","self":"https://issues.apache.org/jira/rest/api/2/issue/12334176","key":"HDFS-112","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2006-05-13T03:09:35.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sun Jul 17 17:37:59 UTC 2011","customfield_12310420":"16612","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_163435709246_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-07-17T17:37:59.191+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-112/watchers","watchCount":0,"isWatching":false},"created":"2006-05-13T02:49:30.000+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-07-17T17:37:59.241+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"\nThe dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.\n\nThey have been partially broken since  \"test.dfs.same.host.targets.allowed\" went away and replication ceased for these tests. \n\nThey got really broken when NameNode stopped automatically formatting itself .\n\nSince they seem to be ignored, I took the liberty of changing how they work.\n\nThe main thing is, you must put this into your hosts file:\n\n127.0.0.1       localhost0\n127.0.0.1       localhost1\n127.0.0.1       localhost2\n127.0.0.1       localhost3\n127.0.0.1       localhost4\n127.0.0.1       localhost5\n127.0.0.1       localhost6\n127.0.0.1       localhost7\n127.0.0.1       localhost8\n127.0.0.1       localhost9\n127.0.0.1       localhost10\n127.0.0.1       localhost11\n127.0.0.1       localhost12\n127.0.0.1       localhost13\n127.0.0.1       localhost14\n127.0.0.1       localhost15\n\nThis way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.\n\nAlso, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12334467","id":"12334467","filename":"ClusterTestFixes.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"created":"2006-05-24T05:21:13.000+0000","size":18301,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12334467/ClusterTestFixes.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12327439","id":"12327439","filename":"fix_clustertestdfs.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"created":"2006-05-13T02:50:04.000+0000","size":8301,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12327439/fix_clustertestdfs.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"107509","customfield_12312823":null,"summary":"ClusterTestDFS fails","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"local workstation (windows) ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12334176/comment/12383263","id":"12383263","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"body":"Having to change the hosts file for a test is not great.\n\nPerhaps we could instead just alter Java to resolve hostnames differently while testing?\n\nhttp://forum.java.sun.com/thread.jspa?threadID=729300\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"created":"2006-05-13T03:09:35.000+0000","updated":"2006-05-13T03:09:35.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12334176/comment/12383289","id":"12383289","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"body":"Well, THAT looks like a nice trick (hacking the name resolver in java). I'll have to try it. That would eliminate the need to change the hosts file.\n\nRemember, these are long tests that nobody is currently running anyway. Running them is a deliberate act and you only need to change your hosts file once. \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"created":"2006-05-13T04:12:29.000+0000","updated":"2006-05-13T04:12:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12334176/comment/12413015","id":"12413015","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"body":"Here's the latest on this issue.\n\nI have a new patch that fixes the two main DFS tests. I think it would be crazy for us to move onward without having good DFS tests. \n\nThere is a 'name server' hack in the patch now. The requires the system property \"sun.net.spi.nameservice.provider\" to be set to \"dns,mine\".\nIt is not good enough to just call: \n\nSystem.setProperty(\"sun.net.spi.nameservice.provider.1\",\"dns,mine\");\n\nin the code unless you can do it BEFORE anyone else initializes InetAddress.java. JUnit is bad this way so the property must be set in the ant script that calls JUnit. This is in the latest patch.\n\nIf you want to call the unit test from eclipse then you will need to pass \n-Dsun.net.spi.nameservice.provider.1=dns,mine\nto the jvm. Or, you might define \"127.0.0.1 localhost0\" through \"127.0.0.1 localhost15\" in your hosts file and get the same result.\n\nSpeaking of build.xml, The definition of the 'test-cluster' target tries to run ANYTHING in the test directory as a unit test - this generates lots of failure messages (e.g. RandomDatum is not a TestCase so it fails). I changed it so that the test-cluster target only runs files of the form \"ClusterTest*.java\". ToCpp.java, FromCpp.java, and DistributedFSCheck.java are NOT being run. To include them we should either make a new ant target (preferred), or change their name to start with ClusterTest. Or change the ant script.\n\nI changed several constants in the ClusterTest*.java tests to make them run faster. I divided all the timeouts by 10. I removed the 'already existing' file creation test from ClusterTestDFSNamespaceLogging because it fails by timing out and that takes 3 minutes. When we can override LEASE_PERIOD then we can put that test back in. The whole cluster-test target now runs in 4 min.\n\nClusterTestDFSNamespaceLogging and ClusterTestDFS have VERY similar DFS simulations. As does MiniDfsCluster. I think someone needs to factor-out the dfs sim from all three of these tests.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"created":"2006-05-24T05:19:14.000+0000","updated":"2006-05-24T05:19:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12334176/comment/12413016","id":"12413016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"body":"patch to fix dfs cluster tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awootton","name":"awootton","key":"awootton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"alan wootton","active":true,"timeZone":"Etc/UTC"},"created":"2006-05-24T05:21:13.000+0000","updated":"2006-05-24T05:21:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12334176/comment/13066695","id":"13066695","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"This JIRA has grown stale over years and needs to be closed. The tests framework has changed considerably since '06.\n\nWith the current mini clusters, giving a hosts array is possible for different hostnamed daemons, and by all the tests it carries, it does appear to work alright if you wanna use it for such purposes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-07-17T17:37:59.208+0000","updated":"2011-07-17T17:37:59.208+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-112/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ir93:"}}