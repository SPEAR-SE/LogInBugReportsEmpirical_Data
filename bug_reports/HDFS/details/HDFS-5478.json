{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12678156","self":"https://issues.apache.org/jira/rest/api/2/issue/12678156","key":"HDFS-5478","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2013-11-08T08:44:53.429+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Nov 11 02:29:55 UTC 2013","customfield_12310420":"357531","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_249168397_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-11-11T02:29:55.562+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-5478/watchers","watchCount":3,"isWatching":false},"created":"2013-11-08T05:17:07.195+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12320353","id":"12320353","description":"hadoop-2.0.0-alpha release","name":"2.0.0-alpha","archived":false,"released":true,"releaseDate":"2012-05-23"}],"issuelinks":[{"id":"12378239","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12378239","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12616993","key":"HDFS-4213","self":"https://issues.apache.org/jira/rest/api/2/issue/12616993","fields":{"summary":"When the client calls hsync, allows the client to update the file length in the NameNode","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}},{"id":"12378151","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12378151","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12616993","key":"HDFS-4213","self":"https://issues.apache.org/jira/rest/api/2/issue/12616993","fields":{"summary":"When the client calls hsync, allows the client to update the file length in the NameNode","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-11-11T02:29:55.589+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Using a Java client to write to a FSDataOutputStream.  After some data is written and hsync() is called, {{hdfs dfs -get /path/to/file}} gets a file containing the data written so-far, all good.\n\n{{hdfs dfs -ls /path/to/file}} however reports a zero-byte file, presumably until the stream is closed (it then shows the correct size).  Hue File Browser (running CDH4) also shows zero bytes until the stream is closed.\n\nSee also http://grokbase.com/t/hadoop/hdfs-user/113j63nrce/zero-file-size-after-hsync which discusses the same problem.\n\nAfter the buffer is flushed it would be good if the reported file size was updated.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"357821","customfield_12312823":null,"summary":"File size reports as zero after writing and calling FSDataOutputStream#hsync()","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"RHEL/OEL 6u3","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678156/comment/13817120","id":"13817120","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"\nYou may need to call following hsync method with UPDATE_LENGTH flag to update the length in the NameNode.\n{code}\n((HdfsDataOutputStream) fos).hsync(EnumSet.of(SyncFlag.UPDATE_LENGTH));\n{code}\n\nCan you please try this and let us know the result.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-11-08T08:44:53.429+0000","updated":"2013-11-08T08:44:53.429+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678156/comment/13817139","id":"13817139","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"body":"HDFS-4213 implemented an API change to allow the file-size to be updated on hsync().","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"created":"2013-11-08T09:26:09.687+0000","updated":"2013-11-08T09:26:09.687+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678156/comment/13818630","id":"13818630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"body":"Thanks Vinay - I'm currently using 2.0.0 so can't test this yet, which was introduced in 2.0.3.  It looks like it will do the job though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"created":"2013-11-10T23:52:43.485+0000","updated":"2013-11-10T23:52:43.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678156/comment/13818631","id":"13818631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"body":"Duplicate of HDFS-4213.  Only question is whether a normal hsync() or hflush() should update this by default and without needing to cast-down, or whether that is too expensive to happen by-default.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"created":"2013-11-10T23:54:44.320+0000","updated":"2013-11-10T23:54:44.320+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678156/comment/13818644","id":"13818644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. Duplicate of HDFS-4213. Only question is whether a normal hsync() or hflush() should update this by default and without needing to cast-down, or whether that is too expensive to happen by-default.\nIf we call update length by default, it will be expensive as every sync call goes to namenode to update length which. So its better to keep it to user's interest to update the length whenever required. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-11-11T01:16:13.751+0000","updated":"2013-11-11T01:16:13.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678156/comment/13818660","id":"13818660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"body":"Closed, duplicate, fixed in 2.0.3, solution requires {{FSDataOutputStream}} to be cast to {{HdfsDataOutputStream}} to call an overloaded {{hsync}} method.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brett_s_r","name":"brett_s_r","key":"brett_s_r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Randall","active":true,"timeZone":"Australia/Sydney"},"created":"2013-11-11T02:29:55.585+0000","updated":"2013-11-11T02:29:55.585+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-5478/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1pmv3:"}}