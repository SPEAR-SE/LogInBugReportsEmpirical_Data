{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12526960","self":"https://issues.apache.org/jira/rest/api/2/issue/12526960","key":"HDFS-2443","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Oct 31 08:29:55 UTC 2011","customfield_12310420":"85206","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-2443/watchers","watchCount":3,"isWatching":false},"created":"2011-10-13T02:08:00.376+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314046","id":"12314046","description":"","name":"0.21.0","archived":false,"released":true,"releaseDate":"2010-08-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-10-31T08:29:55.787+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312916","id":"12312916","name":"test"}],"timeoriginalestimate":null,"description":"testPut() tries to copy a file from local to a destination \"dst\" in HDFS, and uses a SecurityManager to capture this action. The new SecurityManager filters out this copy action from all actions it receives , and starts a second thread to copy a second file to the same destination \"dst\" in HDFS. The main thread sleeps 5 seconds immediately after. I think the original purpose is that, the copy from the main thread should succeed, and the second copy from the new thread should fail because the \"dst\" is being written. My guess can be confirmed by the asserts around these codes.\n\nHowever, the filter in the new SecurityManager is not right. It tries to find \"FileUtil.copyContent\", but these is no method called copyContent in FileUtil, and therefore the second thread is never started. Although the asserts always succeed, this code is not able to find bugs in this area.\n\nI also debugged it, and I can never hit the break points in the second copy thread. Even though I changed the filter from \"FileUtil.copyContent\" to \"FileUtil.copy\" and successfully started the second thread, the second thread succeeds before the main thread resumes, which is the opposite of the logic.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12501583","id":"12501583","filename":"HDFS-2443.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thehousong","name":"thehousong","key":"thehousong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10439","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10439","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10439","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10439"},"displayName":"Hou Song","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-10-31T08:29:55.657+0000","size":1444,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12501583/HDFS-2443.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"113890","customfield_12312823":null,"summary":"A bug in unit test: TestDFSShell.testPut()","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thehousong","name":"thehousong","key":"thehousong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10439","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10439","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10439","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10439"},"displayName":"Hou Song","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thehousong","name":"thehousong","key":"thehousong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10439","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10439","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10439","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10439"},"displayName":"Hou Song","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12526960/comment/13140000","id":"13140000","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thehousong","name":"thehousong","key":"thehousong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10439","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10439","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10439","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10439"},"displayName":"Hou Song","active":true,"timeZone":"Asia/Shanghai"},"body":"Change the filter \"FileUtil.copyContent\" to \"FileUtil.copy\", so that the second copy thread can be started. Move the 5 second wait to the second copy so that the first copy in the main thread finishes successful, and the second copy fails, which is logically correct according to asserts around the codes. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thehousong","name":"thehousong","key":"thehousong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10439","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10439","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10439","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10439"},"displayName":"Hou Song","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-10-31T08:29:55.763+0000","updated":"2011-10-31T08:29:55.763+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-2443/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0jum7:"}}