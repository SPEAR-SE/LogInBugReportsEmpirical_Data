{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13061553","self":"https://issues.apache.org/jira/rest/api/2/issue/13061553","key":"HDFS-11622","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-04-05T23:56:33.884+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Apr 13 09:50:33 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11622/watchers","watchCount":5,"isWatching":false},"created":"2017-04-04T22:22:12.585+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-04-13T09:50:33.043+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327959","id":"12327959","name":"tracing"}],"timeoriginalestimate":null,"description":"In the {{run()}} method of {{DataStreamer}} class, the following code is written. {{parents\\[0\\]}} refer to the {{spanId}} of the parent span.\n{code}\n              one = dataQueue.getFirst(); // regular data packet\n              long parents[] = one.getTraceParents();\n              if (parents.length > 0) {\n                     scope = Trace.startSpan(\"dataStreamer\", new TraceInfo(0, parents[0]));\n                // TODO: use setParents API once it's available from HTrace 3.2\n                // scope = Trace.startSpan(\"dataStreamer\", Sampler.ALWAYS);\n                // scope.getSpan().setParents(parents);\n              }\n{code}\n\nThe {{scope}} starts a new TraceSpan with a traceId hardcoded to 0. Ideally it should be taken when {{currentPacket.addTraceParent(Trace.currentSpan())}} is invoked. This JIRA is to propose an additional long field inside the {{DFSPacket}} class which holds the parent {{traceId}}. \n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"TraceId hardcoded to 0 in DataStreamer, correlation between multiple spans is lost","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karanmehta93","name":"karanmehta93","key":"karanmehta93","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karan Mehta","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karanmehta93","name":"karanmehta93","key":"karanmehta93","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karan Mehta","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15958062","id":"15958062","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jamestaylor","name":"jamestaylor","key":"jamestaylor","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jamestaylor&avatarId=18463","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jamestaylor&avatarId=18463","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jamestaylor&avatarId=18463","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jamestaylor&avatarId=18463"},"displayName":"James Taylor","active":true,"timeZone":"America/Los_Angeles"},"body":"FYI, [~apurtell] - not sure if you've seen this one, but it's another important one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jamestaylor","name":"jamestaylor","key":"jamestaylor","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jamestaylor&avatarId=18463","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jamestaylor&avatarId=18463","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jamestaylor&avatarId=18463","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jamestaylor&avatarId=18463"},"displayName":"James Taylor","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-04-05T23:56:33.884+0000","updated":"2017-04-05T23:56:33.884+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15958293","id":"15958293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"body":"Thanks for reporting this, [~karanmehta93].\n\nWe can not determine which trace id to set if there is a span having multiple parent. While it is limitation of HTrace after multiple parent feature was added, I think it is reasonable to set trace id of the parent if {{parents.length == 1}} for applications currently using trace id to analyze tracing spans.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"created":"2017-04-06T05:03:16.441+0000","updated":"2017-04-06T05:03:16.441+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15959433","id":"15959433","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karanmehta93","name":"karanmehta93","key":"karanmehta93","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karan Mehta","active":true,"timeZone":"America/Los_Angeles"},"body":"I understood the following use case for such a requirement [non-RPC spans and mapping to multiple parents| https://github.com/opentracing/specification/issues/5].\n{quote}\nAnother example is in HBase. HBase has a write-ahead log, where it does \"group commit.\" In other words, if HBase gets requests A, B, and C, it does a single write-ahead log write for all of them. The WAL writes can be time-consuming since they involve writing to an HDFS stream, which could be slow for any number of reasons (network, error handling, GC, etc.).\n{quote} \n\nSince requests A, B and C can be started independently, they will be assigned different trace ID as well as span ID. The WAL write will be single for them, having a single span for each of them, containing multiple parents pointing to each of them. I am unclear about the use of trace ID at this point if all of them can be easily traced via their parents span ID. Even in cases where the trace doesn't form any DAG and is a linearly growing span, the information can still be tracked via parent span ID. \n\nAlthough we have multiple parents, they way it should work is that all of them relate to the same span ID. Commented code for future use in the Description suggests that all the parents will be available at the time of start of {{dataStreamer}} span. The {{DFSPacket}} initializes the parents field when it is dumping the data in {{dataQueue}} with the line {{packet.addTraceParent(Tracer.getCurrentSpanId())}}, thus getting current trace from the {{ThreadLocal}}. At this point, I feel that we can also get the value of trace ID and add the info inside the {{DFSPacket}}. Any thoughts on this one?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karanmehta93","name":"karanmehta93","key":"karanmehta93","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karan Mehta","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-04-06T17:50:50.473+0000","updated":"2017-04-06T17:50:50.473+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15960074","id":"15960074","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"body":"bq. I am unclear about the use of trace ID at this point if all of them can be easily traced via their parents span ID. Even in cases where the trace doesn't form any DAG and is a linearly growing span, the information can still be tracked via parent span ID.\n\nThat's right. In HTrace 4, there is no trace while part of span id is the equivalent.\nhttps://github.com/apache/incubator-htrace/blob/4.2/htrace-core4/src/main/java/org/apache/htrace/core/SpanId.java#L30-L31\n\nI think trace id is useful to effectively get relevant spans from whole spans space, before traversing parent-child relationship. If you use HBase or similar to store spans, you can co-locate relevant spans by using trace id as leading bits of rowkey.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"created":"2017-04-07T00:44:54.995+0000","updated":"2017-04-07T00:44:54.995+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15960078","id":"15960078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"body":"bq. The DFSPacket initializes the parents field when it is dumping the data in dataQueue with the line packet.addTraceParent(Tracer.getCurrentSpanId()), thus getting current trace from the ThreadLocal. At this point, I feel that we can also get the value of trace ID and add the info inside the DFSPacket. Any thoughts on this one?\n\nAs you pointed out, the current {{dataStreamer}} span in branch-2.7 seems not to have situation setting multiple parents. It looks like extention for future use?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"created":"2017-04-07T00:48:13.500+0000","updated":"2017-04-07T00:48:13.500+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15960131","id":"15960131","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karanmehta93","name":"karanmehta93","key":"karanmehta93","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karan Mehta","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. As you pointed out, the current dataStreamer span in branch-2.7 seems not to have situation setting multiple parents. It looks like extention for future use?\nLooks like an extension, since branch-2.7 depends on HTrace-3.1 which doesn't have that API. I had a quick look at the code, while creating a new {{MilliSpan}}, the constructor can take only 1 parent as the input. Only if explicit spans are built using {{Builder}} class inside the {{MilliSpan}} class they can be assigned an array of parents. At this point, the usages of this builder class also have provided only single parentId as input. According to my knowledge, for this particular branch we can go ahead by saving the traceId in the {{DFSPacket}} if its seems acceptable. Let me know your thoughts.\n\nIf you want, I can submit a patch for this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karanmehta93","name":"karanmehta93","key":"karanmehta93","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karan Mehta","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-04-07T01:24:54.690+0000","updated":"2017-04-07T01:24:54.690+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15960420","id":"15960420","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"body":"bq. If you want, I can submit a patch for this one.\n\nI appreciate it if there are specific problems in downstream projects like Phoenix, otherwise we should be conservative to fix core DFS code in maintenance branch.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"created":"2017-04-07T07:39:52.215+0000","updated":"2017-04-07T07:39:52.215+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15961241","id":"15961241","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. I appreciate it if there are specific problems in downstream projects like Phoenix, otherwise we should be conservative to fix core DFS code in maintenance branch.\n\n[~iwasakims] The spans in HDFS can have multiple parents because of batching in the HBase WAL, which Phoenix uses as platform. An interesting case. I think if this improvement is not committed to the shipping versions of Hadoop then Phoenix tracing, based on HTrace, won't work correctly and cannot be reliably used. HTrace is promising, but it needs to work correctly holistically with the whole stack or is rendered moot. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-04-07T18:35:51.368+0000","updated":"2017-04-07T18:36:15.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13061553/comment/15967360","id":"15967360","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"body":"Thanks for the comment, [~apurtell]. Considering batching in the HBase WAL, HDFS needs feature to add parent span when {{DFSOutputStream#write}} is called to append each WALEntry (and when {{hflush}} is called too?). Even code in trunk does not have this yet. Parent spans added only on queuing DFSPacket now.\n\nThe issue described here is about tracking tracing spans by not parent-child relationship but trace id . This is relevant to branch-2.7 only. While this is not crucial for end-to-end tracing of HBase WAL batching, I welcome the patch to fix this issue if there are needs for analyzing tracing spans by trace id only.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iwasakims","name":"iwasakims","key":"iwasakims","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iwasakims&avatarId=18289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iwasakims&avatarId=18289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iwasakims&avatarId=18289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iwasakims&avatarId=18289"},"displayName":"Masatake Iwasaki","active":true,"timeZone":"Asia/Tokyo"},"created":"2017-04-13T09:50:33.043+0000","updated":"2017-04-13T09:50:33.043+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11622/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3d7f3:"}}