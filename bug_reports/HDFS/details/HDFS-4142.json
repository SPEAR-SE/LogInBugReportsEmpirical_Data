{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12614460","self":"https://issues.apache.org/jira/rest/api/2/issue/12614460","key":"HDFS-4142","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-11-05T18:11:28.851+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Nov 05 18:11:28 UTC 2012","customfield_12310420":"253928","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-4142/watchers","watchCount":6,"isWatching":false},"created":"2012-11-02T00:47:01.577+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-11-05T18:11:28.851+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Using the hadoop cli when I try to move a directory to another directory, if the target directory contains a directory with the same name as the source directory, it would create nested directories instead of overwriting it. This seems counter intuitive as this is not the behavior with unix mv command. \n\nHere is an example to explain the bug:\n\n{code}\n~ $ hadoop fs -lsr /tmp/root\nlsr: DEPRECATED: Please use 'ls -R' instead.\ndrwx------   - malakar hdfs          0 2012-11-01 23:30 /tmp/root/parent\ndrwx------   - malakar hdfs          0 2012-11-01 23:30 /tmp/root/parent/child\n-rw-------   3 malakar hdfs       9950 2012-11-01 23:30 /tmp/root/parent/child/passwd\ndrwx------   - malakar hdfs          0 2012-11-01 23:31 /tmp/root/parent2\ndrwx------   - malakar hdfs          0 2012-11-01 23:31 /tmp/root/parent2/child\n~ $ hadoop fs -mv /tmp/root/parent/child /tmp/root/parent2\n~ $ hadoop fs -lsr /tmp/root\nlsr: DEPRECATED: Please use 'ls -R' instead.\ndrwx------   - malakar hdfs          0 2012-11-01 23:32 /tmp/root/parent\ndrwx------   - malakar hdfs          0 2012-11-01 23:31 /tmp/root/parent2\ndrwx------   - malakar hdfs          0 2012-11-01 23:32 /tmp/root/parent2/child\ndrwx------   - malakar hdfs          0 2012-11-01 23:30 /tmp/root/parent2/child/child\n-rw-------   3 malakar hdfs       9950 2012-11-01 23:30 /tmp/root/parent2/child/child/passwd\n{code}\n\nThe same operation seems to fail when using the [FileSystem|http://hadoop.apache.org/docs/current/api/org/apache/hadoop/fs/FileSystem.html#rename(org.apache.hadoop.fs.Path, org.apache.hadoop.fs.Path)] rename api  though.\n\nUsing the java api:\n{code}\n~ $ hadoop jar test.jar RenameTest\nBefore:\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent/child\n-rw-------   3 malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent/child/file\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/targetparent\nAbout to move: /tmp/renametest/parent/child to: /tmp/renametest/targetparent\nAfter moving: /tmp/renametest/parent/child to /tmp/renametest/targetparent\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/targetparent\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/targetparent/child\n-rw-------   3 malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/targetparent/child/file\nBefore:\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent/child\n-rw-------   3 malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/parent/child/file\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/targetparent\ndrwx------   - malakar hdfs          0 2012-11-02 00:23 /tmp/renametest/targetparent/child\nAbout to move: /tmp/renametest/parent/child to: /tmp/renametest/targetparent\nCould not rename directory: /tmp/renametest/parent/child to /tmp/renametest/targetparent\n{code}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12551802","id":"12551802","filename":"RenameTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amalakar","name":"amalakar","key":"amalakar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=amalakar&avatarId=19604","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amalakar&avatarId=19604","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amalakar&avatarId=19604","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amalakar&avatarId=19604"},"displayName":"Arup Malakar","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-11-02T00:50:26.829+0000","size":6643,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12551802/RenameTest.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"81718","customfield_12312823":null,"summary":"hadoop fs -mv command creates nested directory instead of overwriting when a same named directory as source already exists","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amalakar","name":"amalakar","key":"amalakar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=amalakar&avatarId=19604","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amalakar&avatarId=19604","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amalakar&avatarId=19604","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amalakar&avatarId=19604"},"displayName":"Arup Malakar","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amalakar","name":"amalakar","key":"amalakar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=amalakar&avatarId=19604","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amalakar&avatarId=19604","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amalakar&avatarId=19604","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amalakar&avatarId=19604"},"displayName":"Arup Malakar","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"hadoop 0.23.4","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12614460/comment/13489183","id":"13489183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amalakar","name":"amalakar","key":"amalakar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=amalakar&avatarId=19604","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amalakar&avatarId=19604","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amalakar&avatarId=19604","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amalakar&avatarId=19604"},"displayName":"Arup Malakar","active":true,"timeZone":"America/Los_Angeles"},"body":"Class I used to see the FileSystem.rename() api behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amalakar","name":"amalakar","key":"amalakar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=amalakar&avatarId=19604","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amalakar&avatarId=19604","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amalakar&avatarId=19604","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amalakar&avatarId=19604"},"displayName":"Arup Malakar","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-11-02T00:50:26.831+0000","updated":"2012-11-02T00:50:26.831+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12614460/comment/13490785","id":"13490785","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"body":"The UNIX {{mv}} command seems to prompt in this scenario, unless {{\\-f}} is specified.  If we change {{hadoop fs -mv}} to do the same thing, we should prompt as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-11-05T18:11:28.851+0000","updated":"2012-11-05T18:11:28.851+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-4142/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ec2n:"}}