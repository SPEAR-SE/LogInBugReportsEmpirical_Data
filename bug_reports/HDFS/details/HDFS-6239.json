{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12708175","self":"https://issues.apache.org/jira/rest/api/2/issue/12708175","key":"HDFS-6239","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2014-04-14T02:42:38.760+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Dec 15 18:41:52 UTC 2014","customfield_12310420":"386498","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_21232189458_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-12-15T18:41:52.781+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-6239/watchers","watchCount":3,"isWatching":false},"created":"2014-04-14T00:52:03.408+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324148","id":"12324148","description":"maintenance release on branch-1.2","name":"1.2.1","archived":false,"released":true,"releaseDate":"2013-08-01"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-12-15T18:41:52.857+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312931","id":"12312931","name":"scripts"}],"timeoriginalestimate":null,"description":"start-dfs.sh fails to start remote data nodes and task nodes, though it is possible to start them manually through hadoop-daemon.sh.\n\nI've been able to debug and find the root cause the bug, and I thought it was a trivial fix, but I do not know how to do it. Can't figure out a way to handle this seemingly trivial bug.\n\nhadoop-daemons.sh calls slave.sh:\n\nexec \"$bin/slaves.sh\" --config $HADOOP_CONF_DIR cd \"$HADOOP_HOME\" \\; \"$bin/hadoop-daemon.sh\" --config $HADOOP_CONF_DIR \"$@\"\n\nThis is the issue when I debug using bash -x: In slaves.sh, the \\; becomes ';'\n\n+ ssh xxxx.xx.xxxx.xxx cd /afs/xx.xxxx.xxx/x/x/x/xx/xxxxx/libexec/.. ';' /afs/xx.xxxx.xxx/x/x/x/xx/xxxx/bin/hadoop-daemon.sh --config /afs/xx.xxxx.xxx/x/x/x/xx/xxxx/libexec/../conf start datanode\n\nThe problem is ';' . Because the semi-colon is surrounded by quotes, it doesn't execute the code after that. I manually ran the above command, and as expected the data node did not start. When I removed the quotes around the semi-colon, everything works. Please note that you can see the issue only when you do bash -x. If you echo the statement, the quotes around the semi-colon are not visible.\n\nThis issue is always reproducible for me, and because of it, I have to manually start daemons on each machine. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"386762","customfield_12312823":null,"summary":"start-dfs.sh does not start remote DataNode due to escape characters","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"GNU bash, version 4.1.2(1)-release (x86_64-redhat-linux-gnu)\n\nLinux foo 2.6.32-431.3.1.el6.x86_64 #1 SMP Fri Dec 13 06:58:20 EST 2013 x86_64 x86_64 x86_64 GNU/Linux\n\nAFS file system.\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708175/comment/13968028","id":"13968028","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"body":"I cannot reproduce it.\n\nDo you have softlink on your Hadoop install path? maybe your bash is incompatible.\n\nso can you try: search '-P' in the $HADOOP_HOME/libexec/hadoop-config.sh, and remove \"-P\".\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"created":"2014-04-14T02:42:38.760+0000","updated":"2014-04-14T02:42:38.760+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708175/comment/13968034","id":"13968034","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"body":"I don't have a softlink on my path, and removing -P in both the directory you've pointed to, and bin/ does not solve the issue. I've posted my version of bash in the environment, and I'm wondering if you tried reproducing the issue with the path depth above. I'm not sure what causes the ; to get quoted. It is 100% reproducible for me, and I assume that the issue will surface with increasing path depth.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"created":"2014-04-14T03:00:53.344+0000","updated":"2014-04-14T03:00:53.344+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708175/comment/13968038","id":"13968038","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"body":"I had tried to bypass the problem by playing around with different types of quoting in the following line:\n\nexec \"$bin/slaves.sh\" --config $HADOOP_CONF_DIR cd \"$HADOOP_HOME\" \\; \"$bin/hadoop-daemon.sh\" --config $HADOOP_CONF_DIR \"$@\"\n\nFor example, I tried something like:\n\nexec \"$bin/slaves.sh\" \"--config $HADOOP_CONF_DIR cd $HADOOP_HOME ; $bin/hadoop-daemon.sh --config $HADOOP_CONF_DIR $@\"\n\nThis causes the semi-colon to not get quoted, but when it executes the word 'datanode' (the last argument in the bash -x output in the description) gets unquoted. I'm pretty sure that there is some issue around quoting and escaping characters in this one line, and you hit the issue in some special cases (probably like the long path in my filesystem)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"created":"2014-04-14T03:09:52.049+0000","updated":"2014-04-14T03:09:52.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708175/comment/13968042","id":"13968042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"body":"I found a simple repro for quoting behavior:\n\nxx@xx:~$ cat x \nexec \"./y\" \"/u/s\" \\; \"ls /u/s\"\n\nxx@xx:~$ cat y \necho \"y\" $@\n\nxx@xx:~$ bash -x x\n+ exec ./y /u/s ';' 'ls /u/s'\ny /u/s ; ls /u/s\n\nYou can see the ; gets quoted. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xyzzy","name":"xyzzy","key":"xyzzy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xyzzy","active":true,"timeZone":"America/Chicago"},"created":"2014-04-14T03:38:14.689+0000","updated":"2014-04-14T03:38:14.689+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708175/comment/14246994","id":"14246994","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"Hadoop 1.x is dead and trunk/3.x has completely different code for this now. Closing as won't fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2014-12-15T18:41:52.848+0000","updated":"2014-12-15T18:41:52.848+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-6239/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1uky7:"}}