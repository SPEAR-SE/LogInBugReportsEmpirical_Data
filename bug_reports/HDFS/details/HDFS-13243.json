{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13143206","self":"https://issues.apache.org/jira/rest/api/2/issue/13143206","key":"HDFS-13243","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-03-07T14:03:50.408+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 29 04:22:46 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-13243/watchers","watchCount":8,"isWatching":false},"created":"2018-03-07T12:37:50.292+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332790","id":"12332790","description":"2.7.2 release","name":"2.7.2","archived":false,"released":true,"releaseDate":"2016-01-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342772","id":"12342772","description":"","name":"3.2.0","archived":false,"released":false}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-29T04:22:46.179+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312926","id":"12312926","name":"namenode"}],"timeoriginalestimate":null,"description":"HDFS File might get broken because of corrupt block(s) that could be produced by calling close and sync in the same time.\r\n\r\nWhen calling close was not successful, UCBlock status would change to COMMITTED, and if a sync request gets popped from queue and processed, sync operation would change the last block length.\r\n\r\nAfter that, DataNode would report all received block to NameNode, and will check Block length of all COMMITTED Blocks. But the block length was already different between recorded in NameNode memory and reported by DataNode, and consequently, the last block is marked as corruptted because of inconsistent length.\r\n\r\nÂ \r\n{panel:title=Log in my hdfs}\r\n2018-03-05 04:05:39,261 INFO org.apache.hadoop.hdfs.StateChange: BLOCK* allocate blk_1085498930_11758129\\{UCState=UNDER_CONSTRUCTION, truncateBlock=null, primaryNodeIndex=-1, replicas=[ReplicaUC[[DISK]DS-32c7e479-3845-4a44-adf1-831edec7506b:NORMAL:10.0.0.219:50010|RBW], ReplicaUC[[DISK]DS-a9a5d653-c049-463d-8e4a-d1f0dc14409c:NORMAL:10.0.0.220:50010|RBW], ReplicaUC[[DISK]DS-f2b7c04a-b724-4c69-abbf-d2e416f70706:NORMAL:10.0.0.218:50010|RBW]]} for /hbase/WALs/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com,16020,1519845790686/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com%2C16020%2C1519845790686.default.1520193926515\r\n2018-03-05 04:05:39,760 INFO org.apache.hadoop.hdfs.StateChange: BLOCK* fsync: /hbase/WALs/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com,16020,1519845790686/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com%2C16020%2C1519845790686.default.1520193926515 for DFSClient_NONMAPREDUCE_1077513762_1\r\n2018-03-05 04:05:39,761 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: BLOCK* blk_1085498930_11758129\\{UCState=COMMITTED, truncateBlock=null, primaryNodeIndex=-1, replicas=[ReplicaUC[[DISK]DS-32c7e479-3845-4a44-adf1-831edec7506b:NORMAL:10.0.0.219:50010|RBW], ReplicaUC[[DISK]DS-a9a5d653-c049-463d-8e4a-d1f0dc14409c:NORMAL:10.0.0.220:50010|RBW], ReplicaUC[[DISK]DS-f2b7c04a-b724-4c69-abbf-d2e416f70706:NORMAL:10.0.0.218:50010|RBW]]} is not COMPLETE (ucState = COMMITTED, replication# = 0 < minimum = 2) in file /hbase/WALs/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com,16020,1519845790686/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com%2C16020%2C1519845790686.default.1520193926515\r\n2018-03-05 04:05:39,761 INFO BlockStateChange: BLOCK* addStoredBlock: blockMap updated: 10.0.0.220:50010 is added to blk_1085498930_11758129\\{UCState=COMMITTED, truncateBlock=null, primaryNodeIndex=-1, replicas=[ReplicaUC[[DISK]DS-32c7e479-3845-4a44-adf1-831edec7506b:NORMAL:10.0.0.219:50010|RBW], ReplicaUC[[DISK]DS-a9a5d653-c049-463d-8e4a-d1f0dc14409c:NORMAL:10.0.0.220:50010|RBW], ReplicaUC[[DISK]DS-f2b7c04a-b724-4c69-abbf-d2e416f70706:NORMAL:10.0.0.218:50010|RBW]]} size 2054413\r\n2018-03-05 04:05:39,761 INFO BlockStateChange: BLOCK NameSystem.addToCorruptReplicasMap: blk_1085498930 added as corrupt on 10.0.0.219:50010 by hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com/10.0.0.219 because block is COMMITTED and reported length 2054413 does not match length in block map 141232\r\n2018-03-05 04:05:39,762 INFO BlockStateChange: BLOCK NameSystem.addToCorruptReplicasMap: blk_1085498930 added as corrupt on 10.0.0.218:50010 by hb-j5e517al6xib80rkb-004.hbase.rds.aliyuncs.com/10.0.0.218 because block is COMMITTED and reported length 2054413 does not match length in block map 141232\r\n2018-03-05 04:05:40,162 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: BLOCK* blk_1085498930_11758129\\{UCState=COMMITTED, truncateBlock=null, primaryNodeIndex=-1, replicas=[ReplicaUC[[DISK]DS-32c7e479-3845-4a44-adf1-831edec7506b:NORMAL:10.0.0.219:50010|RBW], ReplicaUC[[DISK]DS-a9a5d653-c049-463d-8e4a-d1f0dc14409c:NORMAL:10.0.0.220:50010|RBW], ReplicaUC[[DISK]DS-f2b7c04a-b724-4c69-abbf-d2e416f70706:NORMAL:10.0.0.218:50010|RBW]]} is not COMPLETE (ucState = COMMITTED, replication# = 3 >= minimum = 2) in file /hbase/WALs/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com,16020,1519845790686/hb-j5e517al6xib80rkb-006.hbase.rds.aliyuncs.com%2C16020%2C1519845790686.default.1520193926515\r\n{panel}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12342772","id":"12342772","description":"","name":"3.2.0","archived":false,"released":false}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12913379","id":"12913379","filename":"HDFS-13243-v1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-07T12:39:41.808+0000","size":16398,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12913379/HDFS-13243-v1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12913521","id":"12913521","filename":"HDFS-13243-v2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-08T05:18:16.584+0000","size":19316,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12913521/HDFS-13243-v2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916595","id":"12916595","filename":"HDFS-13243-v3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-28T10:54:09.312+0000","size":32262,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12916595/HDFS-13243-v3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916598","id":"12916598","filename":"HDFS-13243-v4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-28T11:24:11.901+0000","size":33019,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12916598/HDFS-13243-v4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12918321","id":"12918321","filename":"HDFS-13243-v5.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-04-10T06:15:31.706+0000","size":32198,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12918321/HDFS-13243-v5.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12918525","id":"12918525","filename":"HDFS-13243-v6.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-04-11T07:58:48.507+0000","size":29222,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12918525/HDFS-13243-v6.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Get CorruptBlock because of calling close and sync in same time","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16389581","id":"16389581","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 32s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  8s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 27s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 56s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 36s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m  9s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 14s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 20s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  9s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 30s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 23s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 23s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 57s{color} | {color:orange} hadoop-hdfs-project: The patch generated 46 new + 651 unchanged - 2 fixed = 697 total (was 653) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 31s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} shadedclient {color} | {color:red}  9m 40s{color} | {color:red} patch has errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 27s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 16s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 33s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 19m 12s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 24s{color} | {color:red} The patch generated 1 ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 76m 10s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.TestReadStripedFileWithDecodingDeletedData |\r\n|   | hadoop.fs.TestUrlStreamHandler |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure200 |\r\n|   | hadoop.hdfs.tools.TestWebHDFSStoragePolicyCommands |\r\n|   | hadoop.hdfs.TestHDFSFileSystemContract |\r\n|   | hadoop.hdfs.server.datanode.TestCachingStrategy |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure000 |\r\n|   | hadoop.fs.viewfs.TestViewFsHdfs |\r\n|   | hadoop.hdfs.TestFileAppend2 |\r\n|   | hadoop.hdfs.TestDFSRollback |\r\n|   | hadoop.hdfs.server.datanode.TestHSync |\r\n|   | hadoop.hdfs.server.namenode.metrics.TestNNMetricFilesInGetListingOps |\r\n|   | hadoop.tools.TestJMXGet |\r\n|   | hadoop.hdfs.server.blockmanagement.TestNameNodePrunesMissingStorages |\r\n|   | hadoop.hdfs.server.namenode.TestStartup |\r\n|   | hadoop.hdfs.server.namenode.TestProtectedDirectories |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure160 |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithSaslDataTransfer |\r\n|   | hadoop.hdfs.TestEncryptedTransfer |\r\n|   | hadoop.hdfs.TestReadWhileWriting |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailoverWithBlockTokensEnabled |\r\n|   | hadoop.hdfs.server.namenode.web.resources.TestWebHdfsDataLocality |\r\n|   | hadoop.hdfs.server.balancer.TestBalancer |\r\n|   | hadoop.fs.TestGlobPaths |\r\n|   | hadoop.hdfs.TestFileAppend3 |\r\n|   | hadoop.hdfs.TestAppendSnapshotTruncate |\r\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerForContentSummary |\r\n|   | hadoop.hdfs.TestAppendDifferentChecksum |\r\n|   | hadoop.hdfs.TestDistributedFileSystemWithECFileWithRandomECPolicy |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockTokenWithDFSStriped |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailure |\r\n|   | hadoop.hdfs.server.datanode.TestReadOnlySharedStorage |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDNFencingWithReplication |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure180 |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure170 |\r\n|   | hadoop.fs.TestHDFSFileContextMainOperations |\r\n|   | hadoop.fs.TestFcHdfsCreateMkdir |\r\n|   | hadoop.hdfs.TestSecureEncryptionZoneWithKMS |\r\n|   | hadoop.hdfs.protocol.datatransfer.sasl.TestSaslDataTransfer |\r\n|   | hadoop.hdfs.TestDFSPermission |\r\n|   | hadoop.hdfs.TestDFSClientExcludedNodes |\r\n|   | hadoop.security.TestPermissionSymlinks |\r\n|   | hadoop.hdfs.TestDecommissionWithStriped |\r\n|   | hadoop.hdfs.server.namenode.TestFSNamesystem |\r\n|   | hadoop.hdfs.server.blockmanagement.TestRBWBlockInvalidation |\r\n|   | hadoop.hdfs.server.datanode.TestBlockRecovery |\r\n|   | hadoop.hdfs.server.namenode.TestNameEditsConfigs |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureOfSharedDir |\r\n|   | hadoop.hdfs.server.namenode.metrics.TestNameNodeMetrics |\r\n|   | hadoop.net.TestNetworkTopology |\r\n|   | hadoop.hdfs.TestFileCreation |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractOpen |\r\n|   | hadoop.hdfs.server.namenode.TestMetadataVersionOutput |\r\n|   | hadoop.hdfs.web.TestWebHdfsWithMultipleNameNodes |\r\n|   | hadoop.hdfs.server.namenode.ha.TestRetryCacheWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestReencryption |\r\n|   | hadoop.security.TestRefreshUserMappings |\r\n|   | hadoop.hdfs.TestReadStripedFileWithDecoding |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSetQuotaWithSnapshot |\r\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerForAcl |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeMXBean |\r\n|   | hadoop.hdfs.TestExternalBlockReader |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAAppend |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDNFencing |\r\n|   | hadoop.hdfs.server.namenode.TestCreateEditsLog |\r\n|   | hadoop.hdfs.server.namenode.TestINodeAttributeProvider |\r\n|   | hadoop.hdfs.server.blockmanagement.TestReplicationPolicyConsiderLoad |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotReplication |\r\n|   | hadoop.hdfs.web.TestWebHdfsFileSystemContract |\r\n|   | hadoop.hdfs.server.namenode.TestValidateConfigurationSettings |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemHdfs |\r\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewer |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractSetTimes |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeTcpNoDelay |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |\r\n|   | hadoop.hdfs.TestWriteRead |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestScrLazyPersistFiles |\r\n|   | hadoop.hdfs.TestDFSUpgradeFromImage |\r\n|   | hadoop.hdfs.TestHdfsAdmin |\r\n|   | hadoop.hdfs.TestReplication |\r\n|   | hadoop.hdfs.server.namenode.TestQuotaWithStripedBlocksWithRandomECPolicy |\r\n|   | hadoop.hdfs.server.namenode.TestCacheDirectives |\r\n|   | hadoop.hdfs.TestFileAppendRestart |\r\n|   | hadoop.hdfs.server.datanode.TestFsDatasetCache |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithHANameNodes |\r\n|   | hadoop.hdfs.server.namenode.ha.TestNNHealthCheck |\r\n|   | hadoop.hdfs.server.namenode.TestUpgradeDomainBlockPlacementPolicy |\r\n|   | hadoop.hdfs.qjournal.server.TestJournalNodeSync |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeReconfiguration |\r\n|   | hadoop.hdfs.TestEncryptionZones |\r\n|   | hadoop.hdfs.server.namenode.ha.TestPendingCorruptDnMessages |\r\n|   | hadoop.hdfs.server.namenode.TestQuotaWithStripedBlocks |\r\n|   | hadoop.hdfs.server.namenode.TestListCorruptFileBlocks |\r\n|   | hadoop.hdfs.TestParallelShortCircuitRead |\r\n|   | hadoop.fs.TestUnbuffer |\r\n|   | hadoop.hdfs.TestClientReportBadBlock |\r\n|   | hadoop.hdfs.TestWriteConfigurationToDFS |\r\n|   | hadoop.hdfs.TestLease |\r\n|   | hadoop.hdfs.server.namenode.TestSnapshotPathINodes |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeAcl |\r\n|   | hadoop.cli.TestXAttrCLI |\r\n|   | hadoop.hdfs.server.namenode.TestHostsFiles |\r\n|   | hadoop.hdfs.server.namenode.ha.TestLossyRetryInvocationHandler |\r\n|   | hadoop.hdfs.security.TestDelegationToken |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyPersistReplicaRecovery |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyPersistPolicy |\r\n|   | hadoop.hdfs.TestDFSRemove |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure190 |\r\n|   | hadoop.hdfs.TestTrashWithSecureEncryptionZones |\r\n|   | hadoop.hdfs.TestParallelRead |\r\n|   | hadoop.hdfs.server.namenode.TestFileLimit |\r\n|   | hadoop.hdfs.server.datanode.TestDnRespectsBlockReportSplitThreshold |\r\n|   | hadoop.hdfs.server.namenode.TestBlockPlacementPolicyRackFaultTolerant |\r\n|   | hadoop.hdfs.web.TestWebHdfsTimeouts |\r\n|   | hadoop.hdfs.TestDFSClientSocketSize |\r\n|   | hadoop.hdfs.TestReservedRawPaths |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestDatanodeRestart |\r\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerForXAttr |\r\n|   | hadoop.hdfs.tools.offlineEditsViewer.TestOfflineEditsViewer |\r\n|   | hadoop.hdfs.TestDFSStartupVersions |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyCheckpoints |\r\n|   | hadoop.hdfs.TestDataTransferKeepalive |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractAppend |\r\n|   | hadoop.hdfs.TestLeaseRecovery |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations |\r\n|   | hadoop.hdfs.server.namenode.TestAddStripedBlockInFBR |\r\n|   | hadoop.hdfs.TestFileCorruption |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeHotSwapVolumes |\r\n|   | hadoop.hdfs.server.namenode.ha.TestQuotasWithHA |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStream |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeMetadataConsistency |\r\n|   | hadoop.hdfs.shortcircuit.TestShortCircuitCache |\r\n|   | hadoop.hdfs.server.namenode.TestStripedINodeFile |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyInProgressTail |\r\n|   | hadoop.hdfs.server.blockmanagement.TestReplicationPolicy |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockReportRateLimiting |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogsDuringFailover |\r\n|   | hadoop.hdfs.server.namenode.ha.TestXAttrsWithHA |\r\n|   | hadoop.hdfs.server.datanode.TestTriggerBlockReport |\r\n|   | hadoop.hdfs.server.namenode.TestSaveNamespace |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDelegationTokensWithHA |\r\n|   | hadoop.hdfs.TestErasureCodingPolicies |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeECN |\r\n|   | hadoop.hdfs.server.namenode.ha.TestEditLogTailer |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshot |\r\n|   | hadoop.TestGenericRefresh |\r\n|   | hadoop.hdfs.server.namenode.TestFsckWithMultipleNameNodes |\r\n|   | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |\r\n|   | hadoop.hdfs.server.namenode.TestReencryptionWithKMS |\r\n|   | hadoop.hdfs.TestFetchImage |\r\n|   | hadoop.hdfs.security.token.block.TestBlockToken |\r\n|   | hadoop.hdfs.server.namenode.TestSecureNameNode |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotListing |\r\n|   | hadoop.tracing.TestTracing |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeStatusMXBean |\r\n|   | hadoop.hdfs.TestDFSClientFailover |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRecovery |\r\n|   | hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits |\r\n|   | hadoop.hdfs.TestListFilesInFileContext |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractRename |\r\n|   | hadoop.fs.viewfs.TestViewFsFileStatusHdfs |\r\n|   | hadoop.hdfs.server.datanode.TestBlockHasMultipleReplicasOnSameDN |\r\n|   | hadoop.fs.permission.TestStickyBit |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeFaultInjector |\r\n|   | hadoop.hdfs.TestFileStatusWithECPolicy |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestCheckpointsWithSnapshots |\r\n|   | hadoop.hdfs.TestDFSInputStream |\r\n|   | hadoop.hdfs.server.namenode.TestAuditLogger |\r\n|   | hadoop.fs.viewfs.TestViewFsAtHdfsRoot |\r\n|   | hadoop.hdfs.client.impl.TestClientBlockVerification |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogRace |\r\n|   | hadoop.hdfs.server.namenode.TestAclConfigFlag |\r\n|   | hadoop.hdfs.tools.TestDFSHAAdminMiniCluster |\r\n|   | hadoop.metrics2.sink.TestRollingFileSystemSinkWithHdfs |\r\n|   | hadoop.hdfs.tools.TestViewFSStoragePolicyCommands |\r\n|   | hadoop.hdfs.TestFileAppend |\r\n|   | hadoop.hdfs.TestDFSAddressConfig |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotNameWithInvalidCharacters |\r\n|   | hadoop.hdfs.server.namenode.TestNestedEncryptionZones |\r\n|   | hadoop.hdfs.client.impl.TestBlockReaderLocal |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotBlocksMap |\r\n|   | hadoop.fs.viewfs.TestViewFsWithAcls |\r\n|   | hadoop.hdfs.tools.TestDelegationTokenFetcher |\r\n|   | hadoop.hdfs.server.namenode.ha.TestGetGroupsWithHA |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure110 |\r\n|   | hadoop.hdfs.TestLeaseRecoveryStriped |\r\n|   | hadoop.hdfs.server.diskbalancer.TestDiskBalancerRPC |\r\n|   | hadoop.hdfs.server.namenode.TestDefaultBlockPlacementPolicy |\r\n|   | hadoop.hdfs.server.namenode.TestSecondaryNameNodeUpgrade |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemWithTruncate |\r\n|   | hadoop.hdfs.TestFileLengthOnClusterRestart |\r\n|   | hadoop.hdfs.TestParallelShortCircuitReadUnCached |\r\n|   | hadoop.hdfs.server.namenode.ha.TestSeveralNameNodes |\r\n|   | hadoop.hdfs.server.namenode.TestCheckpoint |\r\n|   | hadoop.hdfs.TestAbandonBlock |\r\n|   | hadoop.hdfs.TestSafeModeWithStripedFile |\r\n|   | hadoop.hdfs.server.namenode.TestHDFSConcat |\r\n|   | hadoop.hdfs.TestFileChecksum |\r\n|   | hadoop.hdfs.server.namenode.TestListOpenFiles |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRetryCacheMetrics |\r\n|   | hadoop.hdfs.TestDatanodeReport |\r\n|   | hadoop.hdfs.shortcircuit.TestShortCircuitLocalRead |\r\n|   | hadoop.hdfs.server.namenode.TestCheckPointForSecurityTokens |\r\n|   | hadoop.hdfs.server.namenode.TestAllowFormat |\r\n|   | hadoop.hdfs.TestLeaseRecovery2 |\r\n|   | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\r\n|   | hadoop.hdfs.TestLargeBlock |\r\n|   | hadoop.hdfs.TestWriteBlockGetsBlockLengthHint |\r\n|   | hadoop.hdfs.TestGetBlocks |\r\n|   | hadoop.hdfs.client.impl.TestBlockReaderRemote |\r\n|   | hadoop.hdfs.server.federation.router.TestRouterRpc |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractPathHandle |\r\n|   | hadoop.hdfs.tools.offlineImageViewer.TestOfflineImageViewerWithStripedBlocks |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyBlockManagement |\r\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandbyWithQJM |\r\n|   | hadoop.hdfs.TestTrashWithEncryptionZones |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapRootDescendantDiff |\r\n|   | hadoop.hdfs.server.datanode.TestNNHandlesCombinedBlockReport |\r\n|   | hadoop.hdfs.TestDFSStripedInputStreamWithRandomECPolicy |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotFileLength |\r\n|   | hadoop.hdfs.server.federation.router.TestRouterRpcMultiDestination |\r\n|   | hadoop.hdfs.TestRollingUpgradeDowngrade |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeMXBean |\r\n|   | hadoop.hdfs.server.datanode.TestStorageReport |\r\n|   | hadoop.fs.TestEnhancedByteBufferAccess |\r\n|   | hadoop.hdfs.TestParallelShortCircuitLegacyRead |\r\n|   | hadoop.hdfs.TestFileStatus |\r\n|   | hadoop.tools.TestHdfsConfigFields |\r\n|   | hadoop.cli.TestErasureCodingCLI |\r\n|   | hadoop.hdfs.TestDFSMkdirs |\r\n|   | hadoop.hdfs.TestRead |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeErasureCodingMetrics |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureToleration |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAMetrics |\r\n|   | hadoop.hdfs.server.namenode.TestDiskspaceQuotaUpdate |\r\n|   | hadoop.hdfs.web.TestWebHdfsWithRestCsrfPreventionFilter |\r\n|   | hadoop.hdfs.TestHFlush |\r\n|   | hadoop.hdfs.server.namenode.TestReconstructStripedBlocks |\r\n|   | hadoop.hdfs.TestInjectionForSimulatedStorage |\r\n|   | hadoop.hdfs.server.diskbalancer.TestDiskBalancer |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyWriter |\r\n|   | hadoop.hdfs.TestApplyingStoragePolicy |\r\n|   | hadoop.hdfs.TestReadStripedFileWithMissingBlocks |\r\n|   | hadoop.hdfs.server.blockmanagement.TestPendingInvalidateBlock |\r\n|   | hadoop.hdfs.TestErasureCodingMultipleRacks |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotMetrics |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure020 |\r\n|   | hadoop.hdfs.TestDistributedFileSystem |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockTokenWithDFS |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlocksWithNotEnoughRacks |\r\n|   | hadoop.hdfs.server.namenode.ha.TestDFSUpgradeWithHA |\r\n|   | hadoop.hdfs.TestParallelShortCircuitReadNoChecksum |\r\n|   | hadoop.hdfs.TestBlockMissingException |\r\n|   | hadoop.hdfs.TestReplaceDatanodeFailureReplication |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractSeek |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyPersistReplicaPlacement |\r\n|   | hadoop.hdfs.TestExtendedAcls |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure130 |\r\n|   | hadoop.hdfs.TestDFSShell |\r\n|   | hadoop.hdfs.server.namenode.TestXAttrConfigFlag |\r\n|   | hadoop.hdfs.TestEncryptionZonesWithKMS |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractRootDirectory |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestInterDatanodeProtocol |\r\n|   | hadoop.hdfs.tools.TestDFSAdminWithHA |\r\n|   | hadoop.hdfs.TestDFSInotifyEventInputStreamKerberized |\r\n|   | hadoop.hdfs.server.namenode.TestLargeDirectoryDelete |\r\n|   | hadoop.fs.viewfs.TestViewFsDefaultValue |\r\n|   | hadoop.hdfs.tools.TestGetGroups |\r\n|   | hadoop.hdfs.server.namenode.web.resources.TestWebHdfsCreatePermissions |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestDisallowModifyROSnapshot |\r\n|   | hadoop.hdfs.TestReadStripedFileWithDecodingCorruptData |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestINodeFileUnderConstructionWithSnapshot |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemWithAcls |\r\n|   | hadoop.hdfs.server.datanode.web.TestDatanodeHttpXFrame |\r\n|   | hadoop.hdfs.TestRestartDFS |\r\n|   | hadoop.fs.TestWebHdfsFileContextMainOperations |\r\n|   | hadoop.hdfs.TestErasureCodeBenchmarkThroughput |\r\n|   | hadoop.metrics2.sink.TestRollingFileSystemSinkWithSecureHdfs |\r\n|   | hadoop.hdfs.TestDatanodeLayoutUpgrade |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAFsck |\r\n|   | hadoop.hdfs.server.federation.router.TestRouterRPCClientRetries |\r\n|   | hadoop.hdfs.server.datanode.TestFsDatasetCacheRevocation |\r\n|   | hadoop.hdfs.server.namenode.TestFileContextAcl |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemLinkFallback |\r\n|   | hadoop.hdfs.TestFileCreationEmpty |\r\n|   | hadoop.hdfs.server.datanode.TestBlockReplacement |\r\n|   | hadoop.hdfs.server.namenode.TestFSNamesystemMBean |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeExit |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockManager |\r\n|   | hadoop.hdfs.server.namenode.TestAuditLogs |\r\n|   | hadoop.hdfs.server.namenode.TestSecurityTokenEditLog |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRpcServerMethods |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithEncryptedTransfer |\r\n|   | hadoop.hdfs.TestDataTransferProtocol |\r\n|   | hadoop.hdfs.server.blockmanagement.TestComputeInvalidateWork |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshottableDirListing |\r\n|   | hadoop.hdfs.server.namenode.TestDeleteRace |\r\n|   | hadoop.hdfs.TestHDFSTrash |\r\n|   | hadoop.hdfs.TestLocalDFS |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeXAttr |\r\n|   | hadoop.hdfs.server.blockmanagement.TestOverReplicatedBlocks |\r\n|   | hadoop.hdfs.TestDFSFinalize |\r\n|   | hadoop.hdfs.server.namenode.TestAddOverReplicatedStripedBlocks |\r\n|   | hadoop.hdfs.TestListFilesInDFS |\r\n|   | hadoop.hdfs.server.datanode.TestNNHandlesBlockReportPerStorage |\r\n|   | hadoop.hdfs.client.impl.TestBlockReaderFactory |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithRandomECPolicy |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureReporting |\r\n|   | hadoop.hdfs.TestMiniDFSCluster |\r\n|   | hadoop.cli.TestAclCLI |\r\n|   | hadoop.hdfs.server.namenode.TestStorageRestore |\r\n|   | hadoop.hdfs.server.namenode.TestGenericJournalConf |\r\n|   | hadoop.hdfs.server.namenode.ha.TestPipelinesFailover |\r\n|   | hadoop.hdfs.TestGetFileChecksum |\r\n|   | hadoop.hdfs.tools.TestDFSAdmin |\r\n|   | hadoop.hdfs.server.namenode.TestFSImageWithAcl |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure150 |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractConcat |\r\n|   | hadoop.hdfs.TestDatanodeDeath |\r\n|   | hadoop.hdfs.TestDFSStripedInputStream |\r\n|   | hadoop.hdfs.server.namenode.TestAuditLoggerWithCommands |\r\n|   | hadoop.hdfs.TestReconstructStripedFile |\r\n|   | hadoop.hdfs.server.blockmanagement.TestSequentialBlockId |\r\n|   | hadoop.fs.shell.TestHdfsTextCommand |\r\n|   | hadoop.hdfs.server.blockmanagement.TestHeartbeatHandling |\r\n|   | hadoop.hdfs.TestDFSRename |\r\n|   | hadoop.hdfs.server.diskbalancer.TestConnectors |\r\n|   | hadoop.hdfs.qjournal.TestNNWithQJM |\r\n|   | hadoop.hdfs.TestBlockStoragePolicy |\r\n|   | hadoop.hdfs.TestPersistBlocks |\r\n|   | hadoop.hdfs.server.blockmanagement.TestSlowDiskTracker |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure080 |\r\n|   | hadoop.hdfs.TestDatanodeConfig |\r\n|   | hadoop.fs.viewfs.TestViewFsWithXAttrs |\r\n|   | hadoop.hdfs.TestDFSStorageStateRecovery |\r\n|   | hadoop.hdfs.TestClose |\r\n|   | hadoop.hdfs.web.TestWebHDFSXAttr |\r\n|   | hadoop.hdfs.server.namenode.TestEditLog |\r\n|   | hadoop.fs.TestSymlinkHdfsFileContext |\r\n|   | hadoop.hdfs.server.namenode.TestAddBlock |\r\n|   | hadoop.hdfs.TestRollingUpgradeRollback |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyPersistFiles |\r\n|   | hadoop.hdfs.TestModTime |\r\n|   | hadoop.TestRefreshCallQueue |\r\n|   | hadoop.hdfs.server.blockmanagement.TestPendingReconstruction |\r\n|   | hadoop.hdfs.server.namenode.TestParallelImageWrite |\r\n|   | hadoop.fs.TestFcHdfsSetUMask |\r\n|   | hadoop.hdfs.TestMultiThreadedHflush |\r\n|   | hadoop.hdfs.tools.TestDebugAdmin |\r\n|   | hadoop.hdfs.TestUnsetAndChangeDirectoryEcPolicy |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailureWithRandomECPolicy |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure070 |\r\n|   | hadoop.hdfs.web.TestHttpsFileSystem |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemWithXAttrs |\r\n|   | hadoop.hdfs.TestQuota |\r\n|   | hadoop.hdfs.server.namenode.TestTransferFsImage |\r\n|   | hadoop.hdfs.server.namenode.TestGetContentSummaryWithPermission |\r\n|   | hadoop.hdfs.TestSetrepDecreasing |\r\n|   | hadoop.hdfs.server.namenode.TestCommitBlockWithInvalidGenStamp |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeReconfigure |\r\n|   | hadoop.hdfs.server.federation.router.TestRouterNamenodeMonitoring |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeInitStorage |\r\n|   | hadoop.hdfs.web.TestFSMainOperationsWebHdfs |\r\n|   | hadoop.hdfs.server.datanode.TestBatchIbr |\r\n|   | hadoop.tracing.TestTracingShortCircuitLocalRead |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRpcServer |\r\n|   | hadoop.hdfs.TestDecommission |\r\n|   | hadoop.hdfs.server.blockmanagement.TestSequentialBlockGroupId |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeUUID |\r\n|   | hadoop.hdfs.TestErasureCodingPolicyWithSnapshotWithRandomECPolicy |\r\n|   | hadoop.hdfs.server.namenode.TestBlockUnderConstruction |\r\n|   | hadoop.cli.TestCacheAdminCLI |\r\n|   | hadoop.hdfs.TestDFSShellGenericOptions |\r\n|   | hadoop.hdfs.TestDataStream |\r\n|   | hadoop.tracing.TestTraceAdmin |\r\n|   | hadoop.hdfs.TestSetTimes |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotDiffReport |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure030 |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestWriteToReplica |\r\n|   | hadoop.hdfs.server.federation.router.TestRouterQuota |\r\n|   | hadoop.hdfs.server.mover.TestMover |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStream |\r\n|   | hadoop.fs.loadGenerator.TestLoadGenerator |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHASafeMode |\r\n|   | hadoop.hdfs.server.namenode.TestINodeFile |\r\n|   | hadoop.hdfs.server.namenode.TestFavoredNodesEndToEnd |\r\n|   | hadoop.hdfs.TestParallelUnixDomainRead |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerRPCDelay |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogAutoroll |\r\n|   | hadoop.hdfs.client.impl.TestBlockReaderLocalLegacy |\r\n|   | hadoop.hdfs.TestSmallBlock |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractCreate |\r\n|   | hadoop.hdfs.TestDFSClientRetries |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestFileContextSnapshot |\r\n|   | hadoop.hdfs.server.datanode.TestTransferRbw |\r\n|   | hadoop.hdfs.TestDisableConnCache |\r\n|   | hadoop.hdfs.server.blockmanagement.TestReplicationPolicyWithNodeGroup |\r\n|   | hadoop.fs.TestSymlinkHdfsFileSystem |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotStatsMXBean |\r\n|   | hadoop.hdfs.TestIsMethodSupported |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemAtHdfsRoot |\r\n|   | hadoop.cli.TestDeleteCLI |\r\n|   | hadoop.fs.TestFcHdfsPermission |\r\n|   | hadoop.hdfs.server.blockmanagement.TestReplicationPolicyWithUpgradeDomain |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure060 |\r\n|   | hadoop.hdfs.TestErasureCodingExerciseAPIs |\r\n|   | hadoop.hdfs.server.datanode.TestRefreshNamenodes |\r\n|   | hadoop.hdfs.TestFsShellPermission |\r\n|   | hadoop.hdfs.TestDatanodeStartupFixesLegacyStorageIDs |\r\n|   | hadoop.hdfs.server.datanode.TestLargeBlockReport |\r\n|   | hadoop.fs.TestSymlinkHdfsDisable |\r\n|   | hadoop.hdfs.server.namenode.TestProcessCorruptBlocks |\r\n|   | hadoop.hdfs.server.datanode.TestDiskError |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestUpdatePipelineWithSnapshots |\r\n|   | hadoop.hdfs.TestSeekBug |\r\n|   | hadoop.hdfs.web.TestWebHdfsTokens |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotRename |\r\n|   | hadoop.hdfs.TestReplaceDatanodeOnFailure |\r\n|   | hadoop.hdfs.server.federation.store.driver.TestStateStoreFileSystem |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure140 |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestOpenFilesWithSnapshot |\r\n|   | hadoop.hdfs.server.datanode.TestDirectoryScanner |\r\n|   | hadoop.hdfs.server.datanode.TestBlockCountersInPendingIBR |\r\n|   | hadoop.hdfs.server.namenode.TestMalformedURLs |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestSnapshotDeletion |\r\n|   | hadoop.hdfs.crypto.TestHdfsCryptoStreams |\r\n|   | hadoop.hdfs.server.namenode.TestNamenodeStorageDirectives |\r\n|   | hadoop.hdfs.server.namenode.TestNNThroughputBenchmark |\r\n|   | hadoop.hdfs.server.namenode.TestFileContextXAttr |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithMultipleNameNodes |\r\n|   | hadoop.hdfs.TestFileAppend4 |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure010 |\r\n|   | hadoop.hdfs.server.blockmanagement.TestNodeCount |\r\n|   | hadoop.hdfs.server.namenode.TestFSEditLogLoader |\r\n|   | hadoop.hdfs.server.mover.TestStorageMover |\r\n|   | hadoop.hdfs.TestDistributedFileSystemWithECFile |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure100 |\r\n|   | hadoop.hdfs.tools.TestDFSZKFailoverController |\r\n|   | hadoop.hdfs.server.federation.router.TestNamenodeHeartbeat |\r\n|   | hadoop.cli.TestCryptoAdminCLI |\r\n|   | hadoop.hdfs.TestMissingBlocksAlert |\r\n|   | hadoop.hdfs.server.namenode.TestAddBlockRetry |\r\n|   | hadoop.hdfs.TestEncryptionZonesWithHA |\r\n|   | hadoop.hdfs.server.namenode.TestSecondaryWebUi |\r\n|   | hadoop.hdfs.server.namenode.TestFSImage |\r\n|   | hadoop.hdfs.server.diskbalancer.command.TestDiskBalancerCommand |\r\n|   | hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeRespectsBindHostKeys |\r\n|   | hadoop.hdfs.TestCrcCorruption |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |\r\n|   | hadoop.security.TestPermission |\r\n|   | hadoop.hdfs.server.namenode.TestLeaseManager |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure090 |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeResourceChecker |\r\n|   | hadoop.cli.TestHDFSCLI |\r\n|   | hadoop.hdfs.server.namenode.TestDeadDatanode |\r\n|   | hadoop.fs.TestSWebHdfsFileContextMainOperations |\r\n|   | hadoop.hdfs.TestSafeMode |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestNestedSnapshots |\r\n|   | hadoop.hdfs.server.namenode.TestNNStorageRetentionFunctional |\r\n|   | hadoop.hdfs.server.blockmanagement.TestAvailableSpaceBlockPlacementPolicy |\r\n|   | hadoop.hdfs.server.namenode.TestQuotaByStorageType |\r\n|   | hadoop.hdfs.TestReadStripedFileWithDNFailure |\r\n|   | hadoop.hdfs.TestFSInputChecker |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractGetFileStatus |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestXAttrWithSnapshot |\r\n|   | hadoop.hdfs.server.namenode.TestFSDirectory |\r\n|   | hadoop.hdfs.TestRollingUpgrade |\r\n|   | hadoop.hdfs.server.namenode.TestAddStripedBlocks |\r\n|   | hadoop.hdfs.TestFileCreationClient |\r\n|   | hadoop.hdfs.server.federation.router.TestRouterMountTable |\r\n|   | hadoop.hdfs.server.namenode.TestNamenodeRetryCache |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestFsDatasetImpl |\r\n|   | hadoop.hdfs.TestAclsEndToEnd |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHAStateTransitions |\r\n|   | hadoop.hdfs.server.namenode.TestFsck |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractMkdir |\r\n|   | hadoop.fs.contract.hdfs.TestHDFSContractDelete |\r\n|   | hadoop.hdfs.TestWriteReadStripedFile |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestSpaceReservation |\r\n|   | hadoop.hdfs.TestBalancerBandwidth |\r\n|   | hadoop.hdfs.server.datanode.TestIncrementalBlockReports |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure040 |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStandbyIsHot |\r\n|   | hadoop.hdfs.TestErasureCodingPoliciesWithRandomECPolicy |\r\n|   | hadoop.hdfs.TestFSOutputSummer |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure120 |\r\n|   | hadoop.hdfs.web.TestWebHDFSForHA |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeTransferSocketSize |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeMetrics |\r\n|   | hadoop.hdfs.TestSnapshotCommands |\r\n|   | hadoop.hdfs.server.datanode.TestDeleteBlockPool |\r\n|   | hadoop.hdfs.server.namenode.TestFSImageWithSnapshot |\r\n|   | hadoop.hdfs.TestHDFSServerPorts |\r\n|   | hadoop.hdfs.server.blockmanagement.TestReconstructStripedBlocksWithRackAwareness |\r\n|   | hadoop.hdfs.tools.TestStoragePolicyCommands |\r\n|   | hadoop.hdfs.TestClientProtocolForPipelineRecovery |\r\n|   | hadoop.hdfs.server.namenode.ha.TestStateTransitionFailure |\r\n|   | hadoop.hdfs.qjournal.TestSecureNNWithQJM |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeMetrics |\r\n|   | hadoop.hdfs.server.namenode.ha.TestHarFileSystemWithHA |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure050 |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestDiffListBySkipList |\r\n|   | hadoop.hdfs.server.namenode.ha.TestBootstrapStandby |\r\n|   | hadoop.hdfs.server.blockmanagement.TestBlockStatsMXBean |\r\n|   | hadoop.hdfs.TestConnCache |\r\n|   | hadoop.hdfs.server.namenode.TestDecommissioningStatus |\r\n|   | hadoop.hdfs.TestDFSUpgrade |\r\n|   | hadoop.hdfs.web.TestWebHDFSAcl |\r\n|   | hadoop.hdfs.TestErasureCodingPolicyWithSnapshot |\r\n|   | hadoop.fs.TestResolveHdfsSymlink |\r\n|   | hadoop.hdfs.TestFileCreationDelete |\r\n|   | hadoop.hdfs.web.TestWebHdfsWithAuthenticationFilter |\r\n|   | hadoop.hdfs.server.namenode.TestMetaSave |\r\n|   | hadoop.hdfs.TestMaintenanceState |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestRandomOpsWithSnapshots |\r\n|   | hadoop.cli.TestAclCLIWithPosixAclInheritance |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure210 |\r\n|   | hadoop.hdfs.TestRenameWhileOpen |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestProvidedImpl |\r\n|   | hadoop.hdfs.server.balancer.TestBalancerWithNodeGroup |\r\n|   | hadoop.hdfs.TestDatanodeRegistration |\r\n|   | hadoop.hdfs.TestDFSOutputStream |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestAclWithSnapshot |\r\n|   | hadoop.hdfs.TestPipelines |\r\n|   | hadoop.hdfs.server.namenode.TestNamenodeCapacityReport |\r\n|   | hadoop.hdfs.TestFileConcurrentReader |\r\n|   | hadoop.hdfs.server.namenode.TestFileTruncate |\r\n|   | hadoop.hdfs.server.diskbalancer.TestDiskBalancerWithMockMover |\r\n|   | hadoop.hdfs.TestSetrepIncreasing |\r\n|   | hadoop.hdfs.server.namenode.snapshot.TestGetContentSummaryWithSnapshot |\r\n|   | hadoop.hdfs.TestBlocksScheduledCounter |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeLifeline |\r\n|   | hadoop.hdfs.server.datanode.TestIncrementalBrVariations |\r\n|   | hadoop.hdfs.web.TestWebHDFS |\r\n|   | hadoop.hdfs.server.namenode.TestBackupNode |\r\n|   | hadoop.hdfs.server.datanode.fsdataset.impl.TestLazyPersistLockedMemory |\r\n|   | hadoop.hdfs.TestPread |\r\n|   | hadoop.fs.viewfs.TestViewFileSystemLinkMergeSlash |\r\n|   | hadoop.hdfs.server.namenode.TestEditLogJournalFailures |\r\n|   | hadoop.hdfs.server.namenode.TestFSImageWithXAttr |\r\n|   | hadoop.hdfs.TestSafeModeWithStripedFileWithRandomECPolicy |\r\n|   | hadoop.hdfs.server.datanode.TestBlockScanner |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:d4cc50f |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12913379/HDFS-13243-v1.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 83a2795217aa 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 58ea2d7 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23332/artifact/out/diff-checkstyle-hadoop-hdfs-project.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23332/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23332/testReport/ |\r\n| asflicense | https://builds.apache.org/job/PreCommit-HDFS-Build/23332/artifact/out/patch-asflicense-problems.txt |\r\n| Max. process+thread count | 3576 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23332/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-07T14:03:50.408+0000","updated":"2018-03-07T14:03:50.408+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16390772","id":"16390772","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"Attach v2 patch to fix NoSuchMethodException","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-08T05:19:58.706+0000","updated":"2018-03-08T05:19:58.706+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16390962","id":"16390962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 33s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 18s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m 49s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 13m 11s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  2m 53s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  2m 57s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 15m 25s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m 51s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  2m 18s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 17s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  2m 12s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 13m  5s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 13m  5s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  2m 38s{color} | {color:orange} root: The patch generated 73 new + 670 unchanged - 2 fixed = 743 total (was 672) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  2m 58s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  9m 16s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  5m 21s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  2m 24s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 30s{color} | {color:green} hadoop-common in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 41s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}139m 12s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  1m 11s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}243m 47s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.server.namenode.ha.TestRetryCacheWithHA |\r\n|   | hadoop.hdfs.web.TestWebHdfsTimeouts |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailure |\r\n|   | hadoop.tools.TestHdfsConfigFields |\r\n|   | hadoop.hdfs.server.datanode.TestDataNodeVolumeFailureReporting |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:d4cc50f |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12913521/HDFS-13243-v2.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 01ce3c0c5167 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 583f459 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23346/artifact/out/diff-checkstyle-root.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23346/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23346/testReport/ |\r\n| Max. process+thread count | 3618 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-common-project/hadoop-common hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: . |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23346/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-08T09:24:23.730+0000","updated":"2018-03-08T09:24:23.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16391178","id":"16391178","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~gzh1992n] thanks very much for reporting the issue. The NN log is useful too.\r\n\r\nI looked at the patch & log andÂ tried to understand where the problem is. I don't think I understand the problem fully, but here are some of the thoughts that I'd like to share with you.\r\n # It seems to me the root of problem is that client would call fsync() with an incorrect length (shorter than what it is supposed to sync). If that's the caseÂ you should fix the client (DFSOutputStream), rather than the NameNode.\r\n # Looking at the log, your minimal replication number is 2, rather than 1. That's very unusual. In my past experience a lot of weird behavior like this could arise when you have that kind of configuration.\r\n # And why is close() in the picture? IMHO you don't even need to close(). Suppose you block DataNode heartbeat, and let client keep the file open and then call sync(), the last block's state remains in COMMITTED. Would that cause the same behavior?\r\n # Looking at the patch, I would like to ask you to stay away from using reflection. You could refactor FSNamesystem and DFSOutputStream to return a new FSNamesystem/DFSOutputStream object and override them in the test code. That way, you don't need to introduce new configurations too. And it'll be much cleaner.\r\n # I don't understand the following code.Â \r\n ## ifÂ lastBlockLength <= 0 || lastBlockLength <= b.getNumBytes() is unexpected. You should not just log a debug message and ignore it. It's got to be a WARN level message. You should also log the size of b.getNumBytes() as well. There's also a grammatical error in the log message too.\r\n ## If your fix is correct, you should updateÂ the assertion in FileUnderConstructionFeature#updateLengthOfLastBlock() so it expects neither COMMITTED nor COMPLETE.\r\n ## What should it do when block state is unexpected? IÂ don't think you should just ignore it.\r\n\r\n{code:java}\r\n BlockInfo b = pendingFile.getLastBlock();\r\n if (lastBlockLength <= 0 || lastBlockLength <= b.getNumBytes()) {\r\n LOG.debug(\"lastBlockLength(\" + lastBlockLength + \") seems wrong, maybe have a bug here?\");\r\n return;\r\n }\r\n\r\n if (b.getBlockUCState() != BlockUCState.COMMITTED &&\r\n b.getBlockUCState() != BlockUCState.COMPLETE) {{code}\r\nÂ \r\n\r\nÂ ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-08T12:33:09.768+0000","updated":"2018-03-08T12:39:11.575+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16392309","id":"16392309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"{{[~jojochuang], Thanks for reviewing.}}\r\n\r\n{quote}\r\n1.It seems to me the root of problem is that client would call fsync() with an incorrect length (shorter than what it is supposed to sync). If that's the caseÂ you should fix the client (DFSOutputStream), rather than the NameNode.\r\n{quote}\r\n\r\nClient call sync() with a *corrent* length, but sync request could be sent after close().\r\nThe root cause is that DFSOutputStream#flushOrSync() is not thread-safe. See following simplified code:\r\n\r\nÂ \r\n{code:java}\r\nsynchronized (this) {}\r\n ... // code before send request\r\n}\r\n\r\n// **We send request here, but it's not included in synchronized code block**\r\n if (getStreamer().getPersistBlocks().getAndSet(false) || updateLength) {\r\n   try {\r\n\r\n   dfsClient.namenode.fsync(src, fileId, dfsClient.clientName, lastBlockLength); \r\n\r\n   } catch (IOException ioe) {\r\n   // Deal with ioe\r\n   }\r\n}\r\n\r\nsynchronized (this) {\r\n  ... // code after send request\r\n}\r\n{code}\r\n\r\n\r\n{quote}\r\n2. Looking at the log, your minimal replication number is 2, rather than 1. That's very unusual. In my past experience a lot of weird behavior like this could arise when you have that kind of configuration.\r\n{quote}\r\nI'm not sure that data reliability would be affectedÂ  ifÂ minimalÂ replication set to 1. Do you have someÂ experience about this\r\n\r\n{quote}\r\n3.And why is close() in the picture? IMHO you don't even need to close(). Suppose you block DataNode heartbeat, and let client keep the file open and then call sync(), the last block's state remains in COMMITTED. Would that cause the same behavior?\r\n{quote}\r\nclose() must be called after sync(see above root cause). If you don't call close(), the last block's state can't change toÂ COMMITTED, right?Â \r\n\r\n{quote}\r\n4.Looking at the patch, I would like to ask you to stay away from using reflection. You could refactor FSNamesystem and DFSOutputStream to return a new FSNamesystem/DFSOutputStream object and override them in the test code. That way, you don't need to introduce new configurations too. And it'll be much cleaner.\r\n{quote}\r\nI don'tÂ understand this. There is no API thatÂ set impl ofÂ FSNamesystem in MiniCluster. Could you give me a sample in another test case? I will rewrite this patch.\r\n\r\n{quote}\r\n5.I don't understand the following code.\r\n{quote}\r\nMy fixed code is not final version, because I don't know that whether DFSOutputStream#flushOrSync() impl is ok. We sent sync RPC without lock in client, maybe for performance benefit? If for aÂ benefit, we just fix server-side.If notï¼we need to fix both server-side and client.\r\nIn server-side, we could log warn for wrong length and throw exception for invalid state.Â Is this better than current version?\r\n\r\nÂ \r\n\r\nÂ ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-09T02:48:40.909+0000","updated":"2018-03-09T02:55:21.860+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16392581","id":"16392581","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=neef6","name":"neef6","key":"neef6","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34050","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"},"displayName":"neef6","active":true,"timeZone":"Etc/UTC"},"body":"Â \r\n{code:java}\r\n/**\r\n * The block is committed.<br>\r\n * The client reported that all bytes are written to data-nodes\r\n * with the given generation stamp and block length, but no \r\n * {@link ReplicaState#FINALIZED} \r\n * replicas has yet been reported by data-nodes themselves.\r\n */\r\nCOMMITTED;\r\n\r\nelse if (storedBlock.getNumBytes() != reported.getNumBytes()) {\r\n return new BlockToMarkCorrupt(storedBlock,\r\n \"block is \" + ucState + \" and reported length \" +\r\n reported.getNumBytes() + \" does not match \" +\r\n \"length in block map \" + storedBlock.getNumBytes(),\r\n Reason.SIZE_MISMATCH);\r\n{code}\r\nsync request is use to change the nn metadata?\r\n\r\nÂ \r\n\r\nÂ ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=neef6","name":"neef6","key":"neef6","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34050","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"},"displayName":"neef6","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-09T08:35:23.642+0000","updated":"2018-03-09T08:47:23.234+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16392812","id":"16392812","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~gzh1992n] thanks for the comments. That makes a lot more sense now.\r\n{quote}Client call sync() with aÂ *corrent*Â length, but sync request could be sent after close().\r\nThe root cause is that DFSOutputStream#flushOrSync() is not thread-safe. See following simplified code:\r\n{quote}\r\nIf the problem is client side race condition, I would recommend fixing it at client side. Suppose client calls fsync() but server ignores it because of the client race condition, doesn't that mean the block is not sync'ed? Client expects that if it calls fsync() and that if it does not throw an IOException, the call succeeds.\r\n\r\nÂ \r\n{quote}I'm not sure that data reliability would be affectedÂ  ifÂ minimalÂ replication set to 1. Do you have someÂ experience about this\r\n{quote}\r\nThis is a typical misunderstanding. Minimal replication is not replication factor. And setting minimal replication to 2 is not a well tested configuration, at leastÂ in CDH. I work for Cloudera and we have thousands of customers.Â Almost no use sets minimal replication factor to 2. There's just one that I am aware, and that customer reports quite a few tricky issues because of it.Â \r\n\r\nFile can not be closedÂ because DataNode block reports are not processed in time in a large cluster and you need two DNs reporting an updated block for it to become COMPLETE and get closed. Decommissioning does not complete at all due to a corner case ... etc.\r\n\r\nLong story short, I suspect this race condition happensÂ because of this unusual setting. (or makes it more prone to this bug)\r\n{quote}I don'tÂ understand this. There is no API thatÂ set impl ofÂ FSNamesystem in MiniCluster. Could you give me a sample in another test case? I will rewrite this patch.\r\n{quote}\r\nThere's none. But you can make one :)\r\n\r\nÂ \r\n{quote}In server-side, we could log warn for wrong length and throw exception for invalid state.Â Is this better than current version?\r\n{quote}\r\nThat sounds like a plan.\r\n\r\nÂ \r\n\r\nThank you\r\n\r\nÂ ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-09T12:33:02.741+0000","updated":"2018-03-09T12:33:02.741+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16392889","id":"16392889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"[~jojochuang]\r\n{quote}\r\nI suspect this race condition happens because of this unusual setting.(or makes it more prone to this bug)\r\n{quote}\r\nThe minimal replication is set to 1 in my test case. I agree that this unusual setting makes it more prone to this bug.\r\n\r\n{quote}\r\nIf the problem is client side race condition, I would recommend fixing it at client side.\r\n{quote}\r\nWe have to fix server-side as well. We have no power to let all users update their client code, right?\r\nI will write a new patch in several days, thanks for your advice. \r\n\r\nBTW, why don't we include dfsClient.namenode.fsync() into synchronized code block formerlyï¼Is this for performance benefitï¼If that, Is it necessary to fix the client?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-09T13:34:35.481+0000","updated":"2018-03-09T14:04:07.713+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16409969","id":"16409969","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"Reviewing the patch again,\r\n\r\nat first I thought we could mock the class. But it was called from a static method, so seems not easy. Instead, I suggest look into FsDatasetFactory, FsDatasetImpl and FsDatasetSpi<>#newInstance(), which is cleaner than the one in patch v2.\r\n\r\nÂ \r\n{quote}BTW, why don't we include dfsClient.namenode.fsync() into synchronized code block formerlyï¼Is this for performance benefitï¼If that, Is it necessary to fix the client?\r\n{quote}\r\nMaking a RPC call in a synchronized block seems like an anti-pattern.\r\n\r\nÂ ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-22T17:48:18.375+0000","updated":"2018-03-22T17:48:18.375+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16417165","id":"16417165","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |\r\n| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m  5s{color} | {color:red} HDFS-13243 does not apply to trunk. Rebase required? Wrong Branch? See https://wiki.apache.org/hadoop/HowToContribute for help. {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12916595/HDFS-13243-v3.patch |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23701/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T11:00:48.500+0000","updated":"2018-03-28T11:00:48.500+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16417167","id":"16417167","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi, [~jojochuang]\r\nI attached patch-v3. I move RPC call into synchronized code block. I try my best to let mock code clearly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-28T11:01:28.216+0000","updated":"2018-03-28T11:01:28.216+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16417198","id":"16417198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"Rebase patch-v3, attach v4.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-03-28T11:25:42.776+0000","updated":"2018-03-28T11:25:42.776+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16417288","id":"16417288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 20s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 10s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 27m 44s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 16m 43s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  9s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  2m  4s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 13m  7s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 44s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 19s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 10s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red}  0m 34s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} compile {color} | {color:red}  1m  4s{color} | {color:red} hadoop-hdfs-project in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  1m  4s{color} | {color:red} hadoop-hdfs-project in the patch failed. {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m  7s{color} | {color:orange} hadoop-hdfs-project: The patch generated 114 new + 853 unchanged - 2 fixed = 967 total (was 855) {color} |\r\n| {color:red}-1{color} | {color:red} mvnsite {color} | {color:red}  0m 36s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} shadedclient {color} | {color:red}  3m 16s{color} | {color:red} patch has errors when building and testing our client artifacts. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  0m 35s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} javadoc {color} | {color:red}  0m 45s{color} | {color:red} hadoop-hdfs-project_hadoop-hdfs generated 9 new + 1 unchanged - 0 fixed = 10 total (was 1) {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 34s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}  0m 37s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 21s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 79m 23s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:8620d2b |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12916598/HDFS-13243-v4.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux b890fdc614d5 3.13.0-143-generic #192-Ubuntu SMP Tue Feb 27 10:45:36 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 411993f |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/patch-compile-hadoop-hdfs-project.txt |\r\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/patch-compile-hadoop-hdfs-project.txt |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/diff-checkstyle-hadoop-hdfs-project.txt |\r\n| mvnsite | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/patch-mvnsite-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/patch-findbugs-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| javadoc | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/diff-javadoc-javadoc-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/testReport/ |\r\n| Max. process+thread count | 319 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23702/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T12:50:06.491+0000","updated":"2018-03-28T12:50:06.491+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16425326","id":"16425326","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"The patch did not compile, due to other patches. Triggered the precommit build again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-04T10:52:43.289+0000","updated":"2018-04-04T10:52:43.289+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16425384","id":"16425384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 20s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 29s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 22m 58s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 25s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 57s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 32s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 26s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m  8s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 14s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  8s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red}  0m 28s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} compile {color} | {color:red}  0m 46s{color} | {color:red} hadoop-hdfs-project in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  0m 46s{color} | {color:red} hadoop-hdfs-project in the patch failed. {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m  2s{color} | {color:orange} hadoop-hdfs-project: The patch generated 114 new + 853 unchanged - 2 fixed = 967 total (was 855) {color} |\r\n| {color:red}-1{color} | {color:red} mvnsite {color} | {color:red}  0m 28s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} shadedclient {color} | {color:red}  2m 58s{color} | {color:red} patch has errors when building and testing our client artifacts. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  0m 30s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} javadoc {color} | {color:red}  0m 42s{color} | {color:red} hadoop-hdfs-project_hadoop-hdfs generated 9 new + 1 unchanged - 0 fixed = 10 total (was 1) {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 29s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}  0m 28s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 18s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 68m 59s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:8620d2b |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12916598/HDFS-13243-v4.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 08f7bbe924cb 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / b779f4f |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_162 |\r\n| findbugs | v3.1.0-RC1 |\r\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/patch-compile-hadoop-hdfs-project.txt |\r\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/patch-compile-hadoop-hdfs-project.txt |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/diff-checkstyle-hadoop-hdfs-project.txt |\r\n| mvnsite | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/patch-mvnsite-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/patch-findbugs-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| javadoc | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/diff-javadoc-javadoc-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/testReport/ |\r\n| Max. process+thread count | 412 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23775/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-04T12:01:15.642+0000","updated":"2018-04-04T12:01:15.642+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16425716","id":"16425716","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"Code doesn't compile. Please rebase your patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-04T15:25:49.718+0000","updated":"2018-04-04T15:25:49.718+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16431670","id":"16431670","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"I have rebased. [~jojochuang]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-04-10T03:54:35.843+0000","updated":"2018-04-10T03:54:35.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16431686","id":"16431686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 13s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 27s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 25m  3s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 51s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 11s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 41s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 13m  7s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 22s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 11s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 10s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red}  0m 30s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} compile {color} | {color:red}  0m 53s{color} | {color:red} hadoop-hdfs-project in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} javac {color} | {color:red}  0m 53s{color} | {color:red} hadoop-hdfs-project in the patch failed. {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m 11s{color} | {color:orange} hadoop-hdfs-project: The patch generated 114 new + 853 unchanged - 2 fixed = 967 total (was 855) {color} |\r\n| {color:red}-1{color} | {color:red} mvnsite {color} | {color:red}  0m 31s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} shadedclient {color} | {color:red}  3m 27s{color} | {color:red} patch has errors when building and testing our client artifacts. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  0m 32s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:red}-1{color} | {color:red} javadoc {color} | {color:red}  0m 42s{color} | {color:red} hadoop-hdfs-project_hadoop-hdfs generated 9 new + 1 unchanged - 0 fixed = 10 total (was 1) {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 25s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}  0m 31s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 20s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 74m 37s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:8620d2b |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12918302/HDFS-13243-v5.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 7d90301283d0 3.13.0-139-generic #188-Ubuntu SMP Tue Jan 9 14:43:09 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 0006346 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_162 |\r\n| findbugs | v3.1.0-RC1 |\r\n| mvninstall | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/patch-compile-hadoop-hdfs-project.txt |\r\n| javac | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/patch-compile-hadoop-hdfs-project.txt |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/diff-checkstyle-hadoop-hdfs-project.txt |\r\n| mvnsite | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/patch-mvnsite-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| findbugs | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/patch-findbugs-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| javadoc | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/diff-javadoc-javadoc-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/testReport/ |\r\n| Max. process+thread count | 301 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23852/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-10T04:35:33.442+0000","updated":"2018-04-10T04:35:33.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16431991","id":"16431991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 33s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 28s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 23m 16s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 35s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 56s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 57s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 40s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 10s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 14s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  6s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 32s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 44s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 15m 44s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m  7s{color} | {color:orange} hadoop-hdfs-project: The patch generated 104 new + 853 unchanged - 2 fixed = 957 total (was 855) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 29s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m  3s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 20s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 11s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 28s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}103m 38s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 19s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}197m 35s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.web.TestWebHdfsTimeouts |\r\n|   | hadoop.hdfs.server.namenode.TestNameNodeMXBean |\r\n|   | hadoop.tools.TestHdfsConfigFields |\r\n|   | hadoop.hdfs.TestHFlush |\r\n|   | hadoop.hdfs.TestDFSStripedOutputStreamWithFailureWithRandomECPolicy |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:8620d2b |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12918321/HDFS-13243-v5.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux e737623ad762 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 0006346 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_162 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23854/artifact/out/diff-checkstyle-hadoop-hdfs-project.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23854/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23854/testReport/ |\r\n| Max. process+thread count | 3579 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23854/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-10T09:38:13.993+0000","updated":"2018-04-10T09:38:13.993+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16432621","id":"16432621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Zephyr, thanks for updating the patch.\r\n\r\nUnfortunately it looks likeÂ TestHFlush.hSyncUpdateLength_00 failed, and it is reproducible in my local machine.\r\n{noformat}\r\njava.lang.NullPointerException at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.fsync(FSNamesystem.java:3279)\r\n at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.fsync(NameNodeRpcServer.java:1414)\r\n at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.fsync(ClientNamenodeProtocolServerSideTranslatorPB.java:1026)\r\n at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)\r\n at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)\r\n at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)\r\n at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:872)\r\n at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:818)\r\n at java.security.AccessController.doPrivileged(Native Method)\r\n at javax.security.auth.Subject.doAs(Subject.java:422)\r\n at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)\r\n at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2678)\r\n{noformat}\r\nAlso, I am still not sure about the client side fix. It basically extends the synchronized block to make sure it holds lock while waiting for ack and calling fsync at NameNode. It is more intuitive for to me not hold lock while waiting for RPCs to return.\r\n\r\nThat aside, please refrain from using wild card import (DFSOutputStream.java)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jojochuang","name":"jojochuang","key":"jojochuang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jojochuang&avatarId=25508","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jojochuang&avatarId=25508","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jojochuang&avatarId=25508","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jojochuang&avatarId=25508"},"displayName":"Wei-Chiu Chuang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-10T17:26:08.987+0000","updated":"2018-04-10T17:27:31.611+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16433543","id":"16433543","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"I agree with you [~jojochuang]. Do not fix client side in path-v6, and I fix the failure of the test case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-04-11T08:01:23.202+0000","updated":"2018-04-11T08:01:23.202+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16433756","id":"16433756","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 25s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 28s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 23m  1s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 22s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  4s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 12m  2s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m  4s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 13s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m  9s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 32s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 15s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 15m 15s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m  3s{color} | {color:orange} hadoop-hdfs-project: The patch generated 104 new + 853 unchanged - 2 fixed = 957 total (was 855) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 29s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m  4s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 19s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  9s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 24s{color} | {color:green} hadoop-hdfs-client in the patch passed. {color} |\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}106m 37s{color} | {color:red} hadoop-hdfs in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 18s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}199m 33s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.hdfs.web.TestWebHdfsTimeouts |\r\n|   | hadoop.tools.TestHdfsConfigFields |\r\n|   | hadoop.hdfs.TestEncryptionZonesWithKMS |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:8620d2b |\r\n| JIRA Issue | HDFS-13243 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12918525/HDFS-13243-v6.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 36723dbe2d3f 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / b0aff8a |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_162 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HDFS-Build/23874/artifact/out/diff-checkstyle-hadoop-hdfs-project.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-HDFS-Build/23874/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/23874/testReport/ |\r\n| Max. process+thread count | 3290 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project |\r\n| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/23874/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-11T11:20:22.734+0000","updated":"2018-04-11T11:20:22.734+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16441312","id":"16441312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"Maybe I overlooked some details, but please summarize the problem.  As best I can tell:\r\n* thread1 is writing and closes the stream\r\n* thread2 is syncing the stream\r\n* thread1 calls commits the block with size 141232\r\n* thread2 fsyncs with size 2054413\r\n* DNs report block with size 2054413, marked corrupt\r\n\r\nAm I wrong?  If no, how on earth can the block be committed with a size _less_ than a racing fsync?  This sounds like a serious client-side issue.\r\n\r\nAgree the server-side logic needs to be improved.  Note that {{FileUnderConstructionFeature#updateLengthOfLastBlock}} guards against some of the invalid/malicious cases but unfortunately via asserts.  They don't need to be quasi-duplicated in this patch.\r\n\r\nWe cannot simply return success in some invalid cases: ie. fsync when the file has no blocks, size is negative, size is less than less synced/committed size.  That just masks bugs.\r\n\r\nAlso, we shouldn't need all the new factories.  The tests must verify that namesystem calls, in various specific orders, with specific arguments that are good/bad, either succeed or fail.  We can't rely on the behavior of writing to a stream to prove the correctness of the namesystem guarding against invalid input from the client.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2018-04-17T18:31:28.253+0000","updated":"2018-04-17T18:31:28.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16443630","id":"16443630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"Thank you for reviewingï¼[~daryn].\r\n\r\nThere are some mistakes in your summaries.\r\n{quote}\r\nthread1 is writing and closes the stream\r\nthread2 is syncing the stream\r\nthread1 calls commits the block with size -141232- 2054413\r\nthread2 fsyncs with size -2054413- 141232\r\nDNs report block with size 2054413, marked corrupt\r\n{quote}\r\n\r\n{quote}\r\nThis sounds like a serious client-side issue.\r\n{quote}\r\nYes, as I said above comments.\r\nClient call sync() with a corrent length, but sync request could be sent after close().\r\nThe root cause is that DFSOutputStream#flushOrSync() is not thread-safe. See following simplified code:\r\n{code}\r\nsynchronized (this) {}\r\n ... // code before send request\r\n}\r\n\r\n// **We send request here, but it's not included in synchronized code block**\r\n if (getStreamer().getPersistBlocks().getAndSet(false) || updateLength) {\r\n   try {\r\n\r\n   dfsClient.namenode.fsync(src, fileId, dfsClient.clientName, lastBlockLength); \r\n\r\n   } catch (IOException ioe) {\r\n   // Deal with ioe\r\n   }\r\n}\r\n\r\nsynchronized (this) {\r\n  ... // code after send request\r\n}\r\n{code}\r\n\r\nI am not sure how to fix client-side. Cloud we put RPC into synchronized code block directly?\r\nMaybe we put RPC outside synchronized code block can get more performance benefit.\r\n\r\n{quote}\r\nWe cannot simply return success in some invalid cases: ie. fsync when the file has no blocks, size is negative, size is less than less synced/committed size. That just masks bugs.\r\n{quote}\r\nTestHFlush.hSyncUpdateLength_00 make an sync call with no blocks. So I don't think this is a bug case.\r\n\r\n{quote}\r\nAlso, we shouldn't need all the new factories. The tests must verify that namesystem calls, in various specific orders, with specific arguments that are good/bad, either succeed or fail. \r\n{quote}\r\n\r\nI can add new test cases to verify namesystem calls in various specific orders. \r\nI have to mock DFSOutputStream to reappear bus about corrupt blocks, so I need all the new factories. If mock DFSOutputStream is not necessary in your opinion, I will remove it. \r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gzh1992n","name":"gzh1992n","key":"gzh1992n","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zephyr Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-04-19T07:05:50.727+0000","updated":"2018-04-19T07:05:50.727+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143206/comment/16595927","id":"16595927","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"[~gzh1992n]\r\n\r\nAs this jira is marked for 3.2 as a critical, cud u pls help to take this forward or move out if its not feasible to finish in coming weeks. 3.2 code freeze date isÂ nearby inÂ aÂ weeks. Kindly help to check the same.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-08-29T04:22:46.179+0000","updated":"2018-08-29T04:22:46.179+0000"}],"maxResults":25,"total":25,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-13243/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3qzhr:"}}