{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12732226","self":"https://issues.apache.org/jira/rest/api/2/issue/12732226","key":"HDFS-6827","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2014-08-06T08:59:06.969+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Aug 26 12:23:30 UTC 2014","customfield_12310420":"410255","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_1743493427_*|*_1_*:*_1_*:*_9003437_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-08-26T12:23:30.311+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-6827/watchers","watchCount":8,"isWatching":false},"created":"2014-08-06T05:35:13.494+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":"zkfc","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326696","id":"12326696","description":"2.4.1 bug-fix release","name":"2.4.1","archived":false,"released":true,"releaseDate":"2014-06-30"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-08-26T12:23:30.350+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12316609","id":"12316609","name":"ha","description":"High Availability"}],"timeoriginalestimate":null,"description":"In our production cluster, we encounter a scenario like this: ANN crashed due to write journal timeout, and was restarted by the watchdog automatically, but after restarting both of the NNs are standby.\n\nFollowing is the logs of the scenario:\n# NN1 is down due to write journal timeout:\n{color:red}2014-08-03,23:02:02,219{color} INFO org.apache.hadoop.hdfs.server.namenode.NameNode: SHUTDOWN_MSG\n# ZKFC1 detected \"connection reset by peer\"\n{color:red}2014-08-03,23:02:02,560{color} ERROR org.apache.hadoop.security.UserGroupInformation: PriviledgedActionException as:xx@xx.HADOOP (auth:KERBEROS) cause:java.io.IOException: {color:red}Connection reset by peer{color}\n# NN1 wat restarted successfully by the watchdog:\n2014-08-03,23:02:07,884 INFO org.apache.hadoop.hdfs.server.namenode.NameNode: Web-server up at: xx:13201\n2014-08-03,23:02:07,884 INFO org.apache.hadoop.ipc.Server: IPC Server Responder: starting\n{color:red}2014-08-03,23:02:07,884{color} INFO org.apache.hadoop.ipc.Server: IPC Server listener on 13200: starting\n2014-08-03,23:02:08,742 INFO org.apache.hadoop.ipc.Server: RPC server clean thread started!\n2014-08-03,23:02:08,743 INFO org.apache.hadoop.hdfs.server.namenode.NameNode: Registered DFSClientInformation MBean\n2014-08-03,23:02:08,744 INFO org.apache.hadoop.hdfs.server.namenode.NameNode: NameNode up at: xx/xx:13200\n2014-08-03,23:02:08,744 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: Starting services required for standby state\n# ZKFC1 retried the connection and considered NN1 was healthy\n{color:red}2014-08-03,23:02:08,292{color} INFO org.apache.hadoop.ipc.Client: Retrying connect to server: xx/xx:13200. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=1, sleepTime=1 SECONDS)\n# ZKFC1 still considered NN1 as a healthy Active NN, and didn't trigger the failover, as a result, both NNs were standby.\n\nThe root cause of this bug is that NN is restarted too quickly and ZKFC health monitor doesn't realize that.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327181","id":"12327181","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12660080","id":"12660080","filename":"HDFS-6827.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-06T08:05:03.637+0000","size":12048,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12660080/HDFS-6827.1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"410245","customfield_12312823":null,"summary":"Both NameNodes stuck in STANDBY state due to HealthMonitor not aware of the target's status changing sometimes","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14087395","id":"14087395","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Submit a patch to fix this bug.\nBTW: The {{healthCheckLock}} is used to distinguish the graceful failover and the above scenario. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-06T08:07:46.455+0000","updated":"2014-08-06T08:07:46.455+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14087438","id":"14087438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12660080/HDFS-6827.1.patch\n  against trunk revision .\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-common-project/hadoop-common.\n\n    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HDFS-Build/7569//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-HDFS-Build/7569//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-06T08:59:06.969+0000","updated":"2014-08-06T08:59:06.969+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14090541","id":"14090541","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~arpitagarwal], can you help review this patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-08T09:43:04.863+0000","updated":"2014-08-08T09:43:04.863+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14101262","id":"14101262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stack","name":"stack","key":"stack","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"stack","active":true,"timeZone":"America/Los_Angeles"},"body":"This issue looks a little ugly.  NameNodes stuck in standby mode?  This production?  What did it look like?\n\nbq. BTW: The healthCheckLock is used to distinguish the graceful failover and the above scenario.\n\nI don't know this code well.  How is the above done?\n\nThe code in checkServiceStatus seems 'fragile' looking for a explicity transition. Is there a more explicit check that can be done to learn if 'service is restarted'?\n\nIn the below test, is it possible the state gets moved to standby before the service healthy check runs?  Would the test get stuck in this case?\n\n+      // fake svc0 is restarted and change to standby, but the health monitor\n+      // doesn't realize that\n+      svc0.proxy.transitionToStandby(new StateChangeRequestInfo(\n+          RequestSource.REQUEST_BY_ZKFC));\n+\n+      cluster.waitForHealthState(0, State.SERVICE_HEALTHY);\n+      cluster.waitForHealthState(1, State.SERVICE_HEALTHY);\n\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stack","name":"stack","key":"stack","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"stack","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-08-18T20:50:04.707+0000","updated":"2014-08-18T20:50:04.707+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14101725","id":"14101725","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~stack].\nbq. This issue looks a little ugly. NameNodes stuck in standby mode? This production? What did it look like?\nYes, both NameNodes stuck in standby mode, and the hbase cluster over it coundn't read/write any more.\nWe can reproduce the issue in the following way:\n1. Change the sleep time of {{Client#handleConnectionFailure()}} longer\n{code}\n     try {\n        Thread.sleep(action.delayMillis); // default is 1s, can change to 10s or longer\n      } catch (InterruptedException e) {\n        throw (IOException)new InterruptedIOException(\"Interrupted: action=\"\n            + action + \", retry policy=\" + connectionRetryPolicy).initCause(e);\n      }\n{code}\n2. Restart the active NameNode quickly, and ensure that the NameNode starts successfully before ZKFC retrying connect.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-19T02:11:37.067+0000","updated":"2014-08-19T02:11:37.067+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14101775","id":"14101775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"bq. BTW: The healthCheckLock is used to distinguish the graceful failover and the above scenario. \nbq. I don't know this code well. How is the above done?\nbq. The code in checkServiceStatus seems 'fragile' looking for a explicity transition. Is there a more explicit check that can be done to learn if 'service is restarted'?\nThe solution for this issue is to let the ZKFC learn 'service is restarted'. \n\nOne straightforward way is to add a field in the {{MonitorHealthResponseProto}} to identify that the service is restarted, for example the pid of the NN process, or a generated UUID will satisfy our requirement. Another way is to let the ZKFC learn 'service is restarted' by comparing the service's current state and last state. We choose the later one, in this way we can fix the problem inside ZKFC, don't influence other services. \n\nAs we know that ZKFC supports gracefully failover from the command line tool, and during graceful failover, the ZKFC may encounter a scenario like this: the last state of the service Active, the current is Standby, and the service is healthy. This scenario is just the same as the buggy scenario described above, we must distinguish these two scenarios. So we  add the {{healthCheckLock}} to 'fragile' the health checking when doing graceful failover.\n\nHope I expressed myself clearly:)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-19T02:52:28.950+0000","updated":"2014-08-19T02:52:28.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14101781","id":"14101781","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"bq. In the below test, is it possible the state gets moved to standby before the service healthy check runs? Would the test get stuck in this case?\nIt's not possible, the state is only changed during health checking or graceful failover, here's no graceful failover, so it's only changed by the health monitor. If the health monitor doesn't run, the state won't be moved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-19T03:18:29.097+0000","updated":"2014-08-19T03:18:29.097+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14102796","id":"14102796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stack","name":"stack","key":"stack","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"stack","active":true,"timeZone":"America/Los_Angeles"},"body":"Nice script for reproducing the issue.\n\nbq. The solution for this issue is to let the ZKFC learn 'service is restarted'.\n\nYes. Is there anything more definitive than a check for a particular state transition? (Sorry, don't know this area well).\n\nbq. One straightforward way is to add a field in the MonitorHealthResponseProto to identify that the service is restarted, for example the pid of the NN process, or a generated UUID will satisfy our requirement.\n\nThis seems less prone to misinterpretation.\n\nYour NN came up inside a second?\n\nA hacky workaround in meantime would have the NN start sleep first for a second?\n\nThanks for looking into this [~wuzesheng]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stack","name":"stack","key":"stack","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"stack","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-08-19T20:39:42.847+0000","updated":"2014-08-19T20:39:42.847+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103261","id":"14103261","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~stack]:)\n\nbq. Yes. Is there anything more definitive than a check for a particular state transition? (Sorry, don't know this area well).\nIf we want to fix the bug inside ZKFC, there's no other definitive indicator according to my current knowledge of ZKFC. \n\nbq. This seems less prone to misinterpretation.\nYes, this is more straightforward and less prone to misinterpretation. But change the {{MonitorHealthResponseProto}} proto may introduce an incompatible changing, if folks think this is acceptable, perhaps we can use this method.\n\nbq. Your NN came up inside a second?\nAs I described in the issue description, our NN came up inside about 6 seconds. 1 second for {{Client#handleConnectionFailure()}} sleep, the other 5 seconds for some unknown reasons, maybe GC or network problems, we haven't found direct evidences. \n\nbq. A hacky workaround in meantime would have the NN start sleep first for a second?\nYes,  we can let NN sleep sometime before startup. Indeed we use this method to quick fix the bug in our production cluster temporarily. But for a long term and general solution, we should fix this in the ZKFC side. One more thing, ZKFC is a general automatic HA failover framework, it is used in HDFS, but not only for HDFS, it may be used in other system who needs automatic HA failover. From this perspective, we should fix this inside ZKFC.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-20T02:11:47.717+0000","updated":"2014-08-20T02:11:47.717+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103278","id":"14103278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"bq. As I described in the issue description, our NN came up inside about 6 seconds. 1 second for Client#handleConnectionFailure() sleep, the other 5 seconds for some unknown reasons, maybe GC or network problems, we haven't found direct evidences.\n\nSorry, this description is not very accurate.\nOur NN came up inside about 6 seconds. And the ZKFC retried connection exactly after NN starting successfully. There are about 6 seconds between ZKFC detected 'Connection reset by peer' and reconnected NN successfully. 1 second for {{Client#handleConnectionFailure()}} sleep is definitely, the other 5 seconds for some unknown reasons, maybe GC or network problems, we haven't found direct evidences.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-20T02:26:56.450+0000","updated":"2014-08-20T02:26:56.450+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103485","id":"14103485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"You got this issue in 2.4.1 version?\nBy any chance.. Your issue is HADOOP-10251 ? This was not merged to 2.4.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-08-20T06:30:23.025+0000","updated":"2014-08-20T06:30:23.025+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103497","id":"14103497","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Verified that, added test in the patch passes without any code change in trunk.\nVerified again without the code change of HADOOP-10251, then it timeouts.\nSo I feel, HADOOP-10251 fixes the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-08-20T06:38:30.313+0000","updated":"2014-08-20T06:38:30.313+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103500","id":"14103500","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"I've looked into HADOOP-10251,  it's quite different from this issue.\nThe root cause of this issue is that ANN's ZKFC isn't aware that ANN is retarted and doesn't trigger failover.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-20T06:40:51.426+0000","updated":"2014-08-20T06:40:51.426+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103505","id":"14103505","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"[~vinayrpet], Can you verify according to the reproduce method as I described [here | https://issues.apache.org/jira/browse/HDFS-6827?focusedCommentId=14101725&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14101725]? \nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-20T06:46:04.424+0000","updated":"2014-08-20T06:46:04.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103515","id":"14103515","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"bq. The root cause of this issue is that ANN's ZKFC isn't aware that ANN is retarted and doesn't trigger failover.\nThis is fine. After HADOOP-10251, ZKFC will trigger failover based on the state check from the NameNode.\nfor ex: Active ZKFC expects its NN to be in ACTIVE state, but after restart of NN its STANDBY, (ZKFC need not know NN is restrarted and NN doesnot automatically comes to ACTIVE). So ZKFC quits the election, and re-election will happen for the new Active.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-08-20T06:53:06.424+0000","updated":"2014-08-20T06:53:06.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14103557","id":"14103557","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"I gone through your patch of HADOOP-10251.\n{code}\nprivate synchronized void setLastServiceStatus(HAServiceStatus status) {\n    this.lastServiceState = status;\n    for (ServiceStateCallback cb : serviceStateCallbacks) {\n      cb.reportServiceStatus(lastServiceState);\n    }\n  }\n{code}\nThe above method is only called by the {{HealthMonitor}}, so the state check will only be performed during the health check. How does your patch handle the following two scenarios(NN1 is Active, NN2 is standby):\n# NN1 is restarted, but ZKFC1 isn't aware of it, ZKFC1 thinks NN1 is healthy, last state is Active, current state is Standby\n# Do a graceful failover from the command line tool, ZKFC1 thinks NN1 is healthy, last state is Active, current state is Standby","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-20T07:31:52.147+0000","updated":"2014-08-20T07:31:52.147+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14105261","id":"14105261","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Ping [~vinayrpet]..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-21T09:55:52.485+0000","updated":"2014-08-21T09:55:52.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14105330","id":"14105330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~wuzesheng],\n\nPlease check the {{ZKFailOverController#verifyChangedServiceState(..)}} this will be called for every health check callback, which will happen every 1 sec by default.\nIn your case,\n1. Service is HEALTHY, even though NN was restarted within this 1 sec interval.\n2. But, after restart of NN, first healthcheck callback will identify state change of ANN in {{ZKFailOverController#verifyChangedServiceState(..)}} and ZKFC will quit the election marking {{quitElectionOnBadState}} to true. Now another STANDBY ZKFC will have a chance to become ACTIVE.\n3.  Next callback from healthcheck will call {{rechedElectability()}} which will in-turn make ZKFC to join the election back if the service is still HEALTHY. Meanwhile other ZKFC would have won the leader election and became ACTIVE.\n\nSo after HADOOP-10251, I feel your problem also will be solved. \nHave you tried same scenario in latest trunk code?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-08-21T12:10:05.343+0000","updated":"2014-08-21T12:10:05.343+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14105331","id":"14105331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Update: In point #2, quitting the election will happen on second healthcheck callback. two continuous callbacks will be checked before quitting election to make sure that state change differences are not coming due to parellel transition. And on third callback {{rechedElectability(..)}} will be called.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayrpet","name":"vinayrpet","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-08-21T12:15:35.506+0000","updated":"2014-08-21T12:15:35.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14106364","id":"14106364","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~vinayrpet], I will try the scenario in the latest trunk code soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-22T02:17:00.708+0000","updated":"2014-08-22T02:17:00.708+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14110645","id":"14110645","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"[~vinayrpet], I verified your patch of HADOOP-10251 on my cluster, it works as expected. Thanks.\nI will resolve this issue as 'duplicated'.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-26T12:22:33.640+0000","updated":"2014-08-26T12:22:33.640+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732226/comment/14110646","id":"14110646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"body":"Duplicate of HADOOP-10251.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wuzesheng","name":"wuzesheng","key":"wuzesheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Zesheng Wu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-26T12:23:30.343+0000","updated":"2014-08-26T12:23:30.343+0000"}],"maxResults":22,"total":22,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-6827/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1yl13:"}}