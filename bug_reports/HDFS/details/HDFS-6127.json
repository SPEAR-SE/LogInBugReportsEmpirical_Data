{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12702455","self":"https://issues.apache.org/jira/rest/api/2/issue/12702455","key":"HDFS-6127","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326143","id":"12326143","description":"2.4.0 release","name":"2.4.0","archived":false,"released":true,"releaseDate":"2014-04-07"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-03-19T22:50:29.143+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Mar 20 15:00:23 UTC 2014","customfield_12310420":"380794","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_39277941_*|*_1_*:*_1_*:*_4696618_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-03-20T07:05:48.763+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-6127/watchers","watchCount":6,"isWatching":false},"created":"2014-03-19T18:52:54.251+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326143","id":"12326143","description":"2.4.0 release","name":"2.4.0","archived":false,"released":true,"releaseDate":"2014-04-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-04-10T13:12:11.294+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12316609","id":"12316609","name":"ha","description":"High Availability"}],"timeoriginalestimate":null,"description":"{{TokenAspect}} class assumes that the service name of the token is alway a host-ip pair. In HA setup, however, the service name becomes the name service id, which breaks the assumption. As a result, WebHDFS tokens cannot be renewed in HA setup.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326143","id":"12326143","description":"2.4.0 release","name":"2.4.0","archived":false,"released":true,"releaseDate":"2014-04-07"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12635628","id":"12635628","filename":"HDFS-6127.000.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-19T20:11:03.238+0000","size":13569,"content":"https://issues.apache.org/jira/secure/attachment/12635628/HDFS-6127.000.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12635684","id":"12635684","filename":"HDFS-6127.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-19T23:39:14.426+0000","size":15051,"content":"https://issues.apache.org/jira/secure/attachment/12635684/HDFS-6127.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"381073","customfield_12312823":null,"summary":"WebHDFS tokens cannot be renewed in HA setup","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitgupta","name":"arpitgupta","key":"arpitgupta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Gupta","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitgupta","name":"arpitgupta","key":"arpitgupta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Gupta","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13940837","id":"13940837","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitgupta","name":"arpitgupta","key":"arpitgupta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Gupta","active":true,"timeZone":"America/Los_Angeles"},"body":"Here is the stack trace\n\n{code}\n/usr/lib/hadoop/bin/hadoop org.apache.hadoop.fs.slive.SliveTest -rename 14,uniform -packetSize 65536 -baseDir webhdfs://ha-2-secure/user/user/ha-slive -seed 12345678 -sleep 100,1000 -duration 600 -append 14,uniform -blockSize 16777216,33554432 -create 16,uniform -mkdir 14,uniform -maps 12 -ls 14,uniform -writeSize 1,134217728 -files 1024 -ops 10000 -read 14,uniform -replication 1,3 -appendSize 1,134217728 -reduces 6 -resFile /grid/0/tmp/hwqe/artifacts/ha-slive-00002-namenode2-1395127484.out -readSize 1,4294967295 -dirSize 16 -delete 14,uniform\nINFO|Initial wait for Service namenode2: 60\n14/03/18 07:24:44 INFO slive.SliveTest: Running with option list -rename 14,uniform -packetSize 65536 -baseDir webhdfs://ha-2-secure/user/user/ha-slive -seed 12345678 -sleep 100,1000 -duration 600 -append 14,uniform -blockSize 16777216,33554432 -create 16,uniform -mkdir 14,uniform -maps 12 -ls 14,uniform -writeSize 1,134217728 -files 1024 -ops 10000 -read 14,uniform -replication 1,3 -appendSize 1,134217728 -reduces 6 -resFile /grid/0/tmp/hwqe/artifacts/ha-slive-00002-namenode2-1395127484.out -readSize 1,4294967295 -dirSize 16 -delete 14,uniform\n14/03/18 07:24:44 INFO slive.SliveTest: Options are:\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Base directory = webhdfs://ha-2-secure/user/user/ha-slive/slive\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Data directory = webhdfs://ha-2-secure/user/user/ha-slive/slive/data\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Output directory = webhdfs://ha-2-secure/user/user/ha-slive/slive/output\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Result file = /grid/0/tmp/hwqe/artifacts/ha-slive-00002-namenode2-1395127484.out\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Grid queue = default\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Should exit on first error = false\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Duration = 600000 milliseconds\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Map amount = 12\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Reducer amount = 6\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Operation amount = 10000\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Total file limit = 1024\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Total dir file limit = 16\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Read size = 1,4294967295 bytes\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Write size = 1,134217728 bytes\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Append size = 1,134217728 bytes\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Block size = 16777216,33554432 bytes\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Random seed = 12345678\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Sleep range = 100,1000 milliseconds\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Replication amount = 1,3\n14/03/18 07:24:44 INFO slive.ConfigExtractor: Operations are:\n14/03/18 07:24:44 INFO slive.ConfigExtractor: READ\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  14%\n14/03/18 07:24:44 INFO slive.ConfigExtractor: APPEND\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  14%\n14/03/18 07:24:44 INFO slive.ConfigExtractor: MKDIR\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  14%\n14/03/18 07:24:44 INFO slive.ConfigExtractor: LS\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  14%\n14/03/18 07:24:44 INFO slive.ConfigExtractor: DELETE\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  14%\n14/03/18 07:24:44 INFO slive.ConfigExtractor: RENAME\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  14%\n14/03/18 07:24:44 INFO slive.ConfigExtractor: CREATE\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  UNIFORM\n14/03/18 07:24:44 INFO slive.ConfigExtractor:  16%\n14/03/18 07:24:44 INFO slive.SliveTest: Running job:\n14/03/18 07:24:44 WARN hdfs.DFSClient: dfs.client.test.drop.namenode.response.number is set to 1, this hacked client will proactively drop responses\n14/03/18 07:24:45 WARN hdfs.DFSClient: dfs.client.test.drop.namenode.response.number is set to 1, this hacked client will proactively drop responses\n14/03/18 07:24:45 WARN hdfs.DFSClient: dfs.client.test.drop.namenode.response.number is set to 1, this hacked client will proactively drop responses\n14/03/18 07:24:48 WARN token.Token: Cannot find class for token kind WEBHDFS delegation\n14/03/18 07:24:48 INFO security.TokenCache: Got dt for webhdfs://ha-2-secure; Kind: WEBHDFS delegation, Service: ha-hdfs:ha-2-secure, Ident: 00 06 68 72 74 5f 71 61 04 79 61 72 6e 00 8a 01 44 d4 14 0f d0 8a 01 44 f8 20 93 d0 0f 10\n14/03/18 07:24:49 INFO mapreduce.JobSubmitter: number of splits:12\n14/03/18 07:24:49 INFO Configuration.deprecation: mapred.job.queue.name is deprecated. Instead, use mapreduce.job.queuename\n14/03/18 07:24:49 INFO Configuration.deprecation: dfs.write.packet.size is deprecated. Instead, use dfs.client-write-packet-size\n14/03/18 07:24:49 INFO Configuration.deprecation: io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum\n14/03/18 07:24:49 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1395125245496_0006\n14/03/18 07:24:49 WARN token.Token: Cannot find class for token kind WEBHDFS delegation\n14/03/18 07:24:49 WARN token.Token: Cannot find class for token kind WEBHDFS delegation\nKind: WEBHDFS delegation, Service: ha-hdfs:ha-2-secure, Ident: 00 06 68 72 74 5f 71 61 04 79 61 72 6e 00 8a 01 44 d4 14 0f d0 8a 01 44 f8 20 93 d0 0f 10\n14/03/18 07:24:50 INFO impl.YarnClientImpl: Submitted application application_1395125245496_0006\n14/03/18 07:24:50 INFO mapreduce.JobSubmitter: Cleaning up the staging area /user/user/.staging/job_1395125245496_0006\n14/03/18 07:24:50 WARN security.UserGroupInformation: PriviledgedActionException as:user@REALM (auth:KERBEROS) cause:java.io.IOException: Failed to run job : Does not contain a valid host:port authority: ha-hdfs:ha-2-secure\n14/03/18 07:24:50 WARN security.UserGroupInformation: PriviledgedActionException as:user@REALM (auth:KERBEROS) cause:java.io.IOException: Failed to run job : Does not contain a valid host:port authority: ha-hdfs:ha-2-secure\n14/03/18 07:24:50 ERROR slive.SliveTest: Unable to run job due to error:\njava.io.IOException: Failed to run job : Does not contain a valid host:port authority: ha-hdfs:ha-2-secure\nat org.apache.hadoop.mapred.YARNRunner.submitJob(YARNRunner.java:300)\nat org.apache.hadoop.mapreduce.JobSubmitter.submitJobInternal(JobSubmitter.java:432)\nat org.apache.hadoop.mapreduce.Job$10.run(Job.java:1285)\nat org.apache.hadoop.mapreduce.Job$10.run(Job.java:1282)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.Subject.doAs(Subject.java:415)\nat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1548)\nat org.apache.hadoop.mapreduce.Job.submit(Job.java:1282)\nat org.apache.hadoop.mapred.JobClient$1.run(JobClient.java:562)\nat org.apache.hadoop.mapred.JobClient$1.run(JobClient.java:557)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.Subject.doAs(Subject.java:415)\nat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1548)\nat org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:557)\nat org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:548)\nat org.apache.hadoop.mapred.JobClient.runJob(JobClient.java:833)\nat org.apache.hadoop.fs.slive.SliveTest.runJob(SliveTest.java:204)\nat org.apache.hadoop.fs.slive.SliveTest.run(SliveTest.java:117)\nat org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)\nat org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:84)\nat org.apache.hadoop.fs.slive.SliveTest.main(SliveTest.java:314)\n14/03/18 07:24:50 WARN util.ShutdownHookManager: ShutdownHook 'ClientFinalizer' failed, java.lang.IllegalArgumentException: Does not contain a valid host:port authority: ha-hdfs:ha-2-secure\njava.lang.IllegalArgumentException: Does not contain a valid host:port authority: ha-hdfs:ha-2-secure\nat org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:211)\nat org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:163)\nat org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:152)\nat org.apache.hadoop.security.SecurityUtil.getTokenServiceAddr(SecurityUtil.java:347)\nat org.apache.hadoop.hdfs.web.TokenAspect$TokenManager.getInstance(TokenAspect.java:75)\nat org.apache.hadoop.hdfs.web.TokenAspect$TokenManager.cancel(TokenAspect.java:52)\nat org.apache.hadoop.security.token.Token.cancel(Token.java:387)\nat org.apache.hadoop.fs.DelegationTokenRenewer$RenewAction.cancel(DelegationTokenRenewer.java:152)\nat org.apache.hadoop.fs.DelegationTokenRenewer$RenewAction.access$200(DelegationTokenRenewer.java:58)\nat org.apache.hadoop.fs.DelegationTokenRenewer.removeRenewAction(DelegationTokenRenewer.java:241)\nat org.apache.hadoop.hdfs.web.TokenAspect.removeRenewAction(TokenAspect.java:154)\nat org.apache.hadoop.hdfs.web.WebHdfsFileSystem.close(WebHdfsFileSystem.java:922)\nat org.apache.hadoop.fs.FileSystem$Cache.closeAll(FileSystem.java:2488)\nat org.apache.hadoop.fs.FileSystem$Cache$ClientFinalizer.run(FileSystem.java:2505)\nat org.apache.hadoop.util.ShutdownHookManager$1.run(ShutdownHookManager.java:54)\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitgupta","name":"arpitgupta","key":"arpitgupta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Gupta","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-19T18:54:47.074+0000","updated":"2014-03-19T18:54:47.074+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941109","id":"13941109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12635628/HDFS-6127.000.patch\n  against trunk revision .\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 2 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.\n\n    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HDFS-Build/6444//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-HDFS-Build/6444//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-19T22:50:29.143+0000","updated":"2014-03-19T22:50:29.143+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941149","id":"13941149","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jingzhao","name":"jingzhao","key":"jingzhao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jing Zhao","active":true,"timeZone":"America/Los_Angeles"},"body":"The patch looks good to me. Some comments:\n# Nit: HAUtil#getServiceUriFromToken and TokenManager#getInstance need format.\n# javadoc of HAUtil#getServiceUriFromToken needs to be updated after the change: the method now can support URI of other FS, not just HDFS.\n# The change in TestWebhdfsForHA actually weakens our unit test, I think. We still need the fs.renew and fs.cancel for regression of HDFS-5339. A separate unit test with some code copy should be fine here, I guess.\n{code}\n-      fs.renewDelegationToken(token);\n-      fs.cancelDelegationToken(token);\n+      token.renew(conf);\n+      token.cancel(conf);\n{code}\n\n+1 after addressing the comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jingzhao","name":"jingzhao","key":"jingzhao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jing Zhao","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-19T23:15:25.651+0000","updated":"2014-03-19T23:15:25.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941171","id":"13941171","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jingzhao","name":"jingzhao","key":"jingzhao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jing Zhao","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. The change in TestWebhdfsForHA actually weakens our unit test, I think\nActually this will not, since in the end the fs.renew and fs.cancel will still be called. Thus please just ignore this comment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jingzhao","name":"jingzhao","key":"jingzhao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jing Zhao","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-19T23:28:37.065+0000","updated":"2014-03-19T23:28:37.065+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941185","id":"13941185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"body":"This v1 patch addresses Jing's comment. I also use {{Mockito.verify}} to ensure that the corresponding methods are called.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-19T23:40:12.546+0000","updated":"2014-03-19T23:40:12.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941337","id":"13941337","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12635684/HDFS-6127.001.patch\n  against trunk revision .\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 2 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.\n\n    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HDFS-Build/6449//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-HDFS-Build/6449//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-20T02:55:15.208+0000","updated":"2014-03-20T02:55:15.208+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941460","id":"13941460","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Hadoop-trunk-Commit #5363 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/5363/])\nHDFS-6127. WebHDFS tokens cannot be renewed in HA setup. Contributed by Haohui Mai. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1579546)\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSClient.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/HAUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/TokenAspect.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources/TestDatanodeWebHdfsMethods.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/TestWebHDFSForHA.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-20T06:56:59.536+0000","updated":"2014-03-20T06:56:59.536+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941466","id":"13941466","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"body":"I've committed the patch to trunk, branch-2, and branch-2.4. Thanks [~jingzhao] for the review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-20T07:05:48.792+0000","updated":"2014-03-20T07:05:48.792+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941630","id":"13941630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Yarn-trunk #515 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/515/])\nHDFS-6127. WebHDFS tokens cannot be renewed in HA setup. Contributed by Haohui Mai. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1579546)\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSClient.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/HAUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/TokenAspect.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources/TestDatanodeWebHdfsMethods.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/TestWebHDFSForHA.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-20T11:14:24.966+0000","updated":"2014-03-20T11:14:24.966+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941733","id":"13941733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk #1707 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1707/])\nHDFS-6127. WebHDFS tokens cannot be renewed in HA setup. Contributed by Haohui Mai. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1579546)\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSClient.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/HAUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/TokenAspect.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources/TestDatanodeWebHdfsMethods.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/TestWebHDFSForHA.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-20T13:44:35.045+0000","updated":"2014-03-20T13:44:35.045+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12702455/comment/13941805","id":"13941805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Hadoop-Mapreduce-trunk #1732 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1732/])\nHDFS-6127. WebHDFS tokens cannot be renewed in HA setup. Contributed by Haohui Mai. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1579546)\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSClient.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/HAUtil.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/TokenAspect.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/datanode/web/resources/TestDatanodeWebHdfsMethods.java\n* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/TestWebHDFSForHA.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-20T15:00:23.117+0000","updated":"2014-03-20T15:00:23.117+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-6127/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1tlxr:"}}