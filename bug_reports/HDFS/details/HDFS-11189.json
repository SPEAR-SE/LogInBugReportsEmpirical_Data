{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13024331","self":"https://issues.apache.org/jira/rest/api/2/issue/13024331","key":"HDFS-11189","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310942","id":"12310942","key":"HDFS","name":"Hadoop HDFS","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-12-01T00:09:19.537+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Dec 09 10:06:33 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11189/watchers","watchCount":3,"isWatching":false},"created":"2016-11-30T06:19:15.351+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12333995","id":"12333995","description":"2.7.3 release","name":"2.7.3","archived":false,"released":true,"releaseDate":"2016-08-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-12-09T10:06:33.482+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319200","id":"12319200","name":"webhdfs","description":"WebHDFS: HTTP REST API for HDFS"}],"timeoriginalestimate":null,"description":"\nIn some cases with simple operations (get file - non two step operation) we detect that FollowRedirects flag of http comes as \"false\" and it makes webhdfs crash.\n\nWe don't really know which library change this behavior and it is really strange because the change is done directly in the jvm because in other wars/ears of the same j2ee server it fails also. If we restart the j2ee server it starts working again.\n\nTo fix the problem we changed the WebHdfsFileSystem class adding \"setInstanceFollowRedirects(true)\" in the connection management instead of supposing that it should be true and it works fine.\n\nThe same problem arises both in 1.x and 2.x webhdfs. We didn't test in 3.x\n\nCould you fix it? We did it in our environment but it would fine in it could be included in the next releases.\n\nThanks in advance,\nOscar","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12842124","id":"12842124","filename":"WebHdfsFileSystem.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-07T09:17:59.363+0000","size":28950,"mimeType":"text/x-java","content":"https://issues.apache.org/jira/secure/attachment/12842124/WebHdfsFileSystem.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"WebHDFS and FollowRedirects","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"We are using webhdfs from a j2ee environment with java 6. In the web application we have a lot of libraries: spring, jersey, jackson...","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15710288","id":"15710288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~guadilla]\n\nIt is not clear what was the problem. Webhdfs was designed not to automatically follow redirects, you don't want to send too many data to NN server directly, instead you want NN tells you which DN you want to write, then use another request to DN to transfer data. Would you provide more info about how webhdfs was crashed? At this point, can't tell this is a webhdfs problem or not.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-01T00:09:19.537+0000","updated":"2016-12-01T00:09:19.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15718649","id":"15718649","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"body":"Hi Weiwei Yang,\n\n     I will try to explain it better. Let's focus on a GET operation:\n     - step 1 --> http request to the namenode from the client to get a concrete file\n     - step 2 --> the namenode looks up where is the file and sends to the client a 307 (forward) response with the datanode uri in the location\n     - step 3 --> the client reads the response (307) and makes a second http client to the suggested datanode\n     - step 4 --> the datanode reads the requested file and gives it back the content to the client\n\n     It works fine if the httpconnection has the default value (true) in the getFollowRedirects atributte; otherwise if fails because it stops in the step3. I know that this atributte followRedirects should be by default true but we detected that certain libraries modify that behaviour and webhdfs worked poorly.  \n\n     To solve this problem what we did was change the FileSystem class to instead of supposing that FollowRedirects is true always set the value to true. Of course we used the instance scope using setInstanceFollowRedirects instead of using the global parameter.\n\n     PS: It was a nighmare of two weeks for us and we wanted to contribute with the solution we found. We are just users of hadoop and we wanted to give back something from us to the project.\n\nRegards,\nOscar","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-03T19:57:52.329+0000","updated":"2016-12-03T19:57:52.329+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15721119","id":"15721119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hello [~guadilla]\n\nAre you talking about client side follow redirects on http connection? If you already have a patch, you are welcome to attach the patch on this ticket. Use More - Attach Files.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-05T03:45:28.359+0000","updated":"2016-12-05T03:45:28.359+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15728215","id":"15728215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"body":"Hi Weiwei,\n\n     I am talking about client side. I attached the impl of the 1.0.3 client. Anyway the key is in the two lines added with the code \"conn.setInstanceFollowRedirects(true);\". In the end we used the 1.0.3 release because it was needed less dependencies.\n\nRegards,\nOscar","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-07T09:17:16.747+0000","updated":"2016-12-07T09:17:16.747+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15728222","id":"15728222","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"body":"with the setInstanceFollowRedirect","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-07T09:17:59.369+0000","updated":"2016-12-07T09:17:59.369+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15729093","id":"15729093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hello [~guadilla]\n\n{{HttpURLConnection}} class has a static method [setFollowRedirects|https://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#setFollowRedirects(boolean)] sets a global flag, and [setInstanceFollowRedirects |https://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#setInstanceFollowRedirects(boolean)] is using that as a default value. So it could be possible other libraries calls {{setFollowRedirects}} that changes the behaviour. \n\nHowever I just tried to set this value to false and tested open() *2-step-opt* and getFileBlockLocations() *1-step-opt*, \n{code}\nHttpURLConnection.setFollowRedirects(false);\nWebHdfsFileSystem sw = (WebHdfsFileSystem) FileSystem.get(new URI(uri), conf);\nFSDataInputStream in = sw.open(new Path(path));\n...\n{code} \nthey both worked fine. What was the error you saw? Can you get this issue reproduced?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-07T15:58:18.376+0000","updated":"2016-12-07T15:58:18.376+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15729485","id":"15729485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"body":"Hi Weiwei,\n\n     The problem was that HttpURLConnection in some cases had the global FollowRedirects atribute as false and in this cases the get operation didn't work fine because the WebHdfs call to the namenode returned 307 and it wasn't made a second request to the datanode because http was said not to follow. A bit tricky but understable.\n\n     From a standalone it works fine. It fails only from a web environment. In our case we are using it from weblogic 10.3.6.  I can't reproduce the problem without using a third party application.... \n\nRegards,\nOscar","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-07T18:27:24.184+0000","updated":"2016-12-07T18:27:24.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15730297","id":"15730297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~guadilla]\n\nIf you have an error stack trace, that will help to explain the problem.\nAt mean time I am running out of idea about what would be the root cause of this issue, I cannot make any fix if the issue can not be reproduced. I'll let others see if they have any more ideas. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-07T23:35:11.295+0000","updated":"2016-12-07T23:35:11.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13024331/comment/15734873","id":"15734873","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"body":"Hi Weiwei,\n\n     I understand your position of no fixing nothing not being able to reproduce because I work mainly the same. In this case I am sorry for not being able to give more information. I put the stacktrace of the error we had before modifying the FollowRedirect behaviour. Anyway the change I did is nothing apart from not supposing the flag state and set it directly. But as you want, if you include in the following release fine and otherwise fine also. I can't do more.\n\n java.io.IOException: Unexpected HTTP response: code=307 != 200, op=OPEN, message=TEMPORARY_REDIRECT\n       at org.apache.hadoop.hdfs.web.WebHdfsFileSystem.validateResponse(WebHdfsFileSystem.java:250)\n       at org.apache.hadoop.hdfs.web.WebHdfsFileSystem.access$000(WebHdfsFileSystem.java:103)\n       at org.apache.hadoop.hdfs.web.WebHdfsFileSystem$OffsetUrlInputStream.checkResponseCode(WebHdfsFileSystem.java:641)\n       at org.apache.hadoop.hdfs.ByteRangeInputStream.getInputStream(ByteRangeInputStream.java:106)\n       at org.apache.hadoop.hdfs.ByteRangeInputStream.read(ByteRangeInputStream.java:130)\n       at java.io.FilterInputStream.read(FilterInputStream.java:66)\n\nRegards,\nOscar\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oguadilla","name":"oguadilla","key":"oguadilla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Oscar Guadilla","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-09T10:06:33.482+0000","updated":"2016-12-09T10:06:33.482+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HDFS-11189/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i36y3b:"}}