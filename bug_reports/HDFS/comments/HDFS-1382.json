[Is the bug here that we don't properly decide which edit to replay?

Shouldn't it have looked at fstime across the directories, seen dir2's higher fstime, and used that one?, Per HDFS-903 I think it uses the first image image and edit log regardless of the date. , From my understanding, fstime in very dir is scan for the latest one.
In this case, fstime in edit0 is corrupted to a later time than that of edit1,
hence the lost. The bug here is that metadata (fstime) has no checksum,
hence a corruption can lead to a data loss., This seems to be a valid bug in the transaction/edits handling., Looks like this issue would be fixed with the patch already submitted for https://issues.apache.org/jira/browse/HDFS-903.  Also, this issue seems to overlap completely with 903.  Seems like it can be closed.]