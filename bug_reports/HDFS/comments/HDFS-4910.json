[The failure is caused by {{FSPermissionCheck.checkPermission()}} not respecting the {{resolveLink}} parameter when calling {{getINodesInPath()}} to get the {{INodesInPath}}. Attached a simple patch., Thanks, Chuan.  This makes {{FSPermissionChecker}} on branch-2 equivalent to the trunk version as advertised.  I confirmed that the test fails on branch-2 and then passes after applying your patch.

Let's aim to make the files identical on trunk and branch-2 so that any subsequent patches merge easily across branches.  Right now, there is just a minor formatting difference from trunk caused by this line:

{code}
    for (; ancestorIndex >= 0 && inodes[ancestorIndex] == null; ancestorIndex--)
      ;
{code}

I'm attaching an updated version of your patch that just adjusts the formatting of this line to make it identical to trunk.

Can you confirm that the new patch looks good to you?  If so, then I can commit it., >Can you confirm that the new patch looks good to you? If so, then I can commit it.

Your patch looks good to me. Thanks for correcting the format!, +1 for the patch.  I'll commit this., I committed this to branch-2.  Chuan, thank you for the patch., Also committed to branch-2.1-beta.]