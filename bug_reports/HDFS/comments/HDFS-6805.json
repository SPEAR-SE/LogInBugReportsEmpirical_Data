[Hi [~andreina]
Can you specify exactly which version of Hadoop you are using..?
current trunk code doesn't match with the line numbers mentioned in exception trace., I also saw this null pointer exception, when experiencing HDFS-7960 (in a branch without HDFS-6830).  I believe it happens because the BlockManager incorrectly handles replicas which exist on more than one storage in a DataNode simultaneously.  I think HDFS-6830 should prevent the null pointer described here so I am going to mark this jira as a duplicate of that.  If this re-occurs in a branch which contains HDFS-6830, we can re-open it.]