[[~hanishakoneru], how does this relate to HDFS-11096? Can you leave a comment on that JIRA? Thanks!, Thanks [~hanishakoneru] for reporting this. I do see this error while rolling upgrade testing Hadoop cluster. Especially creating a file while rolling upgrade is in progress and finalizing the upgrade on upgraded version. This blocks rolling upgrade functionality. 

I am bumping the JIRA to blocker as it blocks rolling upgrade.
, Given there's no movement of this issue for 2 months and this is not a regression in 3.1.x, I just moved it to 3.1.2, While  Upgrading from hadoop-2.7.3 to Hadoop-3.1.0

JournalNodes' s are all running with hadoop-3.X

 RollingUpgrade of one of the NN loaded fsimage and editLogs, it just stuck  on report Block , without any errors. All Datanodes are still at hadoop-2.7.  block reporting doesn't progress anybody faced ?

++
{code:java}
The reported blocks 0 needs additional 204812  blocks to reach the threshold 1.0000 of total blocks 204812. The number of live datanodes 11 has reached the minimum number 0. {code}
++

 

DN Logs 
{code:java}
2018-08-22 16:11:44,748 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: DatanodeCommand action : DNA_REGISTER from -nn.node.com./X.X:8030 with standby state
2018-08-22 16:11:44,759 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Reported NameNode version '3.1.0' does not match DataNode version '2.7.1-Prod' but is within acceptable limits. Note: This is normal during a rolling upgrade.
2018-08-22 16:11:44,759 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Block pool BP-1018191021-10.115.22.28-1436474857708 (Datanode Uuid 3057a76f-b274-492c-a774-df767a260f09) service to nn.node.com/XX.XX:8030 beginning handshake with NN
2018-08-22 16:11:44,788 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Block pool Block pool BP-1018191021-10.115.22.28-1436474857708 (Datanode Uuid 3057a76f-b274-492c-a774-df767a260f09) service to nn.node.com/XX.XX:8030 successfully registered with NN{code}, [~zvenczel] [~hanishakoneru] [~rajeshhadoop] [~leftnoteasy] [~rohithsharma] How to take this forward as we are nearing 3.2 release.]