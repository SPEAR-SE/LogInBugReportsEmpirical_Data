[In 0.20.1, the datanode process should die on a failed read or write.  Eventually the namenode will mark it as dead after lack of heartbeats.

Are you actually testing trunk?, See also HDFS-138 and HDFS-457., Resolved by HDFS-630]