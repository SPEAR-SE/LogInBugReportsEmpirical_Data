[The patch implements an equivalent change made in HDFS-4679. , I've run all HDFS tests., +1 looks good!, Thanks for the review, Daryn. I've committed this to branch-0.23., UNSTABLE: Integrated in Hadoop-Hdfs-0.23-Build #670 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/670/])
HDFS-4972. Permission check and operation are done in a separate lock for getBlockLocations(). Contributed by Kihwal Lee. (kihwal: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1503461)
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java
]