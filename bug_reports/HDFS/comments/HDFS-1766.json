[This patch makes sure that all other threads are down when
1. DN encounters an error when creating a DN object;
2. The offerservice thread exits., Another way to go about this would be to set up an UncaughtExceptionHandler on the main threads that does System.exit(1) -- that would also deal with cases like OutOfMemoryError, which you're currently not catching.

I think we should either do that, or modify your patch to catch all Throwable, Todd, you meant the part of code in createDataNode, right?, Yep, the catch (Exception e), Yes, catching Throwable might be better., I guess that this is not a problem anymore. Please feel free to reopen this if I am wrong. Resolving ...]