[bq. does not handle the case when the queue is full and offer return false

From {{BlockManager.java}}
{noformat}
    void enqueue(Runnable action) throws InterruptedException {
      if (!queue.offer(action)) {
        if (!isAlive() && namesystem.isRunning()) {
          ExitUtil.terminate(1, getName()+" is not running");
        }
        long now = Time.monotonicNow();
        if (now - lastFull > 4000) {
          lastFull = now;
          LOG.info("Block report queue is full");
        }
        queue.put(action);
      }
    }
{noformat}

If {{queue.offer(action)}} returns false, it will do blocking put., Unless I'm counting {} wrong it looks like the put is inside the if statement., Now I see it. Completely missed the !.]