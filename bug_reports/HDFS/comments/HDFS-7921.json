[{quote}
Is this the intended behavior? It is weird just to list files and not the directories if recursive is set to false.
{quote}
The behavior is right.
{{listFiles}} returns {{RemoteIterator<LocatedFileStatus>}} which includes the block locations of files besides status. So they are different and there is no issue..]