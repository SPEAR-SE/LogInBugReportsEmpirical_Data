[The patch makes {{TransferFsImage#receiveFile()}} delete the temporary files when the transfer fails.
- An exception was thrown while receiving.
- Number of bytes received does not match the size in the header.
- MD5 digest mismatch.

This is a common method used by both PUT and GET., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12679877/HDFS-7373.patch
  against trunk revision 10f9f51.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:red}-1 findbugs{color}.  The patch appears to introduce 1 new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-hdfs-project/hadoop-hdfs:

                  org.apache.hadoop.hdfs.server.datanode.TestFsDatasetCache

                                      The following test timeouts occurred in hadoop-hdfs-project/hadoop-hdfs:

org.apache.hadoop.hdfs.TestLeaseRecovery

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/8677//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HDFS-Build/8677//artifact/patchprocess/newPatchFindbugsWarningshadoop-hdfs.html
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/8677//console

This message is automatically generated., - There is actually no new findbugs warning. It says 0 total in the output.
- Test failures are unrelated.  They all pass when run on my desktop. , Good idea! The patch looks good to me, +1 (non-binding)., [~ajisakaa] Can I get an official binding +1?  :), +1 (binding)., Thanks for the review, Akira. I've committed this to trunk and branch-2., FAILURE: Integrated in Hadoop-trunk-Commit #6747 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/6747/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
, [~kihwal], if i am not wrong, there really is a new findbugs warning, i filed HDFS-7551, could you please take a look at it? thanks!, FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #46 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/46/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Yarn-trunk #780 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/780/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk #1978 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1978/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #43 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/43/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #47 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/47/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #1997 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1997/])
HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee (kihwal: rev c0d666c74e9ea76564a2458c6c0a78ae7afa9fea)
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/TransferFsImage.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
, {color:red}WARNING{color}: due to a typo in HDFS-7374 commit message, there are 2 commits with the message prefix "HDFS-7373":
{noformat}
c0d666c HDFS-7373. Clean up temporary files after fsimage transfer failures. Contributed by Kihwal Lee
5bd048e HDFS-7373. Allow decommissioning of dead DataNodes. Contributed by Zhe Zhang.
{noformat}]