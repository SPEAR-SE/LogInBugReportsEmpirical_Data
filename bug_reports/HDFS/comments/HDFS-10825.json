[HDFS-11402 solves the core issue of making HDFS snapshots immutable w.r.t open files. Tested with the patch attached in this jira and with the fix it passes through. Closing this jira as a duplicate. Please let me know if you think otherwise.]