[Also this will fail on existing directories., Updated patch for 20.55 security.
Also updated the patch for Trunk (Testcases for coverage), Patches look good.  Forgot to check the license for the trunk patch?, Nicholas, Thanks a lot for the review!

{quote}
Forgot to check the license for the trunk patch?
{quote}
I think, so... I enable the licence now., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12501313/HDFS-2509-trunkTests.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 7 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed these unit tests:
                  org.apache.hadoop.hdfs.server.balancer.TestBalancerWithMultipleNameNodes
                  org.apache.hadoop.cli.TestHDFSCLI
                  org.apache.hadoop.hdfs.server.balancer.TestBalancer
                  org.apache.hadoop.hdfs.TestFileCreationClient
                  org.apache.hadoop.hdfs.TestSetrepIncreasing

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/1486//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/1486//console

This message is automatically generated., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12501345/HDFS-2509-trunkTests.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 7 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed these unit tests:
                  org.apache.hadoop.hdfs.TestAbandonBlock
                  org.apache.hadoop.cli.TestHDFSCLI

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/1488//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/1488//console

This message is automatically generated., Hi Uma, for the 0.20s patch, let's change DFSClient.getFileChecksum(DFSClient.java:783) but not FSNamesystem.getBlockLocationsInternal(..) since some code (e.g. NamenodeFsck) is relying on its behavior., Integrated in Hadoop-Mapreduce-trunk-Commit #1218 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/1218/])
    HDFS-2509. Add a test for DistributedFileSystem.getFileChecksum(..) on directories or non existing files.  Contributed by Uma Maheswara Rao G

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190677
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-0.23-Commit #108 (See [https://builds.apache.org/job/Hadoop-Mapreduce-0.23-Commit/108/])
    svn merge -c 1190677 from trunk for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190680
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Hdfs-0.23-Commit #101 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Commit/101/])
    svn merge -c 1190677 from trunk for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190680
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Common-0.23-Commit #101 (See [https://builds.apache.org/job/Hadoop-Common-0.23-Commit/101/])
    svn merge -c 1190677 from trunk for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190680
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Common-trunk-Commit #1194 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/1194/])
    HDFS-2509. Add a test for DistributedFileSystem.getFileChecksum(..) on directories or non existing files.  Contributed by Uma Maheswara Rao G

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190677
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Hdfs-trunk-Commit #1270 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Commit/1270/])
    HDFS-2509. Add a test for DistributedFileSystem.getFileChecksum(..) on directories or non existing files.  Contributed by Uma Maheswara Rao G

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190677
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Ok, I handled from getFileChecksum API.

 I feel, that null check will not be useful in trunk as well after fixing HDFS-2065. After that fix, it will never return null. I will add comment in that issue to correct in NamenodeFsck as well.

Thanks
Uma, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12501433/HDFS-2509-0.20.205Security.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 7 new or modified tests.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/1498//console

This message is automatically generated., Patch is for 20.205 branch!, Integrated in Hadoop-Hdfs-0.23-Build #54 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/54/])
    svn merge -c 1190677 from trunk for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190680
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Hdfs-trunk #847 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/847/])
    HDFS-2509. Add a test for DistributedFileSystem.getFileChecksum(..) on directories or non existing files.  Contributed by Uma Maheswara Rao G

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190677
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-trunk #878 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/878/])
    HDFS-2509. Add a test for DistributedFileSystem.getFileChecksum(..) on directories or non existing files.  Contributed by Uma Maheswara Rao G

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190677
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-0.23-Build #72 (See [https://builds.apache.org/job/Hadoop-Mapreduce-0.23-Build/72/])
    svn merge -c 1190677 from trunk for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1190680
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Hdfs-trunk-Commit #1272 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Commit/1272/])
    Revert 1190677 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194986
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Common-trunk-Commit #1196 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/1196/])
    Revert 1190677 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194986
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Hi Uma, I saw that you found out HDFS-2065, a similar issue.  Let's close this and work on there., Closing as duplicate., Integrated in Hadoop-Hdfs-0.23-Commit #103 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Commit/103/])
    Revert 1190680 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194988
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Common-0.23-Commit #103 (See [https://builds.apache.org/job/Hadoop-Common-0.23-Commit/103/])
    Revert 1190680 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194988
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-trunk-Commit #1221 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/1221/])
    Revert 1190677 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194986
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-0.23-Commit #110 (See [https://builds.apache.org/job/Hadoop-Mapreduce-0.23-Commit/110/])
    Revert 1190680 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194988
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-0.23-Build #73 (See [https://builds.apache.org/job/Hadoop-Mapreduce-0.23-Build/73/])
    Revert 1190680 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194988
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Mapreduce-trunk #879 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/879/])
    Revert 1190677 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194986
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Hdfs-trunk #848 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/848/])
    Revert 1190677 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194986
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, Integrated in Hadoop-Hdfs-0.23-Build #55 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/55/])
    Revert 1190680 for HDFS-2509.

szetszwo : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1194988
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/TestDistributedFileSystem.java
, {quote}
Hi Uma, I saw that you found out HDFS-2065, a similar issue. Let's close this and work on there.
{quote}
Ok, i will post the patches in HDFS-2065.]