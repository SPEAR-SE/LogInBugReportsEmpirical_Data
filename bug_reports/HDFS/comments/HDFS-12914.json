[Had a cluster with a job causing unusually heavy IO.  DNs became moderately congested with commands.  Eventually 1 was declared dead.  Upon rejoining a few mins later, the FBR was rejected with "because the DN is not in the pending set".  The replication storm in conjunction with the bad job caused nodes to go dead like dominos.  Some that rejoined had their FBR rejected with "is not valid for unknown datanode" in addition to "because the DN is not in the pending set".

On a 2400 node cluster, ~400 nodes were temporarily dead.  304 had their FBRs rejected when rejoining.  80k blocks were missing.  Had to force FBRs to bring the blocks back.

I have no clue why a rejected report clears the storage/node's stale state!, [~daryn] Do we still hit the issue, any clue to fix it?]