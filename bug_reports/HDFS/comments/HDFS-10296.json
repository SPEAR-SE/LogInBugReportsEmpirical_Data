[Thanks for providing a code snippet to demonstrate the issue, Andreas.

Please note that in your case, if default FS is a local file system, it will not have delegation tokens.
While you reported this on a CDH Hadoop, this same behavior also holds for Apache Hadoop., We do special handling in DistributedFileSystem#addDelegationTokens to detect TDE features and inject an additional KMS DT; this enhancement is missing in FileContext.]