[This has already been discussed elsewhere. The primary assumption is that a pipeline has more than one DN in it, and this is unlikely to happen on all of the DNs simultaneously. So one replica will get corrupt, but we have others that are fine., It actually is a bug because we do not atomically write to the datafile and the metadata file. Especially in the case when we re-open a file for appending to it, and then we start writing to last block just when a power failure hits the entire cluster. In this case, after a restart none of the three replicas might match with their respective checksums.]