[We'll need to tag the functions with {{__declspec(dllexport)}}.  I expect to post a patch soon., This patch fixes the issue as follows.
# In CMakeLists.txt, when running on Windows, do not override the static library's name to "hdfs".  This will cause the build output to be hdfs_static.lib for the statically linked library and hdfs.lib for the DLL import library.  Define symbol {{LIBHDFS_DLL_EXPORT}}, which is used in hdfs.h.
# In hdfs.h, use a macro to tag all public API functions with {{\_\_declspec(dllexport)}} or {{\_\_declspec(dllimport)}} (or nothing at all if the client application is using static linking).  This is a standard idiom documented here, and I've also seen it used in the lzo library for example.
https://msdn.microsoft.com/en-us/library/8fskxacy.aspx

Linux builds are not altered by this patch., Note that the UNIX platform has the same problem. The issue does not surface because by default the compiler exports all the symbol. To fix this, we need to make all functions with hidden visibility (i.e., {{-fhidden-visiliblity}}) as well, and we can define {{LIBHDFS_EXTERNAL}} to {{((visibility ("default")))}} to make it work on Linux.

Please see https://gcc.gnu.org/wiki/Visibility for more details., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12702286/HDFS-7879.001.patch
  against trunk revision e17e5ba.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-hdfs-project/hadoop-hdfs:

                  org.apache.hadoop.hdfs.server.balancer.TestBalancer

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/9714//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/9714//console

This message is automatically generated., Thanks, Haohui.  That's a good suggestion.  Here is patch v002., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12702378/HDFS-7879.002.patch
  against trunk revision 29bb689.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-hdfs-project/hadoop-hdfs:

                  org.apache.hadoop.hdfs.server.namenode.TestFileTruncate
                  org.apache.hadoop.hdfs.server.namenode.snapshot.TestOpenFilesWithSnapshot

                                      The following test timeouts occurred in hadoop-hdfs-project/hadoop-hdfs:

org.apache.hadoop.hdfs.server.datanode.TestDataNodeHotSwapVolumes

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/9721//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/9721//console

This message is automatically generated., +1, I've committed the patch to trunk and branch-2. Thanks [~cnauroth] for the contribution., FAILURE: Integrated in Hadoop-trunk-Commit #7254 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/7254/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, Haohui, thank you for the review and commit., FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #123 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/123/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Yarn-trunk #857 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/857/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk #2055 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2055/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #114 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/114/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #123 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/123/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #2073 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2073/])
HDFS-7879. hdfs.dll does not export functions of the public libhdfs API. Contributed by Chris Nauroth. (wheat9: rev f717dc51b27d72ad02732a8da397e4a1cc270514)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/native/libhdfs/hdfs.h
* hadoop-hdfs-project/hadoop-hdfs/src/CMakeLists.txt
, Thanks, [~wheat9] and [~cnauroth].  It's good to limit the visibility of these symbols so that we don't get unexpected symbol conflicts.]