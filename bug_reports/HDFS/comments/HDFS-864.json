[May be it is a good time to start looking into [JSure|http://wiki.apache.org/hadoop/HowToUseConcurrencyAnalysisTools] more closely?, Yea, from what I read on that wiki page you wrote, JSure sounds like it would help with this. I found these deadlocks using jcarder, which works at runtime to detect lock order inversions with a bit of overhead. I had to make a few changes to jcarder ( http://github.com/toddlipcon/jcarder/tree/cloudera ) but at this point it's very effective for this and doesn't require any extra development effort. Once those changes get incorporated into a jcarder release, I hope to get it integrated into the Hudson test-patch., 
since the 0.20 versions doesn't have the attemptRestoreRemovedStorage() method in FsImage, i think the there is no possibility for deadlock in 0.20.1 or 0.20.2 . Is it?]