[Assigning this to Alejandro to correct., Allen, I'd appreciate if you don't assign JIRAs to me unless I agree to. If you have special interest in fixing this please do the due diligence, verifying it will not break the various versions of Linux Hadoop is normally used and once that is done please provide a patch., I suppose another choice is to -1 the previous patch and revert it. , If anything HDFS-4171 errs by being cautious, it is not a bug. if you want to relax it please verify it won't break any things in any of the commonly used Linux distros., Alejandro, it breaks existing usernames and principals longer than 31 characters. That makes it a bug.  It is a regression to previous behavior.  So at a minimum requires a release note.  , Yes, makes sense. Or we could add a config option to disable the 31 check, thus enabling longer than 31 chars for OSes where this is supported, and the default would be 31 check enabled., bq. Yes, makes sense. Or we could add a config option to disable the 31 check, thus enabling longer than 31 chars for OSes where this is supported, and the default would be 31 check enabled.
Adding config option in this case seems unnecessary to me. Lets have reasonable and larger username length.

BTW can you please mark both HDFS-4171 and this jira as incompatible, add release notes to indicate the same with details and move these jiras to incompatible section in CHANGES.txt?
, I marked this jira as a blocker for 2.0.3, to ensure it gets picked up for the release., This jira is essentially makes comments on the changes of HDFS-4171. Ideally, if it was made at the right time, HDFS-4171 could not have been committed. Given no follow up has happened on this jira for several days. I am going to revert HDFS-4171 by the end of the day, if there are no further activity in this jira.
, Suresh, without HDFS-4171 usernames containing '_', '-' & '.' don't work. I think that is a bigger issue than the length limitation. I'd say it would be more common to have one of those chars in the username than a username with length greater than 31. Your opinion is against a config option. I'll take care of adding the release notes incompatible changes today or tomorrow. Sounds good?, bq. I think that is a bigger issue than the length limitation.
Agreed. But the incompatibility introduced in the change is unnecessary and is also an important issue. 

My comment is not just to track documenting incompatible change. We should add a reasonable limit to the username length. As I said, this jira is essentially tracking a comment against HDFS-4171 change and it needs to be addressed., Patch that removes the limit on 31 chars.

I was missing the point with the check that we are not attempting to create a username, so nothing will happen other than the username won't be known if the limit of 31 exists.

Suresh, mind reviewing it and committing if OK?, +1 for the change Alejandro. Thank you for making this change., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12559769/HDFS-4171.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 2 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-httpfs:

                  org.apache.hadoop.hdfs.server.namenode.TestEditLog

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/3617//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/3617//console

This message is automatically generated., Test failure is unrelated. 

Allen, apologies for missing the point at first., Integrated in Hadoop-trunk-Commit #3096 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/3096/])
    HDFS-4236. Remove artificial limit on username length introduced in HDFS-4171. Contributed by Alejandro Abdelnur. (Revision 1418356)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1418356
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/wsrs/UserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/lib/wsrs/TestUserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/resources/UserParam.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/resources/TestParam.java
, I committed the change to trunk and branch-2. Thank you Allen for noticing and reporting the issue. Thank you Alejandro for the patch., Thanks for following up on this Suresh., Integrated in Hadoop-Yarn-trunk #59 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/59/])
    HDFS-4236. Remove artificial limit on username length introduced in HDFS-4171. Contributed by Alejandro Abdelnur. (Revision 1418356)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1418356
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/wsrs/UserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/lib/wsrs/TestUserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/resources/UserParam.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/resources/TestParam.java
, Integrated in Hadoop-Hdfs-trunk #1248 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1248/])
    HDFS-4236. Remove artificial limit on username length introduced in HDFS-4171. Contributed by Alejandro Abdelnur. (Revision 1418356)

     Result = FAILURE
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1418356
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/wsrs/UserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/lib/wsrs/TestUserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/resources/UserParam.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/resources/TestParam.java
, Integrated in Hadoop-Mapreduce-trunk #1279 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1279/])
    HDFS-4236. Remove artificial limit on username length introduced in HDFS-4171. Contributed by Alejandro Abdelnur. (Revision 1418356)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1418356
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/wsrs/UserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/lib/wsrs/TestUserProvider.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/web/resources/UserParam.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/web/resources/TestParam.java
]