[Attaching the patch.

With the patch all test cases will pass on Windows except for {{TestEditLog#testFailedOpen}} which is dependent on HDFS-4610., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12578682/HDFS-4695.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-hdfs-project/hadoop-hdfs:

                  org.apache.hadoop.hdfs.server.datanode.TestBlockRecovery
                  org.apache.hadoop.hdfs.server.datanode.fsdataset.TestAvailableSpaceVolumeChoosingPolicy

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/4246//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/4246//console

This message is automatically generated., Looks good to me.

In this case:
{code}
+      for (EditLogInputStream stream : streams) {
+        IOUtils.closeStream(stream);
+      }
{code}

You should be able to use {{IOUtils.closeQuietly}} or similar.  {{EditLogInputStream}} implements {{Closeable}}., what I mean is, you don't need the for loop, I applied the patch locally and verified the tests on both Mac and Windows (including the known failure in {{testFailedOpen}}).  I think it will be good to go as soon as Colin's feedback gets incorporated.  Thanks, Ivan!, Thanks Colin and Chris for the review! 

Attaching the updated patch. I switched to {{IOUtils.cleanup()}} as I was not able to find {{IOUtils.closeQuietly()}} that accepts a list of closables. Colin, let me know if this looks good., looks good to me.

There are actually two IOUtils classes in common use-- {{org.apache.commons.io.IOUtils}} and {{org.apache.hadoop.io.IOUtils}}.  The former has {{closeQuietly}}, and the latter has {{cleanup}}.  Either function works here, and if you're already using the {{org.apache.hadoop.io}} class, it's probably easiest to stick with that, just as you did here., {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12578829/HDFS-4695.2.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/4256//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/4256//console

This message is automatically generated., bq. There are actually two IOUtils classes in common use-- org.apache.commons.io.IOUtils and org.apache.hadoop.io.IOUtils. The former has closeQuietly, and the latter has cleanup. Either function works here, and if you're already using the org.apache.hadoop.io class, it's probably easiest to stick with that, just as you did here.
Thanks Colin. I also noticed {{org.apache.commons.io.IOUtils}} however I did not find {{closeQuietly}} that accepts a list of closables. The current patch should be good then, thanks!, +1 for the patch., I committed the patch to trunk and branch-2. Thank you Ivan. Thanks to Chris and Colin for the reviews., Integrated in Hadoop-trunk-Commit #3621 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/3621/])
    HDFS-4695. TestEditLog leaks open file handles between tests. Contributed by Ivan Mitic. (Revision 1469015)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1469015
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestEditLog.java
, Integrated in Hadoop-Yarn-trunk #187 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/187/])
    HDFS-4695. TestEditLog leaks open file handles between tests. Contributed by Ivan Mitic. (Revision 1469015)

     Result = FAILURE
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1469015
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestEditLog.java
, Integrated in Hadoop-Hdfs-trunk #1376 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1376/])
    HDFS-4695. TestEditLog leaks open file handles between tests. Contributed by Ivan Mitic. (Revision 1469015)

     Result = FAILURE
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1469015
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestEditLog.java
, Integrated in Hadoop-Mapreduce-trunk #1403 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1403/])
    HDFS-4695. TestEditLog leaks open file handles between tests. Contributed by Ivan Mitic. (Revision 1469015)

     Result = SUCCESS
suresh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1469015
Files : 
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestEditLog.java
]