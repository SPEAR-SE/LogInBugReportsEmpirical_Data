[Notifying some of the original authors, [~jingzhao] and [~szetszwo], for commentary to see if they agree with the proposal or if they prefer to maintain it., I also agree the current implementation is not good. So I'm fine with the proposal here., Sure, let's do it., Given that it has never been documented or packaged, is there any reason to keep it in branch-2?, libwebhdfs fills a purpose that no other C library currently fills.  It can be used without the same version of Hadoop jars on the system as the server code.  While I agree that the current implementation is flawed (in particular, HDFS-3917 is a big gap), we should have something to replace it (which is actually ready and checked into trunk) before we remove it.  It's a self-contained piece of code and the maintenance burden is almost 0.  The same can't be said for a lot of other things in that we still keep around. -1 until we have a replacement (which could very well be one of the native library efforts, when they're actually ready)., There's not really much gap to fill though.  It wasn't documented and mvn package never put it in the tarball.  Besides, I've personally had much better luck using some random code on Github for WebHDFS compatibility than this library...., [~aw], if you think "some random code on github" is better, then please see if you can integrate that (assuming its license is compatible) and get rid of libwebhdfs.  I'm just saying that we shouldn't remove it without a replacement., bq.  please see if you can integrate that (assuming its license is compatible)

It is license compatible (and, ironically, based upon code from a Cloudera employee), but frankly, given I'm actively working on pulling other bits I've written out of Hadoop and into other projects, I don't see why I'd contribute yet another new subsystem., Like I said, I don't have any objection to replacing libwebhdfs with some code that's better and does the same job.  I just don't think we should remove it with no replacement., bq. libwebhdfs fills a purpose that no other C library currently fills. It can be used without the same version of Hadoop jars on the system as the server code,...

Hi [~cmccabe], as HDFS-9170 has been committed, libhdfs should only depend on the client jar. Do you think now libhdfs can satisfy the above use case, so that it is possible to remove libwebhdfs?, bq. Hi Colin Patrick McCabe, as HDFS-9170 has been committed, libhdfs should only depend on the client jar. Do you think now libhdfs can satisfy the above use case, so that it is possible to remove libwebhdfs?

libhdfs still depends on Hadoop jar files and Java VM, which libwebhdfs does not.  These are funamentally different use-cases., bq. libhdfs still depends on Hadoop jar files and Java VM, which libwebhdfs does not. These are funamentally different use-cases.

Unfortunately libwebhdfs does depend on Hadoop jars and Java VM today (HDFS-3917). Although it is fixable, but I don't think anyone has signed up for it given the current state of libwebhdfs. Are there any use cases in mind that libhdfs fails to replace libwebhdfs?, The fact that libwebhdfs has a dependency on JNI is just a bug.  It's not relevant to the issue of whether we need something that fills the role of libwebhdfs.

There are still use-cases for libhwebhdfs even with this bug, like supporting transferring data to previous versions of hadoop that are not compatible with RPCv9., libwebhdfs build has been broken in 2.6 and 2.7 for a long time (a year?).  The branch-specific precommit fails because of this. If we remove it, we will be removing code that has been *unbuildable* in many past releases.  Apparently no 2.6/2.7 user cares about it. This is different from typical deprecation scenario where functioning code is involved.

Long term design and vision aside, what do we do to make the branch precommit work for 2.6 and 2.7? Remove it or fix it?, I remain +1 for a full removal of libwebhdfs from trunk, branch-2, branch-2.7 and branch-2.6.  However, there was not consensus on this plan last time we discussed it.  If someone still wants to keep it, and is making a commitment to maintenance of it, then our fallback plan would be to backport my HDFS-8346 patch to branch-2.7 and branch-2.6., It's probably worthwhile pointing out that not only has libwebhdfs been broken in various branches for more than a year, but the *votes passed* for those branches that had releases.  So not only do users not care and/or use that functionality, neither do PMC members., From the discussion above (and HDFS-8346), I don't think fixing/removing libwebhdfs is critical enough to stop any release trains. No release can be perfect, but the only thing we can do is to try to address all critical/blocker issues raised in community. Thus, I don't see any problem for previous vote passes without anyone call it out as a priority issue before., The fact that the code does not build out-of-the-box for several consecutive releases is worrisome and more importantly, really shameful -- any single release should not contain something does not build. And as a community fail to figure it out for a year.

+1 on removing it on both branch-2 and trunk., | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 0s {color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red} 0m 0s {color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 8m 33s {color} | {color:green} trunk passed {color} |
| {color:red}-1{color} | {color:red} compile {color} | {color:red} 0m 18s {color} | {color:red} hadoop-hdfs-native-client in trunk failed with JDK v1.8.0_66. {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 31s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 16s {color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 12s {color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 9s {color} | {color:green} trunk passed with JDK v1.8.0_66 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 11s {color} | {color:green} trunk passed with JDK v1.7.0_91 {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 10s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 22s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green} 0m 22s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 22s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 0m 23s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green} 0m 23s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green} 0m 23s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 0m 13s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 9s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green} 0m 1s {color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 7s {color} | {color:green} the patch passed with JDK v1.8.0_66 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 8s {color} | {color:green} the patch passed with JDK v1.7.0_91 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 45s {color} | {color:green} hadoop-hdfs-native-client in the patch passed with JDK v1.8.0_66. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 42s {color} | {color:green} hadoop-hdfs-native-client in the patch passed with JDK v1.7.0_91. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 21s {color} | {color:green} Patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 16m 6s {color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:0ca8df7 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12780626/HDFS-9047.000.patch |
| JIRA Issue | HDFS-9047 |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  xml  cc  |
| uname | Linux b539dc327168 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / 28bd138 |
| Default Java | 1.7.0_91 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_66 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_91 |
| compile | https://builds.apache.org/job/PreCommit-HDFS-Build/14034/artifact/patchprocess/branch-compile-hadoop-hdfs-project_hadoop-hdfs-native-client-jdk1.8.0_66.txt |
| JDK v1.7.0_91  Test Results | https://builds.apache.org/job/PreCommit-HDFS-Build/14034/testReport/ |
| modules | C: hadoop-hdfs-project/hadoop-hdfs-native-client U: hadoop-hdfs-project/hadoop-hdfs-native-client |
| Max memory used | 76MB |
| Powered by | Apache Yetus 0.2.0-SNAPSHOT   http://yetus.apache.org |
| Console output | https://builds.apache.org/job/PreCommit-HDFS-Build/14034/console |


This message was automatically generated.

, +1 on removing libwebhdfs from trunk and branch-2. The 000 patch looks good to me. +1, [~cmccabe], does it look good to you?

I plan to commit ti tomorrow if there is no more comments.

, I've committed the patch to trunk, branch-2 and branch-2.8. Thanks all for the reviews., SUCCESS: Integrated in Hadoop-trunk-Commit #9061 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/9061/])
HDFS-9047. Retire libwebhdfs. Contributed by Haohui Mai. (wheat9: rev c213ee085971483d737a2d4652adfda0f767eea0)
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/CMakeLists.txt
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs-native-client/pom.xml
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_http_query.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/test_libwebhdfs_ops.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_http_client.h
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/test_libwebhdfs_threaded.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_json_parser.h
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_http_client.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_json_parser.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_web.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/hdfs_http_query.h
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/CMakeLists.txt
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/test_libwebhdfs_read.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/src/test_libwebhdfs_write.c
* hadoop-hdfs-project/hadoop-hdfs-native-client/src/contrib/libwebhdfs/resources/FindJansson.cmake
, Hi [~wheat9], what's the plan for branch-2.6/2.7? Remove it or fix it?, Looks like there is no effort on fixing anything. IMO +1 on removing them in 2.6 / 2.7 if it's breaking the pre-commit builds, but I'll leave to the release manager to make the call., +1 on removing this from 2.7. [~vinodkv], what do you think?, bq. IMO +1 on removing them in 2.6 / 2.7 if it's breaking the pre-commit builds, but I'll leave to the release manager to make the call.
I am +1 on removing them in 2.6 in case not breaking any compatibility.
, [~wheat9] I think you missed a line in BUILDING.txt. I don't think Jansson used for anything else., It should also get removed from the Dockerfile., I was on vacation so I couldn't comment earlier.  Anyway, since {{hadoop-hdfs-native-client}} got merged, I agree that {{libwebhdfs}} is no longer strictly necessary and I withdraw my -1.  Thanks, all., Removed from branch-2.7., Also fixed the BUILDING.txt in trunk, branch-2 and branch-2.8 that was missed in the original commit., FAILURE: Integrated in Hadoop-trunk-Commit #9100 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/9100/])
Supplement to HDFS-9047. (kihwal: rev c722b62908984f8fb6ab2e0bfd40c090e8c830c7)
* BUILDING.txt
]