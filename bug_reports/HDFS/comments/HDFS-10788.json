[For anyone that does encounter the problem, once you fsck your way down to a list of problem directories, you can generate a list of bad files themselves with:

{code}
for i in `cat baddirs.txt`; do HADOOP_ROOT_LOGGER=TRACE,console hdfs dfs -checksum $i/\* 2>&1 > /dev/null | grep -v DEBUG | grep -B1 "org.apache.hadoop.ipc.RemoteException" | head -n1 | cut -d\" -f2 >> badfiles.txt; done
{code}, [~kshukla], I think one of your jiras fixed it. Please verify., I suspect it's HDFS-9958., [~jfield]. This is fixed in 2.7.3 through HDFS-9958. I am guessing this is from 2.6 HDFS as you mentioned in the affected version. Hope this helps., Thanks [~kshukla] for confirming my guess. I also traced the code and found {{ClientProtocol.getBlockLocations}} indirectly calls {{BlockManager#createLocatedBlocks}}. CDH5.5.2 is GA early this year before HDFS-9985 was committed so it does not have the fix HDFS-9985., Perfect, thanks, I'll discuss a backport with my vendor/plan an upgrade., Thanks guys, I'm marking it as duplicate of HDFS-9958.
, We are receiving multiple reports that users on CDH versions above CDH5.5.2 are still experiencing the same issue. It is not clear at this point if Apache Hadoop also carries the same bug, but I thought I should share this information., [~jojochuang], Thank you for the the update on this. Please correct me if I am wrong but CDH 5.5.x all have Hadoop 2.6 (which doesn't have this fix) or do we have a line of CDH release with 2.7 that still exhibits this issue?, Sorry for the confusion.
CDH5.4 and above are based on Apache Hadoop 2.6. But we selectively backport 2.7, 2.8 and even trunk fixes and features. It's sometimes confusing so we have internal tools to map Apache Hadoop jira keys to CDH releases. :) What I want to say is that because of this logistical reason, it is entirely possible a CDH backport missed something else and creates a bug that's exclusive to CDH releases.]