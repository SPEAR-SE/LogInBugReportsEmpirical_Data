[I am attaching a patch containing a unit test which demonstrates this issue (currently times out with deadlock when applied). 

I am open to ideas on how best to solve this deadlock issue. , This is somewhat similar to a deadlock we encountered on {{S3AFileSystem#close}}, reported in HADOOP-13599.  In that case, we were able to resolve the problem by removing {{synchronized}} from {{S3AFileSystem#close}}.  This one is going to be trickier.]