[I like both approaches.  I think #1 might be easier.  Rather than re-locking for every edit, it would be preferable to batch edits within the lock.  Either a fixed number of edits, or better yet as many as possible within a bounded amount of time.]