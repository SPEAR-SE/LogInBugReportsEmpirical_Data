[HDFS-1865 "Share LeaseChecker thread among DFSClients" is the main JIRA for solving this problem.  In order to backport it and the related bug fixes, we have the following JIRA sequence:
- HDFS-278: Should DFS outputstream's close wait forever? 
- HDFS-1840: Terminate LeaseChecker when all writing files are closed.
- HDFS-1870: Refactor DFSClient.LeaseChecker
- HDFS-1890: A few improvements on the LeaseRenewer.pendingCreates map
- HDFS-1865: Share LeaseChecker thread among DFSClients
- HDFS-2810: Leases not properly getting renewed by clients
- HDFS-3646: LeaseRenewer can hold reference to inactive DFSClient instances forever
- HDFS-2240: Possible deadlock between LeaseRenewer and its factory
, h4161_20121108_b-1.patch: consolidated patch with all the changes., Thank you Nicholas. Can you post test-patch output. Perhaps we should also run all the unit tests., test-patch results:
{noformat}
     [exec] -1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     +1 tests included.  The patch appears to include 21 new or modified tests.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     -1 findbugs.  The patch appears to introduce 9 new Findbugs (version 1.3.9) warnings.
{noformat}, The findbugs warnings are not related to the patch.

All unit test passed except for the ones mentioned in HDFS-4168., After updated with HDFS-4168, all the failed tests are now passing., +1 for the change., I have committed this., Closed upon release of 1.1.1.]