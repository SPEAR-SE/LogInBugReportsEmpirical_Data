[let me figure it out, thanks for this report !, Hi Liang,
I upload one patch, I hope that is helpful for you., One test cace base on HDFS-6231 patch., Sorry for the late reply, i tried to repro with the attached HDFS-6494.txt test case which is a trunk patch porting from LiuLei's hedged-read-test-case.patch file. Looped 10 times and all passed. To me your original failure was caused by the CountDownLatch not be protected by a final statement, which was fixed in HDFS-6231(it's available since 2.4.1) by [~cnauroth]. I'd like to close the current jira due to duplicated.
[~liulei.cn], if you still can repro it after 2.4.1, please feel free to reopen it, thanks all the same!
, [~xieliang007], thank you for taking another look at this.]