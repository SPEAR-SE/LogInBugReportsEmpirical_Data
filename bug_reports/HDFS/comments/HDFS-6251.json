[I already reviewed and +1'd this code as part of HADOOP-10499.  This is just splitting out the HDFS portion of the patch., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12640494/HDFS-6251.1.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/6675//console

This message is automatically generated., The patch needed a minor rebase.  I'm uploading v2., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12640500/HDFS-6251.2.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:red}-1 javac{color:red}.  The patch appears to cause the build to fail.

Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/6677//console

This message is automatically generated., I forgot that this is really dependent on the {{ProxyUsers}} change in HADOOP-10499.  Rather than go through a series of awkward small commits, I'm just going to roll everything back into the HADOOP-10499 commit.]