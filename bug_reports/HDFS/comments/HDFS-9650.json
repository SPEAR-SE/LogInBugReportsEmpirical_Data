[I have an addition;
When I 'cleaned out' the datanode, it started out with 0 blocks, and did of course not do any harm to the name-node when restarting.
Today I tried to restart it again, after it had recieved a few blocks, and the log on the namenode started getting those masseages again.
This time, however, the datanode didn't have enough blocks to spam the namenode long enough to take i down. The namenode just reported those redundant addStoreBlock for the new blocks on the datanode, and finished up before the failovercontroller shut it down...  
So just now, I have a few datanodes I cannot restart... , [~frha] Have you resolved this problem or able to root cause it? I am also hitting a similar issue. DataNode restart leads to these logs in NameNode making serviceRPC latency huge. So not able to perform DN restarts., Not resolved in 2.7.2. We still have same issues every time we restart DN's, I changed the log statement to 'debug' level (restarting NN) and was able to do rolling restart of DN. The problem is that log level was WARN. Hence reducing log level resolved the problem. I could see this change is already available in Trunk code.

Seems HDFS-9906 fixes this. It's available in 2.8.0., [~frha],can't we close this as duplicate of HDFS-9906..?  [~xyao] are you planning additional to HDFS-9906..? I think, we can backport HDFS-9906 to branch-2.7.., Thanks [~brahma] for the heads up. Yes, we do need to backport HDFS-9906 to branch-2.7. 
In our case, adding a dedicated serviceRPC port help avoiding the NN failover.  ]