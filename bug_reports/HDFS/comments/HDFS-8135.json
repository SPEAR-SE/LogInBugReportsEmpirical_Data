[Upload a patch to remove the deprecated FSConstants class. , {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12725052/HDFS-8135-041315.patch
  against trunk revision a1afbc4.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/10266//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/10266//console

This message is automatically generated., I've committed the patch to trunk and branch-2. Thanks [~gtCarrera9] for the contribution., FAILURE: Integrated in Hadoop-trunk-Commit #7598 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/7598/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #166 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/166/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
, FAILURE: Integrated in Hadoop-Yarn-trunk #900 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/900/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk #2098 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2098/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #157 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/157/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #167 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/167/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
, SUCCESS: Integrated in Hadoop-Mapreduce-trunk #2116 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2116/])
HDFS-8135. Remove the deprecated FSConstants class. Contributed by Li Lu. (wheat9: rev 80a2a1242337648135cab0c877203263d1092248)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/FSConstants.java
, This change breaks HBase.

The comment at the start of the removed class was 

{code}
- * @deprecated Please use {@link HdfsConstants}. This class
- * is left only for other ecosystem projects which depended on
- * it for SafemodeAction and DatanodeReport types.
- */
{code}

A few things

# please mark this change as breaking and include a release note, since hte javadocs expressly say it was there for ecosystem projecs (even though it does not carry a proper InterfaceAudience annotation)
# consider limiting this change to trunk and leave it out of branch-2
# HdfsConstants is labeled InterfaceAudience.Private, so what am I supposed to move HBase to?, bq.  consider limiting this change to trunk and leave it out of branch-2

Thanks for the heads up. The class has been deprecated since 0.23. According to the compatibility guideline branch-2 is free to remove the class. I'll update the release notes though.

bq. HdfsConstants is labeled InterfaceAudience.Private, so what am I supposed to move HBase to?

Can you investigate how HBase uses the constants?, Seems like option 2 is good? Removing deprecated code outside of a new major release is rather unfriendly., +1 on option 2.
Previous releases of hadoop 2.x contain the class and we know that other projects still use it so I do not think it is a good idea to remove it in later branch-2 releases..., bq. Seems like option 2 is good? Removing deprecated code outside of a new major release is rather unfriendly.
bq. Previous releases of hadoop 2.x contain the class and we know that other projects still use it so I do not think it is a good idea to remove it in later branch-2 releases...

I definitely understand the concerns here and option 2 is probably a quick fix. I have some doubts here:

*  {{FSConstants}} has been marked as deprecated since 0.23 which is 4 years ago. The compatibility guide allows removing deprecated code in the next major release. It allows cleaning up code and moving things forward. Notably, we removed hftp and JSP in trunk which makes things much simpler.
* Even we don't remove {{FSConstants}}, the class itself extends {{HdfsConstants}} which is annotated as private. As {{HdfsConstants}} continues to evolve, HBase might hit other issues down the road.

I have no problems of bringing it back in branch-2 (after all it is just a very small piece of code). My feeling is that to avoid further complication, it might be beneficial to investigate how HBase uses the class and to derive a cleaner solution., I'm fine with reverting those changes back into branch-2. However, I think [~wheat9] made a very valid point on understanding the code-level HBase dependencies. HBase is utterly important, even for Hadoop itself. Right now in YARN-2928, we're using HBase to store all timeline data for the next-generation timeline service. It will be great to fully understand the "true" dependencies of HBase on Hadoop so that we're not blocking YARN-2928 branch accidentally. , HBase uses DistributedFileSystem.setSafeMode to check whether an hdfs cluster is in safe mode. This method needs {{HdfsConstants.SafeModeAction}}.

I found that there is a {{HdfsUtils.isHealthy}}, we could try to make use of this method instead of depending on hdfs private classes.

Thanks., So long as there is a {{HdfsConstants.SafeModeAction}} and the same is available in FSConstants, then HBase can keep listing branch-2 versions as usable with the HBase 1.y versions we have released.

We're happy to move to something else entirely for checking if HDFS is in safe mode, but what version of HBase we can do that in depends on what versions of HDFS the method is available in. The 0.98 branch needs things that start at Hadoop 2.2, HBase 1.y needs things to start at Hadoop 2.4 (and preferably 2.2)., HBase has a temporary work around that relies on the private HdfsConstants in HBASE-13716. That will help us with future patch-releases on HBase's 1.y release line, but it order to list Hadoop 2.8+ as okay for HBase 1.0 and 1.1 (the two minor releases that are already live) we'll need this change reverted from branch-2 so that the earlier versions of those branches will work at runtime.

If possible before our next set of releases, we'd like some guidance on what Hadoop considers the correct way to get the same information we want, i.e. "is HDFS in safemode?"  Some details from [~Apache9] over on HBASE-13716:

{quote}
Add I check the code again, HdfsUtils.isHealthy(URI) calls DistributedFileSystem.setSafeMode(GET, false), but in HBase we calls DistributedFileSystem.setSafeMode(GET, true). I think the difference is when the second parameter is true then BackupNN will throw a StandByException that force client to connect to ActiveNN.

If we must connect to ActiveNN in HBase, then HdfsUtils.isHealthy(URI) is not enough. So add new methods in HdfsUtils?
{quote}

On the general issue of HBase's "true dependencies on Hadoop" we have an umbrella issue now to ensure that by HBase 2.0 we have a well defined interface point: HBASE-13740. In the mean-time, I could add a nightly build job that both projects get notice of  that attempts to build the current HBase branch-1 against the current Hadoop branch-2., [~gtCarrera9] [~wheat9] how would you like to proceed? This is blocking Sean's validation work for HADOOP-11656, so if you guys aren't actively working on a fixup, I'd like to revert this for now., Sure. I'll revert the patch in branch-2., FAILURE: Integrated in Hadoop-trunk-Commit #7908 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/7908/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #211 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/211/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, SUCCESS: Integrated in Hadoop-Yarn-trunk #941 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/941/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk #2139 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2139/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #199 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/199/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, SUCCESS: Integrated in Hadoop-Mapreduce-trunk-Java8 #209 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/209/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
, SUCCESS: Integrated in Hadoop-Mapreduce-trunk #2157 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2157/])
Update CHANGES.txt for HDFS-8135. (wheat9: rev c46d4bafe1e34b77be3f218b4901f66db4db97f4)
* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
]