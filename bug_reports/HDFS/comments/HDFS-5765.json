[Can you add more description to this jira. Are you saying once snapshot of a file is taken, it cannot be appended to? Please post a quick test to reproduce that issue or at least post the logs that shows the problem?, This is most likely to be cat command not stopping at the snapshot length., I think this is same as HDFS-5343?, 1) From JIRA description, it is duplicated to HDFS-5343.

2) More information: It also break in copyToLocal as:

sudo -u hdfs hdfs dfs -mkdir /test
sudo -u hdfs hdfs dfsadmin -allowSnapshot /test
rm -rf /tmp/mytest
echo mytest > /tmp/mytest
rm -rf /tmp/myappend
echo myappend > /tmp/myappend
sudo -u hdfs hdfs dfs -copyFromLocal /tmp/mytest /test
sudo -u hdfs hdfs dfs -createSnapshot /test snap1
sudo -u hdfs hdfs dfs -cat /test/.snapshot/snap1/mytest
sudo -u hdfs hdfs dfs -appendToFile /tmp/myappend /test/mytest
sudo -u hdfs hdfs dfs -copyToLocal /test/.snapshot/snap1/mytest /tmp/mysnap
echo "expect mytest"
cat /tmp/mysnap
sudo -u hdfs hdfs dfs -deleteSnapshot /test/ snap1
sudo -u hdfs hdfs dfsadmin -disallowSnapshot /test/
sudo -u hdfs hdfs dfs -rm /test/mytest
sudo -u hdfs hdfs dfs -rmdir /test/

3) My suggestion: we can duplicate to HDFS-5343 after HDFS-5343 is fixed and two above script can pass.
, Duplicate of HDFS-5343]