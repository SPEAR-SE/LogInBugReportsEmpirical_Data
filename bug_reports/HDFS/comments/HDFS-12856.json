[This to address [~xkrogen]'s [comment|https://issues.apache.org/jira/browse/HDFS-12832?focusedCommentId=16259458&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16259458] in HDFS-12832.
I see two possible solutions:
# Surround the call with the lock
# Reorganize {{BlockReconstructionWork}} so that it stored only elementary fields, like ids, to allow more fine-grained locking inside {{chooseTargets()}}

We should also deprecate {{BlockPlacementPolicy.chooseTargets()}} methods with {{srcPath}} parameter, since it is unused in all known (to me) variants of the policy.]