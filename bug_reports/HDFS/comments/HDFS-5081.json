[It turns out that NamespaceUpgrade tries to list the files under .archive directory (hardcoded) which doesn't exist.

In hadoop 1.0, fs.listStatus() returns empty FileStatus[]
In hadoop 2.0 / 2.1, FileNotFoundException is thrown., Ted, isn't this a known fact with HADOOP-2.x. I thought we already have code in HBase that handles this fact. Am I missing something?, Some new code didn't handle this very well.
See HBASE-9168., Am closing this issue since this is not relevant any more., Devaraj, just for future reference, 2.0 will break backward compatibility with listStatus()? Is there a jira listing other incompatibilities?, For the listStatus change, see HDFS-538.  For a list incompatible changes, search for "incompatible change", i.e.  https://issues.apache.org/jira/issues/?jql=project%20%3D%20HDFS%20AND%20%22Hadoop%20Flags%22%20%3D%20%22Incompatible%20change%22]