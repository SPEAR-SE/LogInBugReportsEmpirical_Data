[Patch to merge test fixes from trunk, with DataNode nested helper class., Is this merging code from trunk? Do you know which jira it comes from?, Suresh, I was looking for that and it appears to be from HDFS-4586.

I am guessing you can ignore my patch and just merge in HDFS-4586., Duplicate of HDFS-4856.]