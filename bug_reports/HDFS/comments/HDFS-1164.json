[I don't know if it was the cause of these Hudson failures, but there are a number of problems in trunk:
- TestHdfsProxy doesn't pass if the user running the test isn't in a group named "users" (also true in YDH)
- HADOOP-6633 changed the configuration properties to use the word "hosts" instead of "ip-addresses"
- ProxyFilter incorrectly passed the entire UGI string (ie user,group1,group2,...) as the username instead of only the username component (bug in HDFS-481 as applied to trunk - this fix made it to YDH but not trunk)

I'll upload a patch momentarily to fix these issues., Patch applies on top of HDFS-1301, Patch against yahoo 20, Patch fell a little out of date. Here's a rebased version for trunk., Regenerated again against trunk, Todd, is there a reason you weren't been using {{createUserForTesting()}} and similar primitives?

Other than that patch is fine.

+1 patch looks and works good!, Could certainly use createUserForTesting along with testing groups, but I figured I'd keep the code as it was, using the current user rather than having to add doAs(), etc., Yeah, makes sense. Smaller changes are perhaps make more sense. Let's validate it as usual and proceed with commit. I'm fine with the patch., test-patch says:
     [exec] -1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     +1 tests included.  The patch appears to include 3 new or modified tests.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.
     [exec] 
     [exec]     -1 release audit.  The applied patch generated 97 release audit warnings (more than the trunk's current 1 warnings).
     [exec] 
     [exec]     -1 system test framework.  The patch failed system test framework compile.
     [exec] 

The release audit is some problem with the test-patch script. The system test error is related to some other change in Herriot which is currently in-progress between common and HDFS., Commit of Hadoop-6977 should've break the system test framework compilation - that was expected. I am not sure about the release audit, so please check to make sure. I don't expect the patch like to create so many warning though ;), I have witnessed the same issue with test-path on a different validation. Looks like 97 warnings are coming from test-patch itself. I'm gonna commit this.  , I have just committed it to trunk. Thanks Todd., Patch for 20-security branch., +1 for porting it to 0.20-security, Closed upon release of 0.20.205.0]