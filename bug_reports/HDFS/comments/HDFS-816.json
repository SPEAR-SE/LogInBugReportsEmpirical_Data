[Here is the log of the failed test.
Before the exception it created a bunch of files, but failed on the last one. Looks like the reason is that {{DFSClient.createBlockOutputStream()}} getst a {{BindException: Address already in use}} from the data-node., In order to reproduce this a patch from HDFS-456 should be applied unless it is committed., I hear this is not windows specific. Hairong reports the same problem on Mac., This could be a race condition in shutdown: the DN had shut down while the creator thread was still live, so the creator thread got the cannot reproduce exception. The fact that the Datanode is shutdown message appeared in the log a few milliseconds after is meaningless, the DN shuts down its bits in a sequence, so it may have already dropped out the cluster before the message was printed.

]