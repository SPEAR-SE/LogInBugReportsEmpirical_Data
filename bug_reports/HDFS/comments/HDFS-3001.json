[With a valid hdfs kerberos ticket, the dfsadmin subcommand '-refreshServiceAcl' still fails on Kerb authentication with
the following error:

bash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/
dfsadmin -refreshServiceAcl
refreshServiceAcl: User hdfs/USER@DOMAIN (auth:KERBEROS) is not authorized for protocol
interface org.apache.hadoop.security.authorize.Refresh
AuthorizationPolicyProtocol, expected client Kerberos principal is null

However, other dfsadmin commands like '-printTopology', '-refreshNamenodes', '-safemode', '-report', which should use
the same privilege level, do not give authentication errors and work successfully:

- kerb ticket -
bash-3.2$ klist -5
Ticket cache: FILE:/tmp/path/kbtickets/hdfs.kerberos.ticket
Default principal: hdfs/USER@DOMAIN

Valid starting Expires Service principal
01/18/12 23:59:53 01/19/12 23:59:53 krbtgt/USER@DOMAIN
renew until 01/25/12 23:59:53

- -printTopology subcommand -
bash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/
dfsadmin -printTopology
Rack: /IPADDR1.0
IPADDR2.43:1004 (HOST1.com)
IPADDR3.44:1004 (HOST2.com)
IPADDRn.60:1004 (HOSTn.com)

Rack: /default-rack
HOSTr.com

- -refreshNamenodes subcommand -
bash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/
dfsadmin -fs hdfs://NNHOST:8020 -refreshNamenodes DNHOST:8020
bash-3.2$ echo $?
0

- -safemode subcommand -
bash-3.2$ /home/share/hadoop/bin/hdfs --config /home/conf/hadoop/
dfsadmin -fs hdfs://NNHOST:8020 -safemode get
Safe mode is OFF
, Hmm  "hdfs/USER@DOMAIN" seems suspicious.  Typical user-escalation-type principal configurations would make this look like user/hdfs@DOMAIN .  Is this just a configuration problem?, Thanks for the feedback and good point, this might be the case. John was working to reproduce this but did not see the issue, we checked to confirm that i was running as a privileged user. I was, however the environment has a Kerb user translation rule in the site config's 'hadoop.security.auth_to_local' setting which remaps the running userid, this is likely the cause for the issue. Trying to get some bandwidth in order to confirm., Pat,
I am going to close this as not-reproducible anymore. If you disagree, please feel free to re-open.]