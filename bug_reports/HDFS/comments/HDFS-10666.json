[Excellent!  Thank you for filing this, Mingliang.

Another technique that has been helpful in the ZooKeeper tests is coordinating the JUnit thread with activities of the internal threads using a {{CountDownLatch}}.  Sometimes it requires intrusive changes in the product code to make that work though., Thanks [~cnauroth] for the suggestions. I updated the description.

This reminds me of {{BlockManagerTestUtil#stopReplicationThread()}}, which manipulates the {{BlockManager}} internal state {{checkNSRunning}} for coordinating the replication thread. I think the {{checkNSRunning}} was added dedicatedly for this testing purpose. We should leverage similar approaches only when necessary., [HADOOP-10823] is in Hadoop Common project and can not be a subtask of this uber jira. I linked [HADOOP-10823] as this one "contains" it. Future efforts will be simply organized alike.]