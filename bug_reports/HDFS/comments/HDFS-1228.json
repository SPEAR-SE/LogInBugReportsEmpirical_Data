[Please check the scenario where CRC Comparision fails:
======================================================
1)create a file of 512bytes 2)now try appending some more content to the file
3)just append 2 bytes and call sync  4)Again append 2 more bytes and call syn
But this time sync will fail throwing this exception

2011-03-12 20:28:37,671 ERROR datanode.DataNode (DataXceiver.java:run(131)) - DatanodeRegistration(10.18.52.116:50010, storageID=DS-1547254589-10.18.52.116-50010-1299941311942, infoPort=50075, ipcPort=50020):DataXceiver
java.io.IOException: Partial CRC 3835263025 does not match value computed the  last time file was closed 2082103828
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.computePartialChunkCrc(BlockReceiver.java:692)
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.setBlockPosition(BlockReceiver.java:632)
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.receivePacket(BlockReceiver.java:400)
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.receiveBlock(BlockReceiver.java:533)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.writeBlock(DataXceiver.java:358)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:103)
	at java.lang.Thread.run(Thread.java:619)
, Correction for the above comment:
=================================
We should create a file of 1)create a file of 513 bytes (it should not be a multiple of 512), I have created the patch for the same.

I would like to submit
Kindly let me know if i can go forward, append got overhauled in 2.x. Closing.]