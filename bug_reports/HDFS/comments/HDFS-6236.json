[I noticed this due to a failure in {{TestCheckpoint#testCheckpoint}} on Windows.  There are assertions that the metrics are greater than zero, and these assertions were failing.  Windows in particular has a low-precision implementation of {{System#currentTimeMillis}}.  This patch fixes the issue.  Tests are passing consistently for me on both Mac and Windows now.

I also discovered a problem inside {{TestCheckpoint#testReformatNNBetweenCheckpoints}}.  Restarting a new {{MiniDFSCluster}} ended up trying to use the same storage directory as a {{SecondaryNameNode}} that was intentionally left running in the background.  The new cluster would fail during initialization due to file locks while trying to delete the storage directory.  To solve this, I've cloned the configuration and set a different storage dir for use by the 2NN.
, +1 pending jenkins., {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12639894/HDFS-6236.1.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/6655//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/6655//console

This message is automatically generated., SUCCESS: Integrated in Hadoop-trunk-Commit #5509 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/5509/])
HDFS-6236. ImageServlet should use Time#monotonicNow to measure latency. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1586902)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/ImageServlet.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
, Thanks very much for the review, Haohui.  I have committed this to trunk, branch-2 and branch-2.4., SUCCESS: Integrated in Hadoop-Yarn-trunk #539 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/539/])
HDFS-6236. ImageServlet should use Time#monotonicNow to measure latency. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1586902)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/ImageServlet.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk #1731 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1731/])
HDFS-6236. ImageServlet should use Time#monotonicNow to measure latency. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1586902)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/ImageServlet.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
, SUCCESS: Integrated in Hadoop-Mapreduce-trunk #1756 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1756/])
HDFS-6236. ImageServlet should use Time#monotonicNow to measure latency. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1586902)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/ImageServlet.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestCheckpoint.java
]