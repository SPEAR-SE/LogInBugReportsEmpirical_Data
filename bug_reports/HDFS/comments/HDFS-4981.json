[Are snapshots even in 2.0.4-alpha?, Hi Stephen,

Thanks for reporting the issue. I'll be working on it later next week., Hi Stephen,

After some investigation, the root cause is that {{FsShellPermissions#processPath}} inside common has the optimization that if new permission is the same as current, no further checking is done. (The 'Modification on a read-only snapshot is disallowed' message is from {{FSDirectory#getINodesInPath4Write}} inside hdfs.

At this point, the most reasonable enhancement I can think of is to add a special check for the .snapshot dir in FsShellPermissions. However, considering
  1. Since the perm check is ignored, no action is taken. The only thing missing is the error message.
  2. The possible fix is located in common where snapshot feature should not be exposed 
  3. According to the design in HDFS-2802, RW snapshots may be supported in the future. In this case we have to revert the check outside (or at least change the message)
I suggest not to add the fix for now.

Please let me know if you have any suggestions/feedback.
Thanks.]