[This API is already released, right? If so, this will be incompatible. We should maintain compatibility for these APIs., The changes of the API is in HDFS-5196, which is committed only to branch-2 today. There're no compatibility issues as long as they are fixed before 2.5., Another option is to revert the branch-2 commit for HDFS-5196, and to commit both HDFS-5196 and HDFS-6156 to branch-2 at the same time., bq. Another option is to revert the branch-2 commit for HDFS-5196, and to commit both HDFS-5196 and HDFS-6156 to branch-2 at the same time.
If the change is just in branch-2, which is not released, this change should be okay. Thanks [~wheat9] for clarifying., The current JMX API looks like the following:

{code}
name: "Hadoop:service=NameNode,name=SnapshotInfo",
modelerType: "org.apache.hadoop.hdfs.server.namenode.snapshot.SnapshotManager",
SnapshotStats: {
directory: [
{
  group: "supergroup",
  modificationTime: 1395768950823,
  owner: "hmai",
  path: "/test",
  permission: 755,
  snapshotNumber: 1,
  snapshotQuota: 65536
}
],
snapshots: [
{
  modificationTime: 1395768950823,
  snapshotDirectory: "/test/.snapshot/s20140325-103550.819",
  snapshotID: "s20140325-103550.819",
}
]
}
{code}

I propose to inline {{SnapshotStats}, that is to return something like the following:

{code}
name: "Hadoop:service=NameNode,name=SnapshotInfo"
modelerType: "org.apache.hadoop.hdfs.server.namenode.snapshot.SnapshotManager"
snapshottableDirectories: [
{
  group: "supergroup",
  modificationTime: 1395768950823,
  owner: "hmai",
  path: "/test",
  permission: 755,
  snapshotNumber: 1,
  snapshotQuota: 65536
}
]
snapshots: [
{
  modificationTime: 1395768950823,
  snapshotDirectory: "/test/.snapshot/s20140325-103550.819",
  snapshotID: "s20140325-103550.819"
]
}
{code}, I think that the following methods are necessary to complete your proposal.

{code}
public SnapshottableDirectory.Bean[] getSnapshottableDirectories();
public Snapshots.Bean[] getSnapshottableDirectories();
{code}

Let me clarify my understanding. 
, Yes. these should be the complete lists of methods in the {{SnapshotStatsMXBean}} interface., Thank you for your comment. And, I think that we do not need to convert List into Arrays.
I attach the patch file., {code}
+    SnapshottableDirectoryStatus[] stats = getSnapshottableDirListing(null);
+    if (stats == null) {
+      return null;
+    }
+    List<SnapshotInfo.Bean> beans = new ArrayList<SnapshotInfo.Bean>();
+    for (SnapshottableDirectoryStatus d : stats) {
+      try {
+        for (Snapshot s : getSnapshottableRoot(
+            d.getFullPath().toString()).getSnapshotList()) {
+          beans.add(toBean(s));
         }
+      } catch (IOException e) {
+        continue;
{code}

It's more appropriate to refactor / inline {{getSnapshottableDirListing}} here to generate the list.

{code}
+  private static SnapshottableDirectoryStatus.Bean toBean(
+      SnapshottableDirectoryStatus d) {
+    return new SnapshottableDirectoryStatus.Bean(d);
+  }
+  
+  private static SnapshotInfo.Bean toBean(Snapshot s) {
+    return new SnapshotInfo.Bean(s);
   }
{code}

Beans are abstractions between two different layers, thus they usually have no dependency of the application logic (e.g., they don't take an application-level object in the constructor). A better approach is:

{code}
// in the bean
    public Bean(String path, int snapshotNumber, int snapshotQuota, 
                long modificationTime, short permission, String owner, 
                String group) {
      this.path = path;
      this.snapshotNumber = snapshotNumber;
      this.snapshotQuota = snapshotQuota;
      this.modificationTime = modificationTime;
      this.permission = permission;
      this.owner = owner;
      this.group = group;
    }

// in snapshotmanager
    public Bean(SnapshottableDirectoryStatus s) {
      return new Bean(s.getFoo(), ...);
    }
{code}

bq. I think that we do not need to convert List into Arrays.

I think it has no differences in the final results, but it looks to me that it's also a convention in beans. :-)
, {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12637181/HDFS-6156.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/6530//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/6530//console

This message is automatically generated., Thank you for your detailed comment!
I attach the patch which I revised about Beans and SnapshottableDirectory list., {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12637309/HDFS-6156-2.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-hdfs-project/hadoop-hdfs.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HDFS-Build/6540//testReport/
Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/6540//console

This message is automatically generated., Looks good to me. +1.

Nit: there are a bunch of trailing whitespace in the patch. I'll go ahead and commit this patch using {{git apply --whitespace=fix}}, but it would be great if the patch can be cleaned up next time., I've committed the patch to trunk and branch-2. Thanks [~sinchii] for the contribution., SUCCESS: Integrated in Hadoop-trunk-Commit #5421 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/5421/])
HDFS-6156. Simplify the JMX API that provides snapshot information. Contributed by Shinichi Yamashita. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1582847)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotInfo.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshottableDirectoryStatus.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotManager.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotStatsMXBean.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/snapshot/TestSnapshotStatsMXBean.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #1741 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1741/])
HDFS-6156. Simplify the JMX API that provides snapshot information. Contributed by Shinichi Yamashita. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1582847)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotInfo.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshottableDirectoryStatus.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotManager.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotStatsMXBean.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/snapshot/TestSnapshotStatsMXBean.java
, SUCCESS: Integrated in Hadoop-Yarn-trunk #524 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/524/])
HDFS-6156. Simplify the JMX API that provides snapshot information. Contributed by Shinichi Yamashita. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1582847)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotInfo.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshottableDirectoryStatus.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotManager.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotStatsMXBean.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/snapshot/TestSnapshotStatsMXBean.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk #1716 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1716/])
HDFS-6156. Simplify the JMX API that provides snapshot information. Contributed by Shinichi Yamashita. (wheat9: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1582847)
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotInfo.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshottableDirectoryStatus.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotManager.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotStatsMXBean.java
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/snapshot/TestSnapshotStatsMXBean.java
]