[Hi, [~walter.k.su], it's a good catch! I looked the code and it's right that {{countNodes(blk).corruptReplicas()}} only checking for {{NORMAL}},{{READ_ONLY}} two types in method {{BlockManager#checkReplicaOnStorage}}, while it does not check for these two cases in {{BlockManager#findAndMarkBlockAsCorrupt}}. Attach a patch from me, what do you think of this?]