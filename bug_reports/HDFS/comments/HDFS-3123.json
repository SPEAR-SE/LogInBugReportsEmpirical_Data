[Hey Brahma, 

Thanks for reporting the issue.

I remember, I have fixed this issue log back.
Looks like, this has been reverted back as part of HA brannch merge.

Fixed as part of https://issues.apache.org/jira/browse/HDFS-2768.
Explained the reason for this issue in above mentioned issue.


Thanks
Uma, Hi Uma,

I taken patch from HDFS-2768(as you refered) then I am not getting "java.lang.IllegalArgumentException: not a proxy instance" but nullpointer still i am getting this you can look as part of this issue.

, Brahma, HADOOP-8202 fixed close problem in latest builds in trunk and branch-2., Hi Uma,

I checked in latest trunk and branch still problem is there.]