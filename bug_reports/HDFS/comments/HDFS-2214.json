[Both this patch and HDFS-2211 are needed to make mapreduce compile offline against local version of hadoop-common., This patch doesn't apply cleanly to 0.22 anymore. Pl. fix and resubmit., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12489649/HDFS-2214.patch
  against trunk revision 1155998.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/1064//console

This message is automatically generated., Fixing some white space issues in the new patch., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12490583/HDFS-2214.patch
  against trunk revision 1158025.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HDFS-Build/1106//console

This message is automatically generated., +1 patch looks good and works as expected.

I have just committed it. Thanks Joep., Integrated in Hadoop-Hdfs-22-branch #76 (See [https://builds.apache.org/job/Hadoop-Hdfs-22-branch/76/])
    HDFS-2214. Generated POMs hardcode dependency on hadoop-common version 0.22.0-SNAPSHOT. Contributed by Joep Rottinghuis.

cos : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1158481
Files : 
* /hadoop/common/branches/branch-0.22/hdfs/ivy/hadoop-hdfs-instrumented-template.xml
* /hadoop/common/branches/branch-0.22/hdfs/CHANGES.txt
* /hadoop/common/branches/branch-0.22/hdfs/ivy/hadoop-hdfs-template.xml
* /hadoop/common/branches/branch-0.22/hdfs/build.xml
, Somehow in this patch it seems we rolled back HDFS-2189. It looks like we drooped the guava dependency again. I'll have to check today and verify.
If indeed we did, then how to we rectify that situation?
Do we want to roll back this patch and I attach the proper one that does not roll back the guava?, Need to add back in the guava dependency that was inadvertently dropped. Will attach follow-up patch for this., HDFS-2214.patch rolls back the HDFS-2189 fix which it should not have. HDFS-2214-follow-up.patch rectifies this., Yes, we'd better rollback the initial patch and then apply a correct one (without manipulations with guava libs). Could you create new correct patch for that?, Ok, I will create a new patch this morning that will apply cleanly after rolling back the initial one., Attached updated patch. Should be applied after rolling previous patch back.
Alternatively, HDSF-2214-follow-up.patch could be applied as well. Both should end up with the same., Reverted and committed the new patch. Thank you Joep., Integrated in Hadoop-Hdfs-22-branch #77 (See [https://builds.apache.org/job/Hadoop-Hdfs-22-branch/77/])
    HDFS-2214. Generated POMs hardcode dependency on hadoop-common version 0.22.0-SNAPSHOT. Contributed by Joep Rottinghuis.
HDFS-2214. Revert last patch.

shv : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1160361
Files : 
* /hadoop/common/branches/branch-0.22/hdfs/ivy/hadoop-hdfs-instrumented-template.xml
* /hadoop/common/branches/branch-0.22/hdfs/ivy/hadoop-hdfs-template.xml
* /hadoop/common/branches/branch-0.22/hdfs/build.xml

shv : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1160358
Files : 
* /hadoop/common/branches/branch-0.22/hdfs/ivy/hadoop-hdfs-instrumented-template.xml
* /hadoop/common/branches/branch-0.22/hdfs/ivy/hadoop-hdfs-template.xml
* /hadoop/common/branches/branch-0.22/hdfs/build.xml
]