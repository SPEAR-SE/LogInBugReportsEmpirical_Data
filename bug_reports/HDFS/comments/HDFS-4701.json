[The problem occurs in the code below in {{DataNode}}.  The last line is at risk for a {{NullPointerException}}, because the block pool ID may have already been removed from the {{BlockPoolManager}}.  In this case, the call to {{BlockPoolManager#get}} would return null.

{code}
  /** Recover a block */
  private void recoverBlock(RecoveringBlock rBlock) throws IOException {
    ExtendedBlock block = rBlock.getBlock();
    String blookPoolId = block.getBlockPoolId();
    DatanodeID[] datanodeids = rBlock.getLocations();
    List<BlockRecord> syncList = new ArrayList<BlockRecord>(datanodeids.length);
    int errorCount = 0;

    //check generation stamps
    for(DatanodeID id : datanodeids) {
      try {
        BPOfferService bpos = blockPoolManager.get(blookPoolId);
        DatanodeRegistration bpReg = bpos.bpRegistration;
{code}
, Downgrading to Minor.  From what I can tell at this point, the NPE doesn't cause much harm, but it could cause confusion for a user reviewing the logs.]