[There's not that much that can be done here other than restrict the concat operation to HDFS, because localfs doesn't support merging of files this way -which is a fairly low-level operation, more than just a {{cat}} operation., However, the localfs is hardcoded to be used in the implementation. It makes the tool unusable. , It's grabbing whatever is in {{"fs.default.name"}}; if that's not an HDFS URL then you aren't running on HDFS, at least not with the configuration file that is being picked up., What could be done is get the class, not cast it, but instead call {{FileSystem.concat()}}, expecting an {{UnsupportedOperationException}} if it isn't implemented, and downgrade that to an {{exit(-1)}}. That way: FS independent, and fails with some meaningful message. If anyone did ever implement concat on other filesystems, then it could get used.

Even so, it is {{HDFSConcat}} for a reason: there is no expectation that it works elsewhere, Now, the problem is that it always uses the default fs even I specify hdfs paths as follows

java org.apache.hadoop.hdfs.tools.HDFSConcat hdfs:///a hdfs:///b]