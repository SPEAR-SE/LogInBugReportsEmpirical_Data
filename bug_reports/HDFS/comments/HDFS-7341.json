[This is the patch originally posted by [~zero45] on HDFS-3107., As discussed on the parent subtask (HDFS-3107), I am +1 on committing this to a feature branch (but not to trunk).  As soon as the branch is created I'll commit this unless there are further comments., Colin, are you still working on this.
Should we close it? , Duplicate of HDFS-3107]