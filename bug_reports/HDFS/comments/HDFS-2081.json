[Linking related JIRA where we first saw this kind of issue., Thanks for the pointer Tod. My approach to this is slightly different. 

Attaching a patch without any unit tests for prelim review. I know this patch works because of the yarn test I ran. I do want to write a unit test for this, so that we know if it breaks in the future. I dont have a clear cut idea as to how to write one.
, I overlooked the changes in the patch in HADOOP-7082. That patch is exactly what is required! Thanks Tod.

Duplicating this JIRA to HADOOP-7082., Dupe of HADOOP-7082.]