[A patch for the 0.21 branch (not to be committed to trunk). , I've just committed this.]