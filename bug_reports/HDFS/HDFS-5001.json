{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xifang&avatarId=17273",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xifang&avatarId=17273",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xifang&avatarId=17273",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xifang&avatarId=17273"
            },
            "displayName": "Xi Fang",
            "key": "xifang",
            "name": "xifang",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=xifang",
            "timeZone": "America/Los_Angeles"
        },
        "components": [{
            "id": "12312926",
            "name": "namenode",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12312926"
        }],
        "created": "2013-07-16T22:27:55.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xifang&avatarId=17273",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xifang&avatarId=17273",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xifang&avatarId=17273",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xifang&avatarId=17273"
            },
            "displayName": "Xi Fang",
            "key": "xifang",
            "name": "xifang",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=xifang",
            "timeZone": "America/Los_Angeles"
        },
        "customfield_10010": null,
        "customfield_12310191": [{
            "id": "10343",
            "self": "https://issues.apache.org/jira/rest/api/2/customFieldOption/10343",
            "value": "Reviewed"
        }],
        "customfield_12310192": null,
        "customfield_12310220": "2013-07-18T05:16:26.577+0000",
        "customfield_12310222": "3_*:*_1_*:*_1002715_*|*_1_*:*_1_*:*_110897294_*|*_5_*:*_1_*:*_0",
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "1.0",
        "customfield_12310320": [{
            "archived": true,
            "description": "Hadoop Windows branch",
            "id": "12320362",
            "name": "1-win",
            "released": false,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12320362"
        }],
        "customfield_12310420": "338326",
        "customfield_12310920": "338646",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i1mcsn:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jul 18 05:32:43 UTC 2013",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "After the backport patch of HDFS-4975 was committed, TestAzureBlockPlacementPolicy and TestReplicationPolicyWithNodeGroup failed. \nThe cause for the failure of TestReplicationPolicyWithNodeGroup is that some part in the patch of HDFS-3941 is missing. Our patch for HADOOP-495 makes methods in super class to be called incorrectly. More specifically, HDFS-4975 backported HDFS-4350, HDFS-4351, and HDFS-3912 to enable the method parameter \"boolean avoidStaleNodes\", and updated the APIs in BlockPlacementPolicyDefault. However, the override methods in ReplicationPolicyWithNodeGroup weren't updated.\n\nThe cause for the failure of TestAzureBlockPlacementPolicy is similar.\n\nIn addition, TestAzureBlockPlacementPolicy has an error. Here is the error info.\n\nTestcase: testPolicyWithDefaultRacks took 0.005 sec\nCaused an ERROR\nInvalid network topology. You cannot have a rack and a non-rack node at the same level of the network topology.\norg.apache.hadoop.net.NetworkTopology$InvalidTopologyException: Invalid network topology. You cannot have a rack and a non-rack node at the same level of the network topology.\nat org.apache.hadoop.net.NetworkTopology.add(NetworkTopology.java:396)\nat org.apache.hadoop.hdfs.server.namenode.TestAzureBlockPlacementPolicy.testPolicyWithDefaultRacks(TestAzureBlockPlacementPolicy.java:779)\n\nThe error is caused by a check in NetworkTopology#add(Node node)\n{code}\nif (depthOfAllLeaves != node.getLevel()) {\n  LOG.error(\"Error: can't add leaf node at depth \" +\n      node.getLevel() + \" to topology:\\n\" + oldTopoStr);\n  throw new InvalidTopologyException(\"Invalid network topology. \" +\n      \"You cannot have a rack and a non-rack node at the same \" +\n      \"level of the network topology.\");\n}\n{code}\n\nThe problem of this check is that when we use NetworkTopology#remove(Node node) to remove a node from the cluster, depthOfAllLeaves won't change. As a result, we can't reset the value of NetworkTopology#depathOfAllLeaves of the old topology of a cluster by just removing all its dataNode. See TestAzureBlockPlacementPolicy#testPolicyWithDefaultRacks()\n{code}\n// clear the old topology\nfor (Node node : dataNodes) {\n  cluster.remove(node);\n}\n{code}\n\n",
        "duedate": null,
        "environment": null,
        "fixVersions": [{
            "archived": true,
            "description": "Hadoop Windows branch",
            "id": "12320362",
            "name": "1-win",
            "released": false,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12320362"
        }],
        "issuelinks": [{
            "id": "12372156",
            "inwardIssue": {
                "fields": {
                    "issuetype": {
                        "avatarId": 21133,
                        "description": "A problem which impairs or prevents the functions of the product.",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                        "id": "1",
                        "name": "Bug",
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                        "subtask": false
                    },
                    "priority": {
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                        "id": "3",
                        "name": "Major",
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
                    },
                    "status": {
                        "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                        "id": "5",
                        "name": "Resolved",
                        "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                        "statusCategory": {
                            "colorName": "green",
                            "id": 3,
                            "key": "done",
                            "name": "Done",
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
                        }
                    },
                    "summary": "Branch-1-win TestReplicationPolicy failed caused by stale data node handling"
                },
                "id": "12656962",
                "key": "HDFS-4975",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/12656962"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12372156",
            "type": {
                "id": "10030",
                "inward": "is related to",
                "name": "Reference",
                "outward": "relates to",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
            }
        }],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310942&avatarId=10094",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310942&avatarId=10094",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310942&avatarId=10094",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310942&avatarId=10094"
            },
            "id": "12310942",
            "key": "HDFS",
            "name": "Hadoop HDFS",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310942"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xifang&avatarId=17273",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xifang&avatarId=17273",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xifang&avatarId=17273",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xifang&avatarId=17273"
            },
            "displayName": "Xi Fang",
            "key": "xifang",
            "name": "xifang",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=xifang",
            "timeZone": "America/Los_Angeles"
        },
        "resolution": {
            "description": "A fix for this issue is checked into the tree and tested.",
            "id": "1",
            "name": "Fixed",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1"
        },
        "resolutiondate": "2013-07-18T05:32:55.000+0000",
        "status": {
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "id": "5",
            "name": "Resolved",
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "Branch-1-Win TestAzureBlockPlacementPolicy and TestReplicationPolicyWithNodeGroup failed caused by 1) old APIs and 2) incorrect value of depthOfAllLeaves",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2013-07-18T05:32:55.000+0000",
        "versions": [{
            "archived": true,
            "description": "Hadoop Windows branch",
            "id": "12320362",
            "name": "1-win",
            "released": false,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12320362"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HDFS-5001/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HDFS-5001/watchers",
            "watchCount": 3
        },
        "workratio": -1
    },
    "id": "12658132",
    "key": "HDFS-5001",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12658132"
}